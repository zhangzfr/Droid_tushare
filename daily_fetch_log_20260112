数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:12,679 - tushare_duckdb - INFO - ======================================================================
2026-01-12 21:47:12,680 - tushare_duckdb - INFO -   Tushare 日频数据自动更新
2026-01-12 21:47:12,680 - tushare_duckdb - INFO -   目标日期: 20260109
2026-01-12 21:47:12,680 - tushare_duckdb - INFO -   目标类别: stock, margin, moneyflow, index, fund, bond, option, future, reference, macro, fx, commodity
2026-01-12 21:47:12,680 - tushare_duckdb - INFO -   模式: 自动增量
2026-01-12 21:47:12,680 - tushare_duckdb - INFO - ======================================================================
2026-01-12 21:47:12,680 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────────────────────────
2026-01-12 21:47:12,680 - tushare_duckdb - INFO -   [阶段1] 收集获取前的数据统计...
2026-01-12 21:47:12,680 - tushare_duckdb - INFO - ──────────────────────────────────────────────────────────────────────
2026-01-12 21:47:12,680 - tushare_duckdb - INFO - 
  STOCK:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:12,707 - tushare_duckdb - INFO -     daily: 最近3日 [20260109:5459, 20260108:5459, 20260107:5460]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:12,734 - tushare_duckdb - INFO -     adj_factor: 最近3日 [20260109:5476, 20260108:5476, 20260107:5476]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:12,762 - tushare_duckdb - INFO -     daily_basic: 最近3日 [20260109:5459, 20260108:5459, 20260107:5460]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:12,788 - tushare_duckdb - INFO -     stk_limit: 最近3日 [20260109:7421, 20260108:7420, 20260107:7417]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:12,804 - tushare_duckdb - INFO -     suspend_d: 最近3日 [20260109:14, 20260108:11, 20260107:13]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:12,828 - tushare_duckdb - INFO -     bak_basic: 最近3日 [20260109:5472, 20260108:5471, 20260107:5471]
2026-01-12 21:47:12,828 - tushare_duckdb - INFO - 
  MARGIN:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
2026-01-12 21:47:12,841 - tushare_duckdb - INFO -     margin: 最近3日 [20260109:1, 20260108:3, 20260107:3]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
2026-01-12 21:47:12,859 - tushare_duckdb - INFO -     margin_detail: 最近3日 [20260109:1957, 20260108:4283, 20260107:4283]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
2026-01-12 21:47:12,875 - tushare_duckdb - INFO -     margin_secs: 最近3日 [20260108:4295, 20260107:4295, 20260106:4295]
2026-01-12 21:47:12,875 - tushare_duckdb - INFO - 
  MONEYFLOW:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:12,897 - tushare_duckdb - INFO -     moneyflow: 最近3日 [20260109:5172, 20260108:5173, 20260107:5174]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:12,913 - tushare_duckdb - INFO -     moneyflow_ths: 最近3日 [20260109:5079, 20260108:5080, 20260107:5081]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:12,930 - tushare_duckdb - INFO -     moneyflow_dc: 最近3日 [20260109:5902, 20260108:5900, 20260107:5899]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:12,944 - tushare_duckdb - INFO -     moneyflow_ind_ths: 最近3日 [20260109:90, 20260108:90, 20260107:90]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:12,960 - tushare_duckdb - INFO -     moneyflow_ind_dc: 最近3日 [20260109:558, 20260108:558, 20260107:558]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:12,975 - tushare_duckdb - INFO -     moneyflow_mkt_dc: 最近3日 [20260109:1, 20260108:1, 20260107:1]
2026-01-12 21:47:12,975 - tushare_duckdb - INFO - 
  INDEX:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:12,994 - tushare_duckdb - INFO -     index_daily: 最近3日 [20260109:16, 20260108:16, 20260107:16]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:13,013 - tushare_duckdb - INFO -     index_dailybasic: 最近3日 [20260109:12, 20260108:12, 20260107:12]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:13,031 - tushare_duckdb - INFO -     daily_info: 最近3日 [20260109:12, 20260108:12, 20260107:12]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:13,048 - tushare_duckdb - INFO -     sz_daily_info: 最近3日 [20260109:14, 20260108:14, 20260107:14]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:13,069 - tushare_duckdb - INFO -     ths_daily: 最近3日 [20260109:1230, 20260108:1231, 20260107:1503]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:13,089 - tushare_duckdb - INFO -     dc_daily: 最近3日 [20260109:558, 20260108:558, 20260107:558]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:13,108 - tushare_duckdb - INFO -     ci_daily: 最近3日 [20260109:437, 20260108:437, 20260107:437]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:13,128 - tushare_duckdb - INFO -     sw_daily: 最近3日 [20260109:439, 20260108:439, 20260107:439]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:13,149 - tushare_duckdb - INFO -     tdx_daily: 最近3日 [20260109:614, 20260108:614, 20260107:614]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:13,168 - tushare_duckdb - INFO -     index_global: 最近3日 [20260109:20, 20260108:20, 20260107:20]
2026-01-12 21:47:13,168 - tushare_duckdb - INFO - 
  FUND:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:47:13,208 - tushare_duckdb - INFO -     fund_nav: 最近3日 [20260107:22855, 20260106:23537, 20260105:22839]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:47:13,226 - tushare_duckdb - INFO -     fund_daily: 最近3日 [20260108:1861, 20260107:1856, 20260106:1862]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:47:13,245 - tushare_duckdb - INFO -     fund_adj: 最近3日 [20260108:1871, 20260107:1868, 20260106:1868]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:47:13,264 - tushare_duckdb - INFO -     etf_share_size: 最近3日 [20260108:1390, 20260107:1387, 20260106:1387]
2026-01-12 21:47:13,264 - tushare_duckdb - INFO - 
  BOND:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:47:13,281 - tushare_duckdb - INFO -     cb_share: 最近3日 [20260109:64, 20260108:28, 20260107:76]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:47:13,299 - tushare_duckdb - INFO -     cb_daily: 最近3日 [20260109:384, 20260108:384, 20260107:384]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:47:13,318 - tushare_duckdb - INFO -     bond_blk: 最近3日 [20260105:11, 20251231:10, 20251230:15]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:47:13,337 - tushare_duckdb - INFO -     bond_blk_detail: 最近3日 [20260105:11, 20251231:10, 20251230:15]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:47:13,356 - tushare_duckdb - INFO -     repo_daily: 最近3日 [20260109:46, 20260108:48, 20260107:48]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:47:13,374 - tushare_duckdb - INFO -     yc_cb: 最近3日 [20260109:1006, 20260108:1006, 20260107:1006]
2026-01-12 21:47:13,374 - tushare_duckdb - INFO - 
  OPTION:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_opt.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_opt.db
2026-01-12 21:47:13,403 - tushare_duckdb - INFO -     opt_daily: 最近3日 [20260108:22690, 20260107:22020, 20260106:21548]
2026-01-12 21:47:13,403 - tushare_duckdb - INFO - 
  FUTURE:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:47:13,426 - tushare_duckdb - INFO -     fut_daily: 最近3日 [20260108:1069, 20260107:1069, 20260106:1069]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:47:13,445 - tushare_duckdb - INFO -     fut_wsr: 最近3日 [20260108:490, 20260107:490, 20260106:490]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:47:13,463 - tushare_duckdb - INFO -     fut_settle: 最近3日 [20251226:300, 20251225:300, 20251224:300]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:47:13,491 - tushare_duckdb - INFO -     fut_holding: 最近3日 [20260108:9450, 20260107:9668, 20260106:9732]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:47:13,510 - tushare_duckdb - INFO -     fut_index_daily: 最近3日 [20260108:95, 20260107:95, 20260106:95]
2026-01-12 21:47:13,511 - tushare_duckdb - INFO - 
  REFERENCE:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_ref.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_ref.db
2026-01-12 21:47:13,523 - tushare_duckdb - INFO -     block_trade: 最近3日 [20260109:79, 20260108:84, 20260107:85]
2026-01-12 21:47:13,523 - tushare_duckdb - INFO - 
  MACRO:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:47:13,538 - tushare_duckdb - INFO -     shibor: 最近3日 [20260109:1, 20260108:1, 20260107:1]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:47:13,554 - tushare_duckdb - INFO -     shibor_quote: 最近3日 [20260109:17, 20260108:18, 20260107:18]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:47:13,570 - tushare_duckdb - INFO -     us_tycr: 最近3日 [20251231:1, 20251230:1, 20251229:1]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:47:13,584 - tushare_duckdb - INFO -     us_trycr: 最近3日 [20251231:1, 20251230:1, 20251229:1]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:47:13,598 - tushare_duckdb - INFO -     us_tltr: 最近3日 [20251231:1, 20251230:1, 20251229:1]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:47:13,614 - tushare_duckdb - INFO -     us_trltr: 最近3日 [20251231:1, 20251230:1, 20251229:1]
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:47:13,629 - tushare_duckdb - INFO -     us_tbr: 最近3日 [20251231:1, 20251230:1, 20251229:1]
2026-01-12 21:47:13,629 - tushare_duckdb - INFO - 
  FX:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fx.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fx.db
2026-01-12 21:47:13,647 - tushare_duckdb - INFO -     fx_daily: 最近3日 [20260108:102, 20260107:102, 20260106:102]
2026-01-12 21:47:13,647 - tushare_duckdb - INFO - 
  COMMODITY:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_commodity.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_commodity.db
2026-01-12 21:47:13,661 - tushare_duckdb - INFO -     sge_daily: 最近3日 [20260109:41, 20260108:41, 20260107:41]
2026-01-12 21:47:13,661 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────────────────────────
2026-01-12 21:47:13,661 - tushare_duckdb - INFO -   [阶段2] 执行数据获取...
2026-01-12 21:47:13,661 - tushare_duckdb - INFO - ──────────────────────────────────────────────────────────────────────
2026-01-12 21:47:13,661 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:47:13,661 - tushare_duckdb - INFO - 类别: STOCK (6 个表)
2026-01-12 21:47:13,661 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:13,683 - tushare_duckdb - INFO -   → daily: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:13,683 - tushare_duckdb - INFO - 正在处理类别: STOCK | 数据库: tushare_duck_stock.db
2026-01-12 21:47:13,683 - tushare_duckdb - INFO - 选择表: daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db 
2026-01-12 21:47:13,699 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:13,699 - tushare_duckdb - INFO - → 正在更新表: daily
2026-01-12 21:47:13,699 - tushare_duckdb - INFO - daily: 处理参数组合 {}
2026-01-12 21:47:13,699 - tushare_duckdb - INFO - daily: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:13,699 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=daily
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:13,699 - tushare_duckdb - INFO - 开始获取 'daily': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:13,699 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'daily', 参数: {'trade_date': '20260108', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:15,121 - tushare_duckdb - INFO -   API返回 5459 行. 总计: 5459 行.
2026-01-12 21:47:15,123 - tushare_duckdb - INFO - daily: 合并前总行数: 5459
2026-01-12 21:47:15,126 - tushare_duckdb - INFO - daily 合并完成。总行数 (去重后): 5459
2026-01-12 21:47:15,183 - tushare_duckdb - INFO - daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'daily' 的元数据: min=19901219, max=20260109, count=17321353
2026-01-12 21:47:15,203 - tushare_duckdb - INFO - daily: 元数据更新完成
2026-01-12 21:47:15,206 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=daily
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:15,206 - tushare_duckdb - INFO - 开始获取 'daily': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:15,206 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'daily', 参数: {'trade_date': '20260109', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:15,814 - tushare_duckdb - INFO -   API返回 5459 行. 总计: 5459 行.
2026-01-12 21:47:15,815 - tushare_duckdb - INFO - daily: 合并前总行数: 5459
2026-01-12 21:47:15,817 - tushare_duckdb - INFO - daily 合并完成。总行数 (去重后): 5459
2026-01-12 21:47:15,863 - tushare_duckdb - INFO - daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'daily' 的元数据: min=19901219, max=20260109, count=17321353
2026-01-12 21:47:15,881 - tushare_duckdb - INFO - daily: 元数据更新完成
2026-01-12 21:47:15,881 - tushare_duckdb - INFO - daily: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:15,881 - tushare_duckdb - INFO - daily: 本轮处理结束
2026-01-12 21:47:15,881 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:15,988 - tushare_duckdb - INFO -   → adj_factor: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:15,988 - tushare_duckdb - INFO - 正在处理类别: STOCK | 数据库: tushare_duck_stock.db
2026-01-12 21:47:15,988 - tushare_duckdb - INFO - 选择表: adj_factor
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db 
2026-01-12 21:47:16,004 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:16,004 - tushare_duckdb - INFO - → 正在更新表: adj_factor
2026-01-12 21:47:16,004 - tushare_duckdb - INFO - adj_factor: 处理参数组合 {}
2026-01-12 21:47:16,004 - tushare_duckdb - INFO - adj_factor: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:16,004 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=adj_factor
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:16,004 - tushare_duckdb - INFO - 开始获取 'adj_factor': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:16,004 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'adj_factor', 参数: {'trade_date': '20260108', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:16,523 - tushare_duckdb - INFO -   API返回 5476 行. 总计: 5476 行.
2026-01-12 21:47:16,525 - tushare_duckdb - INFO - adj_factor: 合并前总行数: 5476
2026-01-12 21:47:16,528 - tushare_duckdb - INFO - adj_factor 合并完成。总行数 (去重后): 5476
2026-01-12 21:47:16,583 - tushare_duckdb - INFO - adj_factor: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'adj_factor' 的元数据: min=19901219, max=20260109, count=18141257
2026-01-12 21:47:16,601 - tushare_duckdb - INFO - adj_factor: 元数据更新完成
2026-01-12 21:47:16,601 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=adj_factor
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:16,601 - tushare_duckdb - INFO - 开始获取 'adj_factor': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:16,601 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'adj_factor', 参数: {'trade_date': '20260109', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:16,847 - tushare_duckdb - INFO -   API返回 5476 行. 总计: 5476 行.
2026-01-12 21:47:16,850 - tushare_duckdb - INFO - adj_factor: 合并前总行数: 5476
2026-01-12 21:47:16,852 - tushare_duckdb - INFO - adj_factor 合并完成。总行数 (去重后): 5476
2026-01-12 21:47:16,902 - tushare_duckdb - INFO - adj_factor: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'adj_factor' 的元数据: min=19901219, max=20260109, count=18141257
2026-01-12 21:47:16,920 - tushare_duckdb - INFO - adj_factor: 元数据更新完成
2026-01-12 21:47:16,921 - tushare_duckdb - INFO - adj_factor: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:16,921 - tushare_duckdb - INFO - adj_factor: 本轮处理结束
2026-01-12 21:47:16,921 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:17,022 - tushare_duckdb - INFO -   → daily_basic: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:17,022 - tushare_duckdb - INFO - 正在处理类别: STOCK | 数据库: tushare_duck_stock.db
2026-01-12 21:47:17,022 - tushare_duckdb - INFO - 选择表: daily_basic
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db 
2026-01-12 21:47:17,038 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:17,038 - tushare_duckdb - INFO - → 正在更新表: daily_basic
2026-01-12 21:47:17,039 - tushare_duckdb - INFO - daily_basic: 处理参数组合 {}
2026-01-12 21:47:17,039 - tushare_duckdb - INFO - daily_basic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:17,039 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=daily_basic
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:17,039 - tushare_duckdb - INFO - 开始获取 'daily_basic': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:17,039 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'daily_basic', 参数: {'trade_date': '20260108', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:19,328 - tushare_duckdb - INFO -   API返回 5459 行. 总计: 5459 行.
2026-01-12 21:47:19,330 - tushare_duckdb - INFO - daily_basic: 合并前总行数: 5459
2026-01-12 21:47:19,332 - tushare_duckdb - INFO - daily_basic 合并完成。总行数 (去重后): 5459
2026-01-12 21:47:19,384 - tushare_duckdb - INFO - daily_basic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'daily_basic' 的元数据: min=19901219, max=20260109, count=17622854
2026-01-12 21:47:19,402 - tushare_duckdb - INFO - daily_basic: 元数据更新完成
2026-01-12 21:47:19,402 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=daily_basic
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:19,402 - tushare_duckdb - INFO - 开始获取 'daily_basic': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:19,402 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'daily_basic', 参数: {'trade_date': '20260109', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:21,982 - tushare_duckdb - INFO -   API返回 5459 行. 总计: 5459 行.
2026-01-12 21:47:21,984 - tushare_duckdb - INFO - daily_basic: 合并前总行数: 5459
2026-01-12 21:47:21,986 - tushare_duckdb - INFO - daily_basic 合并完成。总行数 (去重后): 5459
2026-01-12 21:47:22,031 - tushare_duckdb - INFO - daily_basic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'daily_basic' 的元数据: min=19901219, max=20260109, count=17622854
2026-01-12 21:47:22,049 - tushare_duckdb - INFO - daily_basic: 元数据更新完成
2026-01-12 21:47:22,049 - tushare_duckdb - INFO - daily_basic: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:22,049 - tushare_duckdb - INFO - daily_basic: 本轮处理结束
2026-01-12 21:47:22,049 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:22,149 - tushare_duckdb - INFO -   → stk_limit: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:22,149 - tushare_duckdb - INFO - 正在处理类别: STOCK | 数据库: tushare_duck_stock.db
2026-01-12 21:47:22,149 - tushare_duckdb - INFO - 选择表: stk_limit
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db 
2026-01-12 21:47:22,165 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:22,165 - tushare_duckdb - INFO - → 正在更新表: stk_limit
2026-01-12 21:47:22,165 - tushare_duckdb - INFO - stk_limit: 处理参数组合 {}
2026-01-12 21:47:22,165 - tushare_duckdb - INFO - stk_limit: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:22,165 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=stk_limit
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:22,165 - tushare_duckdb - INFO - 开始获取 'stk_limit': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:22,165 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'stk_limit', 参数: {'trade_date': '20260108', 'limit': 7800, 'offset': 0}
2026-01-12 21:47:22,989 - tushare_duckdb - INFO -   API返回 7420 行. 总计: 7420 行.
2026-01-12 21:47:22,991 - tushare_duckdb - INFO - stk_limit: 合并前总行数: 7420
2026-01-12 21:47:22,993 - tushare_duckdb - INFO - stk_limit 合并完成。总行数 (去重后): 7420
2026-01-12 21:47:23,058 - tushare_duckdb - INFO - stk_limit: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'stk_limit' 的元数据: min=20070104, max=20260109, count=16879387
2026-01-12 21:47:23,075 - tushare_duckdb - INFO - stk_limit: 元数据更新完成
2026-01-12 21:47:23,076 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=stk_limit
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:23,076 - tushare_duckdb - INFO - 开始获取 'stk_limit': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:23,076 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'stk_limit', 参数: {'trade_date': '20260109', 'limit': 7800, 'offset': 0}
2026-01-12 21:47:23,603 - tushare_duckdb - INFO -   API返回 7421 行. 总计: 7421 行.
2026-01-12 21:47:23,605 - tushare_duckdb - INFO - stk_limit: 合并前总行数: 7421
2026-01-12 21:47:23,607 - tushare_duckdb - INFO - stk_limit 合并完成。总行数 (去重后): 7421
2026-01-12 21:47:23,664 - tushare_duckdb - INFO - stk_limit: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'stk_limit' 的元数据: min=20070104, max=20260109, count=16879387
2026-01-12 21:47:23,681 - tushare_duckdb - INFO - stk_limit: 元数据更新完成
2026-01-12 21:47:23,682 - tushare_duckdb - INFO - stk_limit: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:23,682 - tushare_duckdb - INFO - stk_limit: 本轮处理结束
2026-01-12 21:47:23,682 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:23,774 - tushare_duckdb - INFO -   → suspend_d: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:23,775 - tushare_duckdb - INFO - 正在处理类别: STOCK | 数据库: tushare_duck_stock.db
2026-01-12 21:47:23,775 - tushare_duckdb - INFO - 选择表: suspend_d
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db 
2026-01-12 21:47:23,792 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:23,792 - tushare_duckdb - INFO - → 正在更新表: suspend_d
2026-01-12 21:47:23,792 - tushare_duckdb - INFO - suspend_d: 处理参数组合 {}
2026-01-12 21:47:23,792 - tushare_duckdb - INFO - suspend_d: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=suspend_d
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109'}
2026-01-12 21:47:23,792 - tushare_duckdb - INFO - 开始获取 'suspend_d': 分页=True, API参数={'start_date': '20260108', 'end_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:23,792 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'suspend_d', 参数: {'start_date': '20260108', 'end_date': '20260109', 'limit': 5000, 'offset': 0}
2026-01-12 21:47:24,021 - tushare_duckdb - INFO -   API返回 25 行. 总计: 25 行.
2026-01-12 21:47:24,024 - tushare_duckdb - INFO - suspend_d: 合并前总行数: 25
2026-01-12 21:47:24,026 - tushare_duckdb - INFO - suspend_d 合并完成。总行数 (去重后): 25
2026-01-12 21:47:24,035 - tushare_duckdb - INFO - suspend_d: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'suspend_d' 的元数据: min=19990504, max=20260109, count=639019
2026-01-12 21:47:24,044 - tushare_duckdb - INFO - suspend_d: 元数据更新完成
2026-01-12 21:47:24,044 - tushare_duckdb - INFO - suspend_d: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:24,044 - tushare_duckdb - INFO - suspend_d: 本轮处理结束
2026-01-12 21:47:24,044 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:24,142 - tushare_duckdb - INFO -   → bak_basic: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:24,142 - tushare_duckdb - INFO - 正在处理类别: STOCK | 数据库: tushare_duck_stock.db
2026-01-12 21:47:24,142 - tushare_duckdb - INFO - 选择表: bak_basic
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db 
2026-01-12 21:47:24,158 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:24,158 - tushare_duckdb - INFO - → 正在更新表: bak_basic
2026-01-12 21:47:24,158 - tushare_duckdb - INFO - bak_basic: 处理参数组合 {}
2026-01-12 21:47:24,158 - tushare_duckdb - INFO - bak_basic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:24,158 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=bak_basic
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:24,158 - tushare_duckdb - INFO - 开始获取 'bak_basic': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:24,158 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'bak_basic', 参数: {'trade_date': '20260108', 'limit': 7000, 'offset': 0}
2026-01-12 21:47:25,867 - tushare_duckdb - INFO -   API返回 5471 行. 总计: 5471 行.
2026-01-12 21:47:25,870 - tushare_duckdb - INFO - bak_basic: 合并前总行数: 5471
2026-01-12 21:47:25,872 - tushare_duckdb - INFO - bak_basic 合并完成。总行数 (去重后): 5471
2026-01-12 21:47:25,917 - tushare_duckdb - INFO - bak_basic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'bak_basic' 的元数据: min=20160809, max=20260109, count=9999068
2026-01-12 21:47:25,930 - tushare_duckdb - INFO - bak_basic: 元数据更新完成
2026-01-12 21:47:25,930 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=bak_basic
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:25,930 - tushare_duckdb - INFO - 开始获取 'bak_basic': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:25,930 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'bak_basic', 参数: {'trade_date': '20260109', 'limit': 7000, 'offset': 0}
2026-01-12 21:47:27,465 - tushare_duckdb - INFO -   API返回 5472 行. 总计: 5472 行.
2026-01-12 21:47:27,468 - tushare_duckdb - INFO - bak_basic: 合并前总行数: 5472
2026-01-12 21:47:27,470 - tushare_duckdb - INFO - bak_basic 合并完成。总行数 (去重后): 5472
2026-01-12 21:47:27,510 - tushare_duckdb - INFO - bak_basic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'bak_basic' 的元数据: min=20160809, max=20260109, count=9999068
2026-01-12 21:47:27,522 - tushare_duckdb - INFO - bak_basic: 元数据更新完成
2026-01-12 21:47:27,523 - tushare_duckdb - INFO - bak_basic: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:27,523 - tushare_duckdb - INFO - bak_basic: 本轮处理结束
2026-01-12 21:47:27,523 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:27,600 - tushare_duckdb - INFO -   ✓ stock 完成: 6个成功, 0个失败, 存储0条
2026-01-12 21:47:27,600 - tushare_duckdb - INFO -   总进度: 6/51 表
2026-01-12 21:47:27,600 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:47:27,600 - tushare_duckdb - INFO - 类别: MARGIN (3 个表)
2026-01-12 21:47:27,600 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
2026-01-12 21:47:27,613 - tushare_duckdb - INFO -   → margin [回溯5天]: 20260104~20260109 (本地最新: 20260109)
2026-01-12 21:47:27,613 - tushare_duckdb - INFO - 正在处理类别: MARGIN | 数据库: tushare_duck_margin.db
2026-01-12 21:47:27,613 - tushare_duckdb - INFO - 选择表: margin
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:27,642 - tushare_duckdb - INFO - 日期范围: 20260104 ~ 20260109，共 5 个交易日
2026-01-12 21:47:27,642 - tushare_duckdb - INFO - → 正在更新表: margin
2026-01-12 21:47:27,642 - tushare_duckdb - INFO - margin: 处理参数组合 {}
2026-01-12 21:47:27,642 - tushare_duckdb - INFO - margin: date_param_mode=single，强制逐日拉取（共 5 天）
2026-01-12 21:47:27,642 - tushare_duckdb - INFO -   → 正在拉取: 20260105
DEBUG: build_api_params called, table_name=margin
DEBUG: build_api_params → {'trade_date': '20260105'}
2026-01-12 21:47:27,642 - tushare_duckdb - INFO - 开始获取 'margin': 分页=False, API参数={'trade_date': '20260105'}, 唯一键=['trade_date', 'exchange_id']
2026-01-12 21:47:27,642 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin', 参数: {'trade_date': '20260105', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:27,776 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:47:27,777 - tushare_duckdb - INFO - margin: 合并前总行数: 3
2026-01-12 21:47:27,778 - tushare_duckdb - INFO - margin 合并完成。总行数 (去重后): 3
2026-01-12 21:47:27,783 - tushare_duckdb - INFO - margin: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'margin' 的元数据: min=20100331, max=20260109, count=6780
2026-01-12 21:47:27,791 - tushare_duckdb - INFO - margin: 元数据更新完成
2026-01-12 21:47:27,791 - tushare_duckdb - INFO -   → 正在拉取: 20260106
DEBUG: build_api_params called, table_name=margin
DEBUG: build_api_params → {'trade_date': '20260106'}
2026-01-12 21:47:27,791 - tushare_duckdb - INFO - 开始获取 'margin': 分页=False, API参数={'trade_date': '20260106'}, 唯一键=['trade_date', 'exchange_id']
2026-01-12 21:47:27,791 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin', 参数: {'trade_date': '20260106', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:27,912 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:47:27,914 - tushare_duckdb - INFO - margin: 合并前总行数: 3
2026-01-12 21:47:27,915 - tushare_duckdb - INFO - margin 合并完成。总行数 (去重后): 3
2026-01-12 21:47:27,920 - tushare_duckdb - INFO - margin: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'margin' 的元数据: min=20100331, max=20260109, count=6780
2026-01-12 21:47:27,927 - tushare_duckdb - INFO - margin: 元数据更新完成
2026-01-12 21:47:27,927 - tushare_duckdb - INFO -   → 正在拉取: 20260107
DEBUG: build_api_params called, table_name=margin
DEBUG: build_api_params → {'trade_date': '20260107'}
2026-01-12 21:47:27,927 - tushare_duckdb - INFO - 开始获取 'margin': 分页=False, API参数={'trade_date': '20260107'}, 唯一键=['trade_date', 'exchange_id']
2026-01-12 21:47:27,927 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin', 参数: {'trade_date': '20260107', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:28,069 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:47:28,070 - tushare_duckdb - INFO - margin: 合并前总行数: 3
2026-01-12 21:47:28,071 - tushare_duckdb - INFO - margin 合并完成。总行数 (去重后): 3
2026-01-12 21:47:28,078 - tushare_duckdb - INFO - margin: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'margin' 的元数据: min=20100331, max=20260109, count=6780
2026-01-12 21:47:28,086 - tushare_duckdb - INFO - margin: 元数据更新完成
2026-01-12 21:47:28,086 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=margin
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:28,086 - tushare_duckdb - INFO - 开始获取 'margin': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['trade_date', 'exchange_id']
2026-01-12 21:47:28,086 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:28,279 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:47:28,281 - tushare_duckdb - INFO - margin: 合并前总行数: 3
2026-01-12 21:47:28,282 - tushare_duckdb - INFO - margin 合并完成。总行数 (去重后): 3
2026-01-12 21:47:28,291 - tushare_duckdb - INFO - margin: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'margin' 的元数据: min=20100331, max=20260109, count=6780
2026-01-12 21:47:28,299 - tushare_duckdb - INFO - margin: 元数据更新完成
2026-01-12 21:47:28,300 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=margin
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:28,300 - tushare_duckdb - INFO - 开始获取 'margin': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['trade_date', 'exchange_id']
2026-01-12 21:47:28,300 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:28,436 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:47:28,438 - tushare_duckdb - INFO - margin: 合并前总行数: 3
2026-01-12 21:47:28,439 - tushare_duckdb - INFO - margin 合并完成。总行数 (去重后): 3
2026-01-12 21:47:28,447 - tushare_duckdb - INFO - margin: 实际插入 2 条新记录（NOT EXISTS 去重后）
已更新表 'margin' 的元数据: min=20100331, max=20260109, count=6782
2026-01-12 21:47:28,455 - tushare_duckdb - INFO - margin: 元数据更新完成
2026-01-12 21:47:28,455 - tushare_duckdb - INFO - margin: 日期处理完成。本轮总共存储 2 条。
2026-01-12 21:47:28,455 - tushare_duckdb - INFO - margin: 本轮处理结束
2026-01-12 21:47:28,455 - tushare_duckdb - INFO -  → 本表完成，存储 2 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
2026-01-12 21:47:28,495 - tushare_duckdb - INFO -   → margin_detail [回溯5天]: 20260104~20260109 (本地最新: 20260109)
2026-01-12 21:47:28,495 - tushare_duckdb - INFO - 正在处理类别: MARGIN | 数据库: tushare_duck_margin.db
2026-01-12 21:47:28,495 - tushare_duckdb - INFO - 选择表: margin_detail
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:28,521 - tushare_duckdb - INFO - 日期范围: 20260104 ~ 20260109，共 5 个交易日
2026-01-12 21:47:28,522 - tushare_duckdb - INFO - → 正在更新表: margin_detail
2026-01-12 21:47:28,522 - tushare_duckdb - INFO - margin_detail: 处理参数组合 {}
2026-01-12 21:47:28,522 - tushare_duckdb - INFO - margin_detail: date_param_mode=single，强制逐日拉取（共 5 天）
2026-01-12 21:47:28,522 - tushare_duckdb - INFO -   → 正在拉取: 20260105
DEBUG: build_api_params called, table_name=margin_detail
DEBUG: build_api_params → {'trade_date': '20260105'}
2026-01-12 21:47:28,522 - tushare_duckdb - INFO - 开始获取 'margin_detail': 分页=False, API参数={'trade_date': '20260105'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:28,522 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin_detail', 参数: {'trade_date': '20260105', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:29,286 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 4000 行.
2026-01-12 21:47:29,288 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'margin_detail', 参数: {'trade_date': '20260105', 'limit': 4000, 'offset': 4000}
2026-01-12 21:47:29,484 - tushare_duckdb - INFO -   API返回 283 行. 总计: 4283 行.
2026-01-12 21:47:29,487 - tushare_duckdb - INFO - margin_detail: 合并前总行数: 4283
2026-01-12 21:47:29,489 - tushare_duckdb - INFO - margin_detail 合并完成。总行数 (去重后): 4283
2026-01-12 21:47:29,525 - tushare_duckdb - INFO - margin_detail: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'margin_detail' 的元数据: min=20100331, max=20260109, count=6106348
2026-01-12 21:47:29,536 - tushare_duckdb - INFO - margin_detail: 元数据更新完成
2026-01-12 21:47:29,536 - tushare_duckdb - INFO -   → 正在拉取: 20260106
DEBUG: build_api_params called, table_name=margin_detail
DEBUG: build_api_params → {'trade_date': '20260106'}
2026-01-12 21:47:29,536 - tushare_duckdb - INFO - 开始获取 'margin_detail': 分页=False, API参数={'trade_date': '20260106'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:29,536 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin_detail', 参数: {'trade_date': '20260106', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:30,195 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 4000 行.
2026-01-12 21:47:30,196 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'margin_detail', 参数: {'trade_date': '20260106', 'limit': 4000, 'offset': 4000}
2026-01-12 21:47:30,437 - tushare_duckdb - INFO -   API返回 283 行. 总计: 4283 行.
2026-01-12 21:47:30,439 - tushare_duckdb - INFO - margin_detail: 合并前总行数: 4283
2026-01-12 21:47:30,442 - tushare_duckdb - INFO - margin_detail 合并完成。总行数 (去重后): 4283
2026-01-12 21:47:30,475 - tushare_duckdb - INFO - margin_detail: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'margin_detail' 的元数据: min=20100331, max=20260109, count=6106348
2026-01-12 21:47:30,485 - tushare_duckdb - INFO - margin_detail: 元数据更新完成
2026-01-12 21:47:30,486 - tushare_duckdb - INFO -   → 正在拉取: 20260107
DEBUG: build_api_params called, table_name=margin_detail
DEBUG: build_api_params → {'trade_date': '20260107'}
2026-01-12 21:47:30,486 - tushare_duckdb - INFO - 开始获取 'margin_detail': 分页=False, API参数={'trade_date': '20260107'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:30,486 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin_detail', 参数: {'trade_date': '20260107', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:31,075 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 4000 行.
2026-01-12 21:47:31,077 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'margin_detail', 参数: {'trade_date': '20260107', 'limit': 4000, 'offset': 4000}
2026-01-12 21:47:31,362 - tushare_duckdb - INFO -   API返回 283 行. 总计: 4283 行.
2026-01-12 21:47:31,365 - tushare_duckdb - INFO - margin_detail: 合并前总行数: 4283
2026-01-12 21:47:31,367 - tushare_duckdb - INFO - margin_detail 合并完成。总行数 (去重后): 4283
2026-01-12 21:47:31,400 - tushare_duckdb - INFO - margin_detail: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'margin_detail' 的元数据: min=20100331, max=20260109, count=6106348
2026-01-12 21:47:31,410 - tushare_duckdb - INFO - margin_detail: 元数据更新完成
2026-01-12 21:47:31,410 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=margin_detail
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:31,410 - tushare_duckdb - INFO - 开始获取 'margin_detail': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:31,410 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin_detail', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:32,005 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 4000 行.
2026-01-12 21:47:32,007 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'margin_detail', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 4000}
2026-01-12 21:47:32,207 - tushare_duckdb - INFO -   API返回 283 行. 总计: 4283 行.
2026-01-12 21:47:32,209 - tushare_duckdb - INFO - margin_detail: 合并前总行数: 4283
2026-01-12 21:47:32,212 - tushare_duckdb - INFO - margin_detail 合并完成。总行数 (去重后): 4283
2026-01-12 21:47:32,247 - tushare_duckdb - INFO - margin_detail: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'margin_detail' 的元数据: min=20100331, max=20260109, count=6106348
2026-01-12 21:47:32,257 - tushare_duckdb - INFO - margin_detail: 元数据更新完成
2026-01-12 21:47:32,258 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=margin_detail
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:32,258 - tushare_duckdb - INFO - 开始获取 'margin_detail': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:32,258 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin_detail', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:32,953 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 4000 行.
2026-01-12 21:47:32,954 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'margin_detail', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 4000}
2026-01-12 21:47:33,187 - tushare_duckdb - INFO -   API返回 282 行. 总计: 4282 行.
2026-01-12 21:47:33,189 - tushare_duckdb - INFO - margin_detail: 合并前总行数: 4282
2026-01-12 21:47:33,193 - tushare_duckdb - INFO - margin_detail 合并完成。总行数 (去重后): 4282
2026-01-12 21:47:33,228 - tushare_duckdb - INFO - margin_detail: 实际插入 2325 条新记录（NOT EXISTS 去重后）
已更新表 'margin_detail' 的元数据: min=20100331, max=20260109, count=6108673
2026-01-12 21:47:33,238 - tushare_duckdb - INFO - margin_detail: 元数据更新完成
2026-01-12 21:47:33,239 - tushare_duckdb - INFO - margin_detail: 日期处理完成。本轮总共存储 2325 条。
2026-01-12 21:47:33,239 - tushare_duckdb - INFO - margin_detail: 本轮处理结束
2026-01-12 21:47:33,239 - tushare_duckdb - INFO -  → 本表完成，存储 2325 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
2026-01-12 21:47:33,274 - tushare_duckdb - INFO -   → margin_secs: 20260107~20260109 (本地最新: 20260108)
2026-01-12 21:47:33,274 - tushare_duckdb - INFO - 正在处理类别: MARGIN | 数据库: tushare_duck_margin.db
2026-01-12 21:47:33,274 - tushare_duckdb - INFO - 选择表: margin_secs
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:33,302 - tushare_duckdb - INFO - 日期范围: 20260107 ~ 20260109，共 3 个交易日
2026-01-12 21:47:33,302 - tushare_duckdb - INFO - → 正在更新表: margin_secs
2026-01-12 21:47:33,302 - tushare_duckdb - INFO - margin_secs: 处理参数组合 {}
2026-01-12 21:47:33,302 - tushare_duckdb - INFO - margin_secs: date_param_mode=single，强制逐日拉取（共 3 天）
2026-01-12 21:47:33,302 - tushare_duckdb - INFO -   → 正在拉取: 20260107
DEBUG: build_api_params called, table_name=margin_secs
DEBUG: build_api_params → {'trade_date': '20260107'}
2026-01-12 21:47:33,302 - tushare_duckdb - INFO - 开始获取 'margin_secs': 分页=False, API参数={'trade_date': '20260107'}, 唯一键=['trade_date', 'ts_code']
2026-01-12 21:47:33,302 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin_secs', 参数: {'trade_date': '20260107', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:33,687 - tushare_duckdb - INFO -   API返回 4295 行. 总计: 4295 行.
2026-01-12 21:47:33,689 - tushare_duckdb - INFO - margin_secs: 合并前总行数: 4295
2026-01-12 21:47:33,691 - tushare_duckdb - INFO - margin_secs 合并完成。总行数 (去重后): 4295
2026-01-12 21:47:33,725 - tushare_duckdb - INFO - margin_secs: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'margin_secs' 的元数据: min=20100329, max=20260108, count=4524884
2026-01-12 21:47:33,734 - tushare_duckdb - INFO - margin_secs: 元数据更新完成
2026-01-12 21:47:33,735 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=margin_secs
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:33,735 - tushare_duckdb - INFO - 开始获取 'margin_secs': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['trade_date', 'ts_code']
2026-01-12 21:47:33,735 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin_secs', 参数: {'trade_date': '20260108', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:34,091 - tushare_duckdb - INFO -   API返回 4295 行. 总计: 4295 行.
2026-01-12 21:47:34,093 - tushare_duckdb - INFO - margin_secs: 合并前总行数: 4295
2026-01-12 21:47:34,094 - tushare_duckdb - INFO - margin_secs 合并完成。总行数 (去重后): 4295
2026-01-12 21:47:34,121 - tushare_duckdb - INFO - margin_secs: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'margin_secs' 的元数据: min=20100329, max=20260108, count=4524884
2026-01-12 21:47:34,129 - tushare_duckdb - INFO - margin_secs: 元数据更新完成
2026-01-12 21:47:34,129 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=margin_secs
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:34,130 - tushare_duckdb - INFO - 开始获取 'margin_secs': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['trade_date', 'ts_code']
2026-01-12 21:47:34,130 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'margin_secs', 参数: {'trade_date': '20260109', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:34,407 - tushare_duckdb - INFO -   API返回 4295 行. 总计: 4295 行.
2026-01-12 21:47:34,409 - tushare_duckdb - INFO - margin_secs: 合并前总行数: 4295
2026-01-12 21:47:34,411 - tushare_duckdb - INFO - margin_secs 合并完成。总行数 (去重后): 4295
2026-01-12 21:47:34,446 - tushare_duckdb - INFO - margin_secs: 实际插入 4295 条新记录（NOT EXISTS 去重后）
已更新表 'margin_secs' 的元数据: min=20100329, max=20260109, count=4529179
2026-01-12 21:47:34,455 - tushare_duckdb - INFO - margin_secs: 元数据更新完成
2026-01-12 21:47:34,455 - tushare_duckdb - INFO - margin_secs: 日期处理完成。本轮总共存储 4295 条。
2026-01-12 21:47:34,455 - tushare_duckdb - INFO - margin_secs: 本轮处理结束
2026-01-12 21:47:34,455 - tushare_duckdb - INFO -  → 本表完成，存储 4295 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
2026-01-12 21:47:34,477 - tushare_duckdb - INFO -   ✓ margin 完成: 3个成功, 0个失败, 存储6622条
2026-01-12 21:47:34,477 - tushare_duckdb - INFO -   总进度: 9/51 表
2026-01-12 21:47:34,477 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:47:34,477 - tushare_duckdb - INFO - 类别: MONEYFLOW (6 个表)
2026-01-12 21:47:34,477 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:34,497 - tushare_duckdb - INFO -   → moneyflow: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:34,497 - tushare_duckdb - INFO - 正在处理类别: MONEYFLOW | 数据库: tushare_duck_moneyflow.db
2026-01-12 21:47:34,497 - tushare_duckdb - INFO - 选择表: moneyflow
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:34,524 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:34,524 - tushare_duckdb - INFO - → 正在更新表: moneyflow
2026-01-12 21:47:34,524 - tushare_duckdb - INFO - moneyflow: 处理参数组合 {}
2026-01-12 21:47:34,524 - tushare_duckdb - INFO - moneyflow: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:34,524 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=moneyflow
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:34,524 - tushare_duckdb - INFO - 开始获取 'moneyflow': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:34,524 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow', 参数: {'trade_date': '20260108', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:36,020 - tushare_duckdb - INFO -   API返回 5173 行. 总计: 5173 行.
2026-01-12 21:47:36,022 - tushare_duckdb - INFO - moneyflow: 合并前总行数: 5173
2026-01-12 21:47:36,024 - tushare_duckdb - INFO - moneyflow 合并完成。总行数 (去重后): 5173
2026-01-12 21:47:36,066 - tushare_duckdb - INFO - moneyflow: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow' 的元数据: min=20090105, max=20260109, count=13359827
2026-01-12 21:47:36,083 - tushare_duckdb - INFO - moneyflow: 元数据更新完成
2026-01-12 21:47:36,083 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=moneyflow
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:36,083 - tushare_duckdb - INFO - 开始获取 'moneyflow': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:36,083 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow', 参数: {'trade_date': '20260109', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:38,198 - tushare_duckdb - INFO -   API返回 5172 行. 总计: 5172 行.
2026-01-12 21:47:38,200 - tushare_duckdb - INFO - moneyflow: 合并前总行数: 5172
2026-01-12 21:47:38,202 - tushare_duckdb - INFO - moneyflow 合并完成。总行数 (去重后): 5172
2026-01-12 21:47:38,241 - tushare_duckdb - INFO - moneyflow: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow' 的元数据: min=20090105, max=20260109, count=13359827
2026-01-12 21:47:38,256 - tushare_duckdb - INFO - moneyflow: 元数据更新完成
2026-01-12 21:47:38,256 - tushare_duckdb - INFO - moneyflow: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:38,256 - tushare_duckdb - INFO - moneyflow: 本轮处理结束
2026-01-12 21:47:38,256 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:38,319 - tushare_duckdb - INFO -   → moneyflow_ths: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:38,320 - tushare_duckdb - INFO - 正在处理类别: MONEYFLOW | 数据库: tushare_duck_moneyflow.db
2026-01-12 21:47:38,320 - tushare_duckdb - INFO - 选择表: moneyflow_ths
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:38,348 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:38,348 - tushare_duckdb - INFO - → 正在更新表: moneyflow_ths
2026-01-12 21:47:38,348 - tushare_duckdb - INFO - moneyflow_ths: 处理参数组合 {}
2026-01-12 21:47:38,348 - tushare_duckdb - INFO - moneyflow_ths: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:38,348 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=moneyflow_ths
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:38,348 - tushare_duckdb - INFO - 开始获取 'moneyflow_ths': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:38,348 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow_ths', 参数: {'trade_date': '20260108', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:39,498 - tushare_duckdb - INFO -   API返回 5085 行. 总计: 5085 行.
2026-01-12 21:47:39,500 - tushare_duckdb - INFO - moneyflow_ths: 合并前总行数: 5085
2026-01-12 21:47:39,501 - tushare_duckdb - INFO - moneyflow_ths 合并完成。总行数 (去重后): 5085
2026-01-12 21:47:39,531 - tushare_duckdb - INFO - moneyflow_ths: 实际插入 5 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow_ths' 的元数据: min=20241219, max=20260109, count=1288017
2026-01-12 21:47:39,538 - tushare_duckdb - INFO - moneyflow_ths: 元数据更新完成
2026-01-12 21:47:39,538 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=moneyflow_ths
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:39,538 - tushare_duckdb - INFO - 开始获取 'moneyflow_ths': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:39,538 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow_ths', 参数: {'trade_date': '20260109', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:40,326 - tushare_duckdb - INFO -   API返回 5083 行. 总计: 5083 行.
2026-01-12 21:47:40,328 - tushare_duckdb - INFO - moneyflow_ths: 合并前总行数: 5083
2026-01-12 21:47:40,330 - tushare_duckdb - INFO - moneyflow_ths 合并完成。总行数 (去重后): 5083
2026-01-12 21:47:40,360 - tushare_duckdb - INFO - moneyflow_ths: 实际插入 4 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow_ths' 的元数据: min=20241219, max=20260109, count=1288021
2026-01-12 21:47:40,366 - tushare_duckdb - INFO - moneyflow_ths: 元数据更新完成
2026-01-12 21:47:40,367 - tushare_duckdb - INFO - moneyflow_ths: 日期处理完成。本轮总共存储 9 条。
2026-01-12 21:47:40,367 - tushare_duckdb - INFO - moneyflow_ths: 本轮处理结束
2026-01-12 21:47:40,367 - tushare_duckdb - INFO -  → 本表完成，存储 9 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:40,423 - tushare_duckdb - INFO -   → moneyflow_dc: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:40,423 - tushare_duckdb - INFO - 正在处理类别: MONEYFLOW | 数据库: tushare_duck_moneyflow.db
2026-01-12 21:47:40,423 - tushare_duckdb - INFO - 选择表: moneyflow_dc
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:40,451 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:40,451 - tushare_duckdb - INFO - → 正在更新表: moneyflow_dc
2026-01-12 21:47:40,451 - tushare_duckdb - INFO - moneyflow_dc: 处理参数组合 {}
2026-01-12 21:47:40,451 - tushare_duckdb - INFO - moneyflow_dc: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:40,451 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=moneyflow_dc
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:40,451 - tushare_duckdb - INFO - 开始获取 'moneyflow_dc': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:40,451 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow_dc', 参数: {'trade_date': '20260108', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:41,600 - tushare_duckdb - INFO -   API返回 5900 行. 总计: 5900 行.
2026-01-12 21:47:41,603 - tushare_duckdb - INFO - moneyflow_dc: 合并前总行数: 5900
2026-01-12 21:47:41,605 - tushare_duckdb - INFO - moneyflow_dc 合并完成。总行数 (去重后): 5900
2026-01-12 21:47:41,641 - tushare_duckdb - INFO - moneyflow_dc: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow_dc' 的元数据: min=20230911, max=20260109, count=3197007
2026-01-12 21:47:41,649 - tushare_duckdb - INFO - moneyflow_dc: 元数据更新完成
2026-01-12 21:47:41,649 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=moneyflow_dc
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:41,649 - tushare_duckdb - INFO - 开始获取 'moneyflow_dc': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:41,650 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow_dc', 参数: {'trade_date': '20260109', 'limit': 6000, 'offset': 0}
2026-01-12 21:47:42,791 - tushare_duckdb - INFO -   API返回 5902 行. 总计: 5902 行.
2026-01-12 21:47:42,793 - tushare_duckdb - INFO - moneyflow_dc: 合并前总行数: 5902
2026-01-12 21:47:42,795 - tushare_duckdb - INFO - moneyflow_dc 合并完成。总行数 (去重后): 5902
2026-01-12 21:47:42,831 - tushare_duckdb - INFO - moneyflow_dc: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow_dc' 的元数据: min=20230911, max=20260109, count=3197007
2026-01-12 21:47:42,840 - tushare_duckdb - INFO - moneyflow_dc: 元数据更新完成
2026-01-12 21:47:42,840 - tushare_duckdb - INFO - moneyflow_dc: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:42,840 - tushare_duckdb - INFO - moneyflow_dc: 本轮处理结束
2026-01-12 21:47:42,840 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:42,894 - tushare_duckdb - INFO -   → moneyflow_ind_ths: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:42,894 - tushare_duckdb - INFO - 正在处理类别: MONEYFLOW | 数据库: tushare_duck_moneyflow.db
2026-01-12 21:47:42,894 - tushare_duckdb - INFO - 选择表: moneyflow_ind_ths
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:42,922 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:42,923 - tushare_duckdb - INFO - → 正在更新表: moneyflow_ind_ths
2026-01-12 21:47:42,923 - tushare_duckdb - INFO - moneyflow_ind_ths: 处理参数组合 {}
2026-01-12 21:47:42,923 - tushare_duckdb - INFO - moneyflow_ind_ths: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:42,923 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=moneyflow_ind_ths
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:42,923 - tushare_duckdb - INFO - 开始获取 'moneyflow_ind_ths': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:42,923 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow_ind_ths', 参数: {'trade_date': '20260108', 'limit': 5000, 'offset': 0}
2026-01-12 21:47:43,074 - tushare_duckdb - INFO -   API返回 90 行. 总计: 90 行.
2026-01-12 21:47:43,074 - tushare_duckdb - INFO - moneyflow_ind_ths: 合并前总行数: 90
2026-01-12 21:47:43,075 - tushare_duckdb - INFO - moneyflow_ind_ths 合并完成。总行数 (去重后): 90
2026-01-12 21:47:43,082 - tushare_duckdb - INFO - moneyflow_ind_ths: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow_ind_ths' 的元数据: min=20240910, max=20260109, count=28800
2026-01-12 21:47:43,090 - tushare_duckdb - INFO - moneyflow_ind_ths: 元数据更新完成
2026-01-12 21:47:43,090 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=moneyflow_ind_ths
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:43,090 - tushare_duckdb - INFO - 开始获取 'moneyflow_ind_ths': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:43,090 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow_ind_ths', 参数: {'trade_date': '20260109', 'limit': 5000, 'offset': 0}
2026-01-12 21:47:43,256 - tushare_duckdb - INFO -   API返回 90 行. 总计: 90 行.
2026-01-12 21:47:43,258 - tushare_duckdb - INFO - moneyflow_ind_ths: 合并前总行数: 90
2026-01-12 21:47:43,260 - tushare_duckdb - INFO - moneyflow_ind_ths 合并完成。总行数 (去重后): 90
2026-01-12 21:47:43,270 - tushare_duckdb - INFO - moneyflow_ind_ths: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow_ind_ths' 的元数据: min=20240910, max=20260109, count=28800
2026-01-12 21:47:43,279 - tushare_duckdb - INFO - moneyflow_ind_ths: 元数据更新完成
2026-01-12 21:47:43,279 - tushare_duckdb - INFO - moneyflow_ind_ths: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:43,279 - tushare_duckdb - INFO - moneyflow_ind_ths: 本轮处理结束
2026-01-12 21:47:43,279 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:43,334 - tushare_duckdb - INFO -   → moneyflow_ind_dc: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:43,334 - tushare_duckdb - INFO - 正在处理类别: MONEYFLOW | 数据库: tushare_duck_moneyflow.db
2026-01-12 21:47:43,334 - tushare_duckdb - INFO - 选择表: moneyflow_ind_dc
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:43,363 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:43,363 - tushare_duckdb - INFO - → 正在更新表: moneyflow_ind_dc
2026-01-12 21:47:43,363 - tushare_duckdb - INFO - moneyflow_ind_dc: 处理参数组合 {}
2026-01-12 21:47:43,363 - tushare_duckdb - INFO - moneyflow_ind_dc: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:43,363 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=moneyflow_ind_dc
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:43,364 - tushare_duckdb - INFO - 开始获取 'moneyflow_ind_dc': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:43,364 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow_ind_dc', 参数: {'trade_date': '20260108', 'limit': 5000, 'offset': 0}
2026-01-12 21:47:43,620 - tushare_duckdb - INFO -   API返回 558 行. 总计: 558 行.
2026-01-12 21:47:43,622 - tushare_duckdb - INFO - moneyflow_ind_dc: 合并前总行数: 558
2026-01-12 21:47:43,624 - tushare_duckdb - INFO - moneyflow_ind_dc 合并完成。总行数 (去重后): 558
2026-01-12 21:47:43,640 - tushare_duckdb - INFO - moneyflow_ind_dc: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow_ind_dc' 的元数据: min=20240102, max=20260109, count=143189
2026-01-12 21:47:43,648 - tushare_duckdb - INFO - moneyflow_ind_dc: 元数据更新完成
2026-01-12 21:47:43,648 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=moneyflow_ind_dc
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:43,648 - tushare_duckdb - INFO - 开始获取 'moneyflow_ind_dc': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:43,648 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow_ind_dc', 参数: {'trade_date': '20260109', 'limit': 5000, 'offset': 0}
2026-01-12 21:47:43,951 - tushare_duckdb - INFO -   API返回 558 行. 总计: 558 行.
2026-01-12 21:47:43,953 - tushare_duckdb - INFO - moneyflow_ind_dc: 合并前总行数: 558
2026-01-12 21:47:43,954 - tushare_duckdb - INFO - moneyflow_ind_dc 合并完成。总行数 (去重后): 558
2026-01-12 21:47:43,969 - tushare_duckdb - INFO - moneyflow_ind_dc: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow_ind_dc' 的元数据: min=20240102, max=20260109, count=143189
2026-01-12 21:47:43,977 - tushare_duckdb - INFO - moneyflow_ind_dc: 元数据更新完成
2026-01-12 21:47:43,977 - tushare_duckdb - INFO - moneyflow_ind_dc: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:43,977 - tushare_duckdb - INFO - moneyflow_ind_dc: 本轮处理结束
2026-01-12 21:47:43,977 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:44,032 - tushare_duckdb - INFO -   → moneyflow_mkt_dc: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:44,032 - tushare_duckdb - INFO - 正在处理类别: MONEYFLOW | 数据库: tushare_duck_moneyflow.db
2026-01-12 21:47:44,032 - tushare_duckdb - INFO - 选择表: moneyflow_mkt_dc
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:44,059 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:44,059 - tushare_duckdb - INFO - → 正在更新表: moneyflow_mkt_dc
2026-01-12 21:47:44,059 - tushare_duckdb - INFO - moneyflow_mkt_dc: 处理参数组合 {}
2026-01-12 21:47:44,059 - tushare_duckdb - INFO - moneyflow_mkt_dc: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:44,059 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=moneyflow_mkt_dc
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:44,059 - tushare_duckdb - INFO - 开始获取 'moneyflow_mkt_dc': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['trade_date']
2026-01-12 21:47:44,059 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow_mkt_dc', 参数: {'trade_date': '20260108', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:44,313 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:44,316 - tushare_duckdb - INFO - moneyflow_mkt_dc: 合并前总行数: 1
2026-01-12 21:47:44,317 - tushare_duckdb - INFO - moneyflow_mkt_dc 合并完成。总行数 (去重后): 1
2026-01-12 21:47:44,325 - tushare_duckdb - INFO - moneyflow_mkt_dc: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow_mkt_dc' 的元数据: min=20230417, max=20260109, count=664
2026-01-12 21:47:44,334 - tushare_duckdb - INFO - moneyflow_mkt_dc: 元数据更新完成
2026-01-12 21:47:44,334 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=moneyflow_mkt_dc
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:44,334 - tushare_duckdb - INFO - 开始获取 'moneyflow_mkt_dc': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['trade_date']
2026-01-12 21:47:44,334 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'moneyflow_mkt_dc', 参数: {'trade_date': '20260109', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:44,562 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:44,564 - tushare_duckdb - INFO - moneyflow_mkt_dc: 合并前总行数: 1
2026-01-12 21:47:44,565 - tushare_duckdb - INFO - moneyflow_mkt_dc 合并完成。总行数 (去重后): 1
2026-01-12 21:47:44,571 - tushare_duckdb - INFO - moneyflow_mkt_dc: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'moneyflow_mkt_dc' 的元数据: min=20230417, max=20260109, count=664
2026-01-12 21:47:44,577 - tushare_duckdb - INFO - moneyflow_mkt_dc: 元数据更新完成
2026-01-12 21:47:44,578 - tushare_duckdb - INFO - moneyflow_mkt_dc: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:44,578 - tushare_duckdb - INFO - moneyflow_mkt_dc: 本轮处理结束
2026-01-12 21:47:44,578 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:47:44,620 - tushare_duckdb - INFO -   ✓ moneyflow 完成: 6个成功, 0个失败, 存储9条
2026-01-12 21:47:44,620 - tushare_duckdb - INFO -   总进度: 15/51 表
2026-01-12 21:47:44,620 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:47:44,620 - tushare_duckdb - INFO - 类别: INDEX (10 个表)
2026-01-12 21:47:44,620 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:44,639 - tushare_duckdb - INFO -   → index_daily: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:44,639 - tushare_duckdb - INFO - 正在处理类别: INDEX | 数据库: tushare_duck_index.db
2026-01-12 21:47:44,639 - tushare_duckdb - INFO - 选择表: index_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:44,670 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:44,670 - tushare_duckdb - INFO - → 正在更新表: index_daily
2026-01-12 21:47:44,670 - tushare_duckdb - INFO - index_daily: 生成参数组合，共 16 种
2026-01-12 21:47:44,670 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '000001.SH'}
2026-01-12 21:47:44,670 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000001.SH'}
2026-01-12 21:47:44,670 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000001.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:44,670 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000001.SH', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:44,811 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:44,812 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:44,813 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:44,821 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:44,830 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:44,830 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '000005.SH'}
2026-01-12 21:47:44,830 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000005.SH'}
2026-01-12 21:47:44,830 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000005.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:44,831 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000005.SH', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:45,182 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:45,184 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:45,185 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:45,192 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:45,201 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:45,202 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '000006.SH'}
2026-01-12 21:47:45,202 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000006.SH'}
2026-01-12 21:47:45,202 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000006.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:45,202 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000006.SH', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:45,354 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:45,356 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:45,358 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:45,367 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:45,376 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:45,376 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '000016.SH'}
2026-01-12 21:47:45,376 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000016.SH'}
2026-01-12 21:47:45,376 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000016.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:45,376 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000016.SH', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:45,572 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:45,573 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:45,573 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:45,581 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:45,588 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:45,588 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '000300.SH'}
2026-01-12 21:47:45,588 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000300.SH'}
2026-01-12 21:47:45,588 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000300.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:45,588 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000300.SH', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:45,740 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:45,742 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:45,744 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:45,753 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:45,762 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:45,762 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '000905.SH'}
2026-01-12 21:47:45,762 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000905.SH'}
2026-01-12 21:47:45,762 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000905.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:45,762 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000905.SH', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:46,046 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:46,049 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:46,050 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:46,058 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:46,067 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:46,067 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '399001.SZ'}
2026-01-12 21:47:46,067 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399001.SZ'}
2026-01-12 21:47:46,067 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399001.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:46,067 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399001.SZ', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:46,234 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:46,235 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:46,237 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:46,246 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:46,255 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:46,256 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '399005.SZ'}
2026-01-12 21:47:46,256 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399005.SZ'}
2026-01-12 21:47:46,256 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399005.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:46,256 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399005.SZ', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:46,457 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:46,459 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:46,460 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:46,470 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:46,479 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:46,479 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '399006.SZ'}
2026-01-12 21:47:46,479 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399006.SZ'}
2026-01-12 21:47:46,479 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399006.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:46,479 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399006.SZ', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:46,747 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:46,748 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:46,749 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:46,758 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:46,768 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:46,768 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '399016.SZ'}
2026-01-12 21:47:46,768 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399016.SZ'}
2026-01-12 21:47:46,768 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399016.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:46,768 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399016.SZ', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:46,971 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:46,973 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:46,974 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:46,983 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:46,993 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:46,993 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '399300.SZ'}
2026-01-12 21:47:46,993 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399300.SZ'}
2026-01-12 21:47:46,993 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399300.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:46,993 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399300.SZ', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:47,262 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:47,264 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:47,266 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:47,275 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:47,284 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:47,284 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '399905.SZ'}
2026-01-12 21:47:47,284 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399905.SZ'}
2026-01-12 21:47:47,284 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399905.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:47,284 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399905.SZ', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:47,434 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:47,435 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:47,436 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:47,445 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:47,453 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:47,453 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '399107.SZ'}
2026-01-12 21:47:47,453 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399107.SZ'}
2026-01-12 21:47:47,453 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399107.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:47,453 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399107.SZ', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:47,667 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:47,668 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:47,670 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:47,679 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:47,688 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:47,689 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '000688.SH'}
2026-01-12 21:47:47,689 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000688.SH'}
2026-01-12 21:47:47,689 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000688.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:47,689 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '000688.SH', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:47,854 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:47,855 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:47,857 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:47,866 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:47,875 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:47,875 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '399102.SZ'}
2026-01-12 21:47:47,875 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399102.SZ'}
2026-01-12 21:47:47,875 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399102.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:47,875 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399102.SZ', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:48,195 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:48,198 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:48,199 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:48,208 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:48,217 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:48,217 - tushare_duckdb - INFO - index_daily: 处理参数组合 {'ts_codes': '399852.SZ'}
2026-01-12 21:47:48,218 - tushare_duckdb - INFO - index_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=index_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399852.SZ'}
2026-01-12 21:47:48,218 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399852.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:48,218 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'ts_code': '399852.SZ', 'limit': 8000, 'offset': 0}
2026-01-12 21:47:48,358 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:47:48,360 - tushare_duckdb - INFO - index_daily: 合并前总行数: 2
2026-01-12 21:47:48,362 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 2
2026-01-12 21:47:48,370 - tushare_duckdb - INFO - index_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_daily' 的元数据: min=19901219, max=20260109, count=85955
2026-01-12 21:47:48,379 - tushare_duckdb - INFO - index_daily: 元数据更新完成
2026-01-12 21:47:48,379 - tushare_duckdb - INFO - index_daily: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:48,380 - tushare_duckdb - INFO - index_daily: 本轮处理结束
2026-01-12 21:47:48,380 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:48,454 - tushare_duckdb - INFO -   → index_dailybasic: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:48,454 - tushare_duckdb - INFO - 正在处理类别: INDEX | 数据库: tushare_duck_index.db
2026-01-12 21:47:48,454 - tushare_duckdb - INFO - 选择表: index_dailybasic
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:48,486 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:48,486 - tushare_duckdb - INFO - → 正在更新表: index_dailybasic
2026-01-12 21:47:48,486 - tushare_duckdb - INFO - index_dailybasic: 生成参数组合，共 12 种
2026-01-12 21:47:48,486 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '000001.SH'}
2026-01-12 21:47:48,486 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:48,486 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '000001.SH'}
2026-01-12 21:47:48,486 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '000001.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:48,486 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '000001.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:48,715 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:48,717 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:48,719 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:48,727 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:48,737 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:48,737 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '000001.SH'}
2026-01-12 21:47:48,738 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '000001.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:48,738 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '000001.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:49,014 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:49,016 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:49,018 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:49,028 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:49,036 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:49,036 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '000005.SH'}
2026-01-12 21:47:49,036 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:49,036 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '000005.SH'}
2026-01-12 21:47:49,036 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '000005.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:49,036 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '000005.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:49,265 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:49,267 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:49,269 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:49,278 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:49,286 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:49,287 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '000005.SH'}
2026-01-12 21:47:49,287 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '000005.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:49,287 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '000005.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:49,487 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:49,489 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:49,490 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:49,499 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:49,507 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:49,508 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '000006.SH'}
2026-01-12 21:47:49,508 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:49,508 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '000006.SH'}
2026-01-12 21:47:49,508 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '000006.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:49,508 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '000006.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:49,764 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:49,765 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:49,766 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:49,775 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:49,784 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:49,784 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '000006.SH'}
2026-01-12 21:47:49,784 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '000006.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:49,784 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '000006.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:49,997 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:49,999 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:50,001 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:50,010 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:50,019 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:50,019 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '000016.SH'}
2026-01-12 21:47:50,019 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:50,020 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '000016.SH'}
2026-01-12 21:47:50,020 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '000016.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:50,020 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '000016.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:50,318 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:50,322 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:50,323 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:50,332 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:50,340 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:50,340 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '000016.SH'}
2026-01-12 21:47:50,340 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '000016.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:50,340 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '000016.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:50,607 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:50,608 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:50,610 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:50,618 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:50,627 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:50,627 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '000300.SH'}
2026-01-12 21:47:50,627 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:50,627 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '000300.SH'}
2026-01-12 21:47:50,627 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '000300.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:50,627 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '000300.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:50,826 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:50,828 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:50,831 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:50,839 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:50,848 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:50,848 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '000300.SH'}
2026-01-12 21:47:50,852 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '000300.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:50,852 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '000300.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:51,076 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:51,077 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:51,078 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:51,084 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:51,090 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:51,090 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '000905.SH'}
2026-01-12 21:47:51,090 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:51,090 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '000905.SH'}
2026-01-12 21:47:51,090 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '000905.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:51,090 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '000905.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:51,287 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:51,289 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:51,291 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:51,299 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:51,308 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:51,309 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '000905.SH'}
2026-01-12 21:47:51,309 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '000905.SH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:51,309 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '000905.SH', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:51,484 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:51,486 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:51,488 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:51,497 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:51,506 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:51,506 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '399001.SZ'}
2026-01-12 21:47:51,506 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:51,506 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '399001.SZ'}
2026-01-12 21:47:51,506 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '399001.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:51,506 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '399001.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:51,812 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:51,814 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:51,815 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:51,824 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:51,832 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:51,833 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '399001.SZ'}
2026-01-12 21:47:51,833 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '399001.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:51,833 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '399001.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:52,348 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:52,350 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:52,351 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:52,359 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:52,367 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:52,367 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '399005.SZ'}
2026-01-12 21:47:52,367 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:52,368 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '399005.SZ'}
2026-01-12 21:47:52,368 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '399005.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:52,368 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '399005.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:52,554 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:52,556 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:52,558 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:52,566 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:52,574 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:52,575 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '399005.SZ'}
2026-01-12 21:47:52,575 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '399005.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:52,575 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '399005.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:52,862 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:52,864 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:52,866 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:52,873 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:52,881 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:52,882 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '399006.SZ'}
2026-01-12 21:47:52,882 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:52,882 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '399006.SZ'}
2026-01-12 21:47:52,882 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '399006.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:52,882 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '399006.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:53,104 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:53,106 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:53,108 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:53,115 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:53,124 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:53,124 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '399006.SZ'}
2026-01-12 21:47:53,124 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '399006.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:53,124 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '399006.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:53,388 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:53,390 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:53,392 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:53,400 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:53,408 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:53,408 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '399016.SZ'}
2026-01-12 21:47:53,409 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:53,409 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '399016.SZ'}
2026-01-12 21:47:53,409 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '399016.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:53,409 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '399016.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:53,607 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:53,609 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:53,611 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:53,620 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:53,628 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:53,629 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '399016.SZ'}
2026-01-12 21:47:53,629 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '399016.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:53,629 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '399016.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:54,113 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:54,116 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:54,117 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:54,125 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:54,134 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:54,135 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '399300.SZ'}
2026-01-12 21:47:54,135 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:54,135 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '399300.SZ'}
2026-01-12 21:47:54,135 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '399300.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:54,135 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '399300.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:54,253 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:54,255 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:54,256 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:54,264 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:54,273 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:54,274 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '399300.SZ'}
2026-01-12 21:47:54,274 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '399300.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:54,274 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '399300.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:54,493 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:54,497 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:54,498 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:54,503 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:54,509 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:54,510 - tushare_duckdb - INFO - index_dailybasic: 处理参数组合 {'ts_codes': '399905.SZ'}
2026-01-12 21:47:54,510 - tushare_duckdb - INFO - index_dailybasic: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:54,510 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260108', 'ts_code': '399905.SZ'}
2026-01-12 21:47:54,510 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260108', 'ts_code': '399905.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:54,510 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260108', 'ts_code': '399905.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:54,667 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:54,668 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:54,670 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:54,679 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:54,688 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:54,688 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=index_dailybasic
DEBUG: build_api_params → {'trade_date': '20260109', 'ts_code': '399905.SZ'}
2026-01-12 21:47:54,688 - tushare_duckdb - INFO - 开始获取 'index_dailybasic': 分页=False, API参数={'trade_date': '20260109', 'ts_code': '399905.SZ'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:54,688 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_dailybasic', 参数: {'trade_date': '20260109', 'ts_code': '399905.SZ', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:54,992 - tushare_duckdb - INFO -   API返回 1 行. 总计: 1 行.
2026-01-12 21:47:54,993 - tushare_duckdb - INFO - index_dailybasic: 合并前总行数: 1
2026-01-12 21:47:54,994 - tushare_duckdb - INFO - index_dailybasic 合并完成。总行数 (去重后): 1
2026-01-12 21:47:55,004 - tushare_duckdb - INFO - index_dailybasic: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_dailybasic' 的元数据: min=20040102, max=20260109, count=56661
2026-01-12 21:47:55,013 - tushare_duckdb - INFO - index_dailybasic: 元数据更新完成
2026-01-12 21:47:55,014 - tushare_duckdb - INFO - index_dailybasic: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:55,014 - tushare_duckdb - INFO - index_dailybasic: 本轮处理结束
2026-01-12 21:47:55,014 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:55,087 - tushare_duckdb - INFO -   → daily_info: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:55,087 - tushare_duckdb - INFO - 正在处理类别: INDEX | 数据库: tushare_duck_index.db
2026-01-12 21:47:55,087 - tushare_duckdb - INFO - 选择表: daily_info
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:55,119 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:55,119 - tushare_duckdb - INFO - → 正在更新表: daily_info
2026-01-12 21:47:55,119 - tushare_duckdb - INFO - daily_info: 处理参数组合 {}
2026-01-12 21:47:55,119 - tushare_duckdb - INFO - daily_info: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:55,119 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=daily_info
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:55,119 - tushare_duckdb - INFO - 开始获取 'daily_info': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['trade_date', 'ts_code']
2026-01-12 21:47:55,119 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'daily_info', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:55,310 - tushare_duckdb - INFO -   API返回 12 行. 总计: 12 行.
2026-01-12 21:47:55,312 - tushare_duckdb - INFO - daily_info: 合并前总行数: 12
2026-01-12 21:47:55,313 - tushare_duckdb - INFO - daily_info 合并完成。总行数 (去重后): 12
2026-01-12 21:47:55,322 - tushare_duckdb - INFO - daily_info: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'daily_info' 的元数据: min=19990104, max=20260109, count=113203
2026-01-12 21:47:55,331 - tushare_duckdb - INFO - daily_info: 元数据更新完成
2026-01-12 21:47:55,331 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=daily_info
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:55,331 - tushare_duckdb - INFO - 开始获取 'daily_info': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['trade_date', 'ts_code']
2026-01-12 21:47:55,331 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'daily_info', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:55,897 - tushare_duckdb - INFO -   API返回 12 行. 总计: 12 行.
2026-01-12 21:47:55,900 - tushare_duckdb - INFO - daily_info: 合并前总行数: 12
2026-01-12 21:47:55,901 - tushare_duckdb - INFO - daily_info 合并完成。总行数 (去重后): 12
2026-01-12 21:47:55,910 - tushare_duckdb - INFO - daily_info: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'daily_info' 的元数据: min=19990104, max=20260109, count=113203
2026-01-12 21:47:55,919 - tushare_duckdb - INFO - daily_info: 元数据更新完成
2026-01-12 21:47:55,919 - tushare_duckdb - INFO - daily_info: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:55,919 - tushare_duckdb - INFO - daily_info: 本轮处理结束
2026-01-12 21:47:55,919 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:55,988 - tushare_duckdb - INFO -   → sz_daily_info: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:55,988 - tushare_duckdb - INFO - 正在处理类别: INDEX | 数据库: tushare_duck_index.db
2026-01-12 21:47:55,988 - tushare_duckdb - INFO - 选择表: sz_daily_info
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:56,019 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:56,019 - tushare_duckdb - INFO - → 正在更新表: sz_daily_info
2026-01-12 21:47:56,019 - tushare_duckdb - INFO - sz_daily_info: 处理参数组合 {}
2026-01-12 21:47:56,020 - tushare_duckdb - INFO - sz_daily_info: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:56,020 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=sz_daily_info
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:56,020 - tushare_duckdb - INFO - 开始获取 'sz_daily_info': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['trade_date', 'ts_code']
2026-01-12 21:47:56,020 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'sz_daily_info', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:56,958 - tushare_duckdb - INFO -   API返回 14 行. 总计: 14 行.
2026-01-12 21:47:56,961 - tushare_duckdb - INFO - sz_daily_info: 合并前总行数: 14
2026-01-12 21:47:56,963 - tushare_duckdb - INFO - sz_daily_info 合并完成。总行数 (去重后): 14
2026-01-12 21:47:56,971 - tushare_duckdb - INFO - sz_daily_info: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'sz_daily_info' 的元数据: min=20200617, max=20260109, count=18889
2026-01-12 21:47:56,980 - tushare_duckdb - INFO - sz_daily_info: 元数据更新完成
2026-01-12 21:47:56,981 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=sz_daily_info
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:56,981 - tushare_duckdb - INFO - 开始获取 'sz_daily_info': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['trade_date', 'ts_code']
2026-01-12 21:47:56,981 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'sz_daily_info', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:47:57,348 - tushare_duckdb - INFO -   API返回 14 行. 总计: 14 行.
2026-01-12 21:47:57,350 - tushare_duckdb - INFO - sz_daily_info: 合并前总行数: 14
2026-01-12 21:47:57,352 - tushare_duckdb - INFO - sz_daily_info 合并完成。总行数 (去重后): 14
2026-01-12 21:47:57,360 - tushare_duckdb - INFO - sz_daily_info: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'sz_daily_info' 的元数据: min=20200617, max=20260109, count=18889
2026-01-12 21:47:57,367 - tushare_duckdb - INFO - sz_daily_info: 元数据更新完成
2026-01-12 21:47:57,368 - tushare_duckdb - INFO - sz_daily_info: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:57,368 - tushare_duckdb - INFO - sz_daily_info: 本轮处理结束
2026-01-12 21:47:57,368 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:57,438 - tushare_duckdb - INFO -   → ths_daily: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:57,438 - tushare_duckdb - INFO - 正在处理类别: INDEX | 数据库: tushare_duck_index.db
2026-01-12 21:47:57,438 - tushare_duckdb - INFO - 选择表: ths_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:57,469 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:57,469 - tushare_duckdb - INFO - → 正在更新表: ths_daily
2026-01-12 21:47:57,469 - tushare_duckdb - INFO - ths_daily: 处理参数组合 {}
2026-01-12 21:47:57,469 - tushare_duckdb - INFO - ths_daily: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:57,469 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=ths_daily
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:57,469 - tushare_duckdb - INFO - 开始获取 'ths_daily': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:57,469 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'ths_daily', 参数: {'trade_date': '20260108', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:57,966 - tushare_duckdb - INFO -   API返回 1502 行. 总计: 1502 行.
2026-01-12 21:47:57,967 - tushare_duckdb - INFO - ths_daily: 合并前总行数: 1502
2026-01-12 21:47:57,968 - tushare_duckdb - INFO - ths_daily 合并完成。总行数 (去重后): 1502
2026-01-12 21:47:57,991 - tushare_duckdb - INFO - ths_daily: 实际插入 271 条新记录（NOT EXISTS 去重后）
已更新表 'ths_daily' 的元数据: min=20191101, max=20260109, count=2100457
2026-01-12 21:47:58,000 - tushare_duckdb - INFO - ths_daily: 元数据更新完成
2026-01-12 21:47:58,000 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=ths_daily
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:58,000 - tushare_duckdb - INFO - 开始获取 'ths_daily': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:58,000 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'ths_daily', 参数: {'trade_date': '20260109', 'limit': 3000, 'offset': 0}
2026-01-12 21:47:58,398 - tushare_duckdb - INFO -   API返回 1231 行. 总计: 1231 行.
2026-01-12 21:47:58,400 - tushare_duckdb - INFO - ths_daily: 合并前总行数: 1231
2026-01-12 21:47:58,401 - tushare_duckdb - INFO - ths_daily 合并完成。总行数 (去重后): 1231
2026-01-12 21:47:58,420 - tushare_duckdb - INFO - ths_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'ths_daily' 的元数据: min=20191101, max=20260109, count=2100458
2026-01-12 21:47:58,428 - tushare_duckdb - INFO - ths_daily: 元数据更新完成
2026-01-12 21:47:58,429 - tushare_duckdb - INFO - ths_daily: 日期处理完成。本轮总共存储 272 条。
2026-01-12 21:47:58,429 - tushare_duckdb - INFO - ths_daily: 本轮处理结束
2026-01-12 21:47:58,429 - tushare_duckdb - INFO -  → 本表完成，存储 272 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:58,500 - tushare_duckdb - INFO -   → dc_daily: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:58,500 - tushare_duckdb - INFO - 正在处理类别: INDEX | 数据库: tushare_duck_index.db
2026-01-12 21:47:58,500 - tushare_duckdb - INFO - 选择表: dc_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:58,532 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:58,532 - tushare_duckdb - INFO - → 正在更新表: dc_daily
2026-01-12 21:47:58,532 - tushare_duckdb - INFO - dc_daily: 处理参数组合 {}
2026-01-12 21:47:58,532 - tushare_duckdb - INFO - dc_daily: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:58,533 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=dc_daily
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:58,533 - tushare_duckdb - INFO - 开始获取 'dc_daily': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:58,533 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'dc_daily', 参数: {'trade_date': '20260108', 'limit': 2000, 'offset': 0}
2026-01-12 21:47:59,023 - tushare_duckdb - INFO -   API返回 558 行. 总计: 558 行.
2026-01-12 21:47:59,025 - tushare_duckdb - INFO - dc_daily: 合并前总行数: 558
2026-01-12 21:47:59,026 - tushare_duckdb - INFO - dc_daily 合并完成。总行数 (去重后): 558
2026-01-12 21:47:59,039 - tushare_duckdb - INFO - dc_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'dc_daily' 的元数据: min=20231009, max=20260109, count=249299
2026-01-12 21:47:59,047 - tushare_duckdb - INFO - dc_daily: 元数据更新完成
2026-01-12 21:47:59,048 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=dc_daily
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:47:59,048 - tushare_duckdb - INFO - 开始获取 'dc_daily': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:59,048 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'dc_daily', 参数: {'trade_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:47:59,459 - tushare_duckdb - INFO -   API返回 558 行. 总计: 558 行.
2026-01-12 21:47:59,461 - tushare_duckdb - INFO - dc_daily: 合并前总行数: 558
2026-01-12 21:47:59,463 - tushare_duckdb - INFO - dc_daily 合并完成。总行数 (去重后): 558
2026-01-12 21:47:59,476 - tushare_duckdb - INFO - dc_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'dc_daily' 的元数据: min=20231009, max=20260109, count=249299
2026-01-12 21:47:59,484 - tushare_duckdb - INFO - dc_daily: 元数据更新完成
2026-01-12 21:47:59,484 - tushare_duckdb - INFO - dc_daily: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:47:59,484 - tushare_duckdb - INFO - dc_daily: 本轮处理结束
2026-01-12 21:47:59,484 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:47:59,552 - tushare_duckdb - INFO -   → ci_daily: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:47:59,552 - tushare_duckdb - INFO - 正在处理类别: INDEX | 数据库: tushare_duck_index.db
2026-01-12 21:47:59,552 - tushare_duckdb - INFO - 选择表: ci_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:47:59,583 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:47:59,583 - tushare_duckdb - INFO - → 正在更新表: ci_daily
2026-01-12 21:47:59,583 - tushare_duckdb - INFO - ci_daily: 处理参数组合 {}
2026-01-12 21:47:59,583 - tushare_duckdb - INFO - ci_daily: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:47:59,583 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=ci_daily
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:47:59,583 - tushare_duckdb - INFO - 开始获取 'ci_daily': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:47:59,583 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'ci_daily', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 0}
2026-01-12 21:48:00,408 - tushare_duckdb - INFO -   API返回 437 行. 总计: 437 行.
2026-01-12 21:48:00,410 - tushare_duckdb - INFO - ci_daily: 合并前总行数: 437
2026-01-12 21:48:00,412 - tushare_duckdb - INFO - ci_daily 合并完成。总行数 (去重后): 437
2026-01-12 21:48:00,426 - tushare_duckdb - INFO - ci_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'ci_daily' 的元数据: min=20191101, max=20260109, count=661844
2026-01-12 21:48:00,434 - tushare_duckdb - INFO - ci_daily: 元数据更新完成
2026-01-12 21:48:00,435 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=ci_daily
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:48:00,435 - tushare_duckdb - INFO - 开始获取 'ci_daily': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:00,435 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'ci_daily', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:48:01,020 - tushare_duckdb - INFO -   API返回 437 行. 总计: 437 行.
2026-01-12 21:48:01,023 - tushare_duckdb - INFO - ci_daily: 合并前总行数: 437
2026-01-12 21:48:01,024 - tushare_duckdb - INFO - ci_daily 合并完成。总行数 (去重后): 437
2026-01-12 21:48:01,036 - tushare_duckdb - INFO - ci_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'ci_daily' 的元数据: min=20191101, max=20260109, count=661844
2026-01-12 21:48:01,044 - tushare_duckdb - INFO - ci_daily: 元数据更新完成
2026-01-12 21:48:01,045 - tushare_duckdb - INFO - ci_daily: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:48:01,045 - tushare_duckdb - INFO - ci_daily: 本轮处理结束
2026-01-12 21:48:01,045 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:48:01,113 - tushare_duckdb - INFO -   → sw_daily: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:48:01,113 - tushare_duckdb - INFO - 正在处理类别: INDEX | 数据库: tushare_duck_index.db
2026-01-12 21:48:01,113 - tushare_duckdb - INFO - 选择表: sw_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:01,144 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:48:01,144 - tushare_duckdb - INFO - → 正在更新表: sw_daily
2026-01-12 21:48:01,144 - tushare_duckdb - INFO - sw_daily: 处理参数组合 {}
2026-01-12 21:48:01,144 - tushare_duckdb - INFO - sw_daily: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:48:01,144 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=sw_daily
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:48:01,144 - tushare_duckdb - INFO - 开始获取 'sw_daily': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:01,144 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'sw_daily', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 0}
2026-01-12 21:48:01,394 - tushare_duckdb - INFO -   API返回 439 行. 总计: 439 行.
2026-01-12 21:48:01,398 - tushare_duckdb - INFO - sw_daily: 合并前总行数: 439
2026-01-12 21:48:01,399 - tushare_duckdb - INFO - sw_daily 合并完成。总行数 (去重后): 439
2026-01-12 21:48:01,414 - tushare_duckdb - INFO - sw_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'sw_daily' 的元数据: min=20210104, max=20260109, count=568007
2026-01-12 21:48:01,423 - tushare_duckdb - INFO - sw_daily: 元数据更新完成
2026-01-12 21:48:01,423 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=sw_daily
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:48:01,423 - tushare_duckdb - INFO - 开始获取 'sw_daily': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:01,424 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'sw_daily', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:48:01,602 - tushare_duckdb - INFO -   API返回 439 行. 总计: 439 行.
2026-01-12 21:48:01,604 - tushare_duckdb - INFO - sw_daily: 合并前总行数: 439
2026-01-12 21:48:01,605 - tushare_duckdb - INFO - sw_daily 合并完成。总行数 (去重后): 439
2026-01-12 21:48:01,618 - tushare_duckdb - INFO - sw_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'sw_daily' 的元数据: min=20210104, max=20260109, count=568007
2026-01-12 21:48:01,627 - tushare_duckdb - INFO - sw_daily: 元数据更新完成
2026-01-12 21:48:01,627 - tushare_duckdb - INFO - sw_daily: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:48:01,627 - tushare_duckdb - INFO - sw_daily: 本轮处理结束
2026-01-12 21:48:01,627 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:48:01,696 - tushare_duckdb - INFO -   → tdx_daily: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:48:01,696 - tushare_duckdb - INFO - 正在处理类别: INDEX | 数据库: tushare_duck_index.db
2026-01-12 21:48:01,696 - tushare_duckdb - INFO - 选择表: tdx_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:01,728 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:48:01,728 - tushare_duckdb - INFO - → 正在更新表: tdx_daily
2026-01-12 21:48:01,728 - tushare_duckdb - INFO - tdx_daily: 处理参数组合 {}
2026-01-12 21:48:01,728 - tushare_duckdb - INFO - tdx_daily: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:48:01,728 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=tdx_daily
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:48:01,728 - tushare_duckdb - INFO - 开始获取 'tdx_daily': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:01,728 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'tdx_daily', 参数: {'trade_date': '20260108', 'limit': 3000, 'offset': 0}
2026-01-12 21:48:02,182 - tushare_duckdb - INFO -   API返回 614 行. 总计: 614 行.
2026-01-12 21:48:02,183 - tushare_duckdb - INFO - tdx_daily: 合并前总行数: 614
2026-01-12 21:48:02,185 - tushare_duckdb - INFO - tdx_daily 合并完成。总行数 (去重后): 614
2026-01-12 21:48:02,205 - tushare_duckdb - INFO - tdx_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'tdx_daily' 的元数据: min=20250328, max=20260109, count=105896
2026-01-12 21:48:02,212 - tushare_duckdb - INFO - tdx_daily: 元数据更新完成
2026-01-12 21:48:02,213 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=tdx_daily
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:48:02,213 - tushare_duckdb - INFO - 开始获取 'tdx_daily': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:02,213 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'tdx_daily', 参数: {'trade_date': '20260109', 'limit': 3000, 'offset': 0}
2026-01-12 21:48:02,597 - tushare_duckdb - INFO -   API返回 614 行. 总计: 614 行.
2026-01-12 21:48:02,599 - tushare_duckdb - INFO - tdx_daily: 合并前总行数: 614
2026-01-12 21:48:02,600 - tushare_duckdb - INFO - tdx_daily 合并完成。总行数 (去重后): 614
2026-01-12 21:48:02,615 - tushare_duckdb - INFO - tdx_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'tdx_daily' 的元数据: min=20250328, max=20260109, count=105896
2026-01-12 21:48:02,623 - tushare_duckdb - INFO - tdx_daily: 元数据更新完成
2026-01-12 21:48:02,623 - tushare_duckdb - INFO - tdx_daily: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:48:02,623 - tushare_duckdb - INFO - tdx_daily: 本轮处理结束
2026-01-12 21:48:02,623 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:48:02,689 - tushare_duckdb - INFO -   → index_global [回溯5天]: 20260104~20260109 (本地最新: 20260109)
2026-01-12 21:48:02,689 - tushare_duckdb - INFO - 正在处理类别: INDEX | 数据库: tushare_duck_index.db
2026-01-12 21:48:02,689 - tushare_duckdb - INFO - 选择表: index_global
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db 
2026-01-12 21:48:02,706 - tushare_duckdb - INFO - 日期范围: 20260104 ~ 20260109，共 6 个日期
2026-01-12 21:48:02,707 - tushare_duckdb - INFO - → 正在更新表: index_global
2026-01-12 21:48:02,707 - tushare_duckdb - INFO - index_global: 处理参数组合 {}
2026-01-12 21:48:02,707 - tushare_duckdb - INFO - index_global: date_param_mode=range，使用范围拉取 20260104~20260109
DEBUG: build_api_params called, table_name=index_global
DEBUG: build_api_params → {'start_date': '20260104', 'end_date': '20260109'}
2026-01-12 21:48:02,707 - tushare_duckdb - INFO - 开始获取 'index_global': 分页=False, API参数={'start_date': '20260104', 'end_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:02,707 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_global', 参数: {'start_date': '20260104', 'end_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:48:02,936 - tushare_duckdb - INFO -   API返回 100 行. 总计: 100 行.
2026-01-12 21:48:02,938 - tushare_duckdb - INFO - index_global: 合并前总行数: 100
2026-01-12 21:48:02,939 - tushare_duckdb - INFO - index_global 合并完成。总行数 (去重后): 100
2026-01-12 21:48:02,949 - tushare_duckdb - INFO - index_global: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'index_global' 的元数据: min=20191220, max=20260109, count=30645
2026-01-12 21:48:02,958 - tushare_duckdb - INFO - index_global: 元数据更新完成
2026-01-12 21:48:02,958 - tushare_duckdb - INFO - index_global: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:48:02,958 - tushare_duckdb - INFO - index_global: 本轮处理结束
2026-01-12 21:48:02,958 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:48:03,007 - tushare_duckdb - INFO -   ✓ index 完成: 10个成功, 0个失败, 存储272条
2026-01-12 21:48:03,007 - tushare_duckdb - INFO -   总进度: 25/51 表
2026-01-12 21:48:03,007 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:48:03,007 - tushare_duckdb - INFO - 类别: FUND (4 个表)
2026-01-12 21:48:03,007 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:48:03,037 - tushare_duckdb - INFO -   → fund_nav [回溯3天]: 20260104~20260109 (本地最新: 20260107)
2026-01-12 21:48:03,037 - tushare_duckdb - INFO - 正在处理类别: FUND | 数据库: tushare_duck_fund.db
2026-01-12 21:48:03,038 - tushare_duckdb - INFO - 选择表: fund_nav
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db 
2026-01-12 21:48:03,052 - tushare_duckdb - INFO - 日期范围: 20260104 ~ 20260109，共 6 个日期
2026-01-12 21:48:03,052 - tushare_duckdb - INFO - → 正在更新表: fund_nav
2026-01-12 21:48:03,052 - tushare_duckdb - INFO - fund_nav: 处理参数组合 {}
2026-01-12 21:48:03,052 - tushare_duckdb - INFO - fund_nav: date_param_mode=single，强制逐日拉取（共 6 天）
2026-01-12 21:48:03,053 - tushare_duckdb - INFO -   → 正在拉取: 20260104
DEBUG: build_api_params called, table_name=fund_nav
DEBUG: build_api_params → {'nav_date': '20260104'}
2026-01-12 21:48:03,053 - tushare_duckdb - INFO - 开始获取 'fund_nav': 分页=True, API参数={'nav_date': '20260104'}, 唯一键=['ts_code', 'nav_date']
2026-01-12 21:48:03,053 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260104', 'limit': 10500, 'offset': 0}
2026-01-12 21:48:03,241 - tushare_duckdb - INFO -   API返回 942 行. 总计: 942 行.
2026-01-12 21:48:03,243 - tushare_duckdb - INFO - fund_nav: 合并前总行数: 942
2026-01-12 21:48:03,244 - tushare_duckdb - INFO - fund_nav 合并完成。总行数 (去重后): 942
2026-01-12 21:48:03,334 - tushare_duckdb - INFO - fund_nav: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'fund_nav' 的元数据: min=19990101, max=20260107, count=33475934
2026-01-12 21:48:03,366 - tushare_duckdb - INFO - fund_nav: 元数据更新完成
2026-01-12 21:48:03,366 - tushare_duckdb - INFO -   → 正在拉取: 20260105
DEBUG: build_api_params called, table_name=fund_nav
DEBUG: build_api_params → {'nav_date': '20260105'}
2026-01-12 21:48:03,366 - tushare_duckdb - INFO - 开始获取 'fund_nav': 分页=True, API参数={'nav_date': '20260105'}, 唯一键=['ts_code', 'nav_date']
2026-01-12 21:48:03,366 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260105', 'limit': 10500, 'offset': 0}
2026-01-12 21:48:04,110 - tushare_duckdb - INFO -   API返回 10500 行. 总计: 10500 行.
2026-01-12 21:48:04,113 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260105', 'limit': 10500, 'offset': 10500}
2026-01-12 21:48:04,742 - tushare_duckdb - INFO -   API返回 10500 行. 总计: 21000 行.
2026-01-12 21:48:04,745 - tushare_duckdb - INFO - 页 3, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260105', 'limit': 10500, 'offset': 21000}
2026-01-12 21:48:05,119 - tushare_duckdb - INFO -   API返回 3351 行. 总计: 24351 行.
2026-01-12 21:48:05,125 - tushare_duckdb - INFO - fund_nav: 合并前总行数: 24351
2026-01-12 21:48:05,133 - tushare_duckdb - INFO - fund_nav 合并完成。总行数 (去重后): 24349
2026-01-12 21:48:05,296 - tushare_duckdb - INFO - fund_nav: 实际插入 1510 条新记录（NOT EXISTS 去重后）
已更新表 'fund_nav' 的元数据: min=19990101, max=20260107, count=33477444
2026-01-12 21:48:05,330 - tushare_duckdb - INFO - fund_nav: 元数据更新完成
2026-01-12 21:48:05,330 - tushare_duckdb - INFO -   → 正在拉取: 20260106
DEBUG: build_api_params called, table_name=fund_nav
DEBUG: build_api_params → {'nav_date': '20260106'}
2026-01-12 21:48:05,330 - tushare_duckdb - INFO - 开始获取 'fund_nav': 分页=True, API参数={'nav_date': '20260106'}, 唯一键=['ts_code', 'nav_date']
2026-01-12 21:48:05,330 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260106', 'limit': 10500, 'offset': 0}
2026-01-12 21:48:06,102 - tushare_duckdb - INFO -   API返回 10500 行. 总计: 10500 行.
2026-01-12 21:48:06,104 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260106', 'limit': 10500, 'offset': 10500}
2026-01-12 21:48:06,631 - tushare_duckdb - INFO -   API返回 10500 行. 总计: 21000 行.
2026-01-12 21:48:06,634 - tushare_duckdb - INFO - 页 3, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260106', 'limit': 10500, 'offset': 21000}
2026-01-12 21:48:06,894 - tushare_duckdb - INFO -   API返回 3354 行. 总计: 24354 行.
2026-01-12 21:48:06,900 - tushare_duckdb - INFO - fund_nav: 合并前总行数: 24354
2026-01-12 21:48:06,908 - tushare_duckdb - INFO - fund_nav 合并完成。总行数 (去重后): 24351
2026-01-12 21:48:07,070 - tushare_duckdb - INFO - fund_nav: 实际插入 814 条新记录（NOT EXISTS 去重后）
已更新表 'fund_nav' 的元数据: min=19990101, max=20260107, count=33478258
2026-01-12 21:48:07,099 - tushare_duckdb - INFO - fund_nav: 元数据更新完成
2026-01-12 21:48:07,099 - tushare_duckdb - INFO -   → 正在拉取: 20260107
DEBUG: build_api_params called, table_name=fund_nav
DEBUG: build_api_params → {'nav_date': '20260107'}
2026-01-12 21:48:07,100 - tushare_duckdb - INFO - 开始获取 'fund_nav': 分页=True, API参数={'nav_date': '20260107'}, 唯一键=['ts_code', 'nav_date']
2026-01-12 21:48:07,100 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260107', 'limit': 10500, 'offset': 0}
2026-01-12 21:48:07,702 - tushare_duckdb - INFO -   API返回 10500 行. 总计: 10500 行.
2026-01-12 21:48:07,705 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260107', 'limit': 10500, 'offset': 10500}
2026-01-12 21:48:08,673 - tushare_duckdb - INFO -   API返回 10500 行. 总计: 21000 行.
2026-01-12 21:48:08,676 - tushare_duckdb - INFO - 页 3, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260107', 'limit': 10500, 'offset': 21000}
2026-01-12 21:48:09,177 - tushare_duckdb - INFO -   API返回 3369 行. 总计: 24369 行.
2026-01-12 21:48:09,183 - tushare_duckdb - INFO - fund_nav: 合并前总行数: 24369
2026-01-12 21:48:09,191 - tushare_duckdb - INFO - fund_nav 合并完成。总行数 (去重后): 24367
2026-01-12 21:48:09,351 - tushare_duckdb - INFO - fund_nav: 实际插入 1512 条新记录（NOT EXISTS 去重后）
已更新表 'fund_nav' 的元数据: min=19990101, max=20260107, count=33479770
2026-01-12 21:48:09,381 - tushare_duckdb - INFO - fund_nav: 元数据更新完成
2026-01-12 21:48:09,381 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=fund_nav
DEBUG: build_api_params → {'nav_date': '20260108'}
2026-01-12 21:48:09,382 - tushare_duckdb - INFO - 开始获取 'fund_nav': 分页=True, API参数={'nav_date': '20260108'}, 唯一键=['ts_code', 'nav_date']
2026-01-12 21:48:09,382 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260108', 'limit': 10500, 'offset': 0}
2026-01-12 21:48:09,952 - tushare_duckdb - INFO -   API返回 10500 行. 总计: 10500 行.
2026-01-12 21:48:09,956 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260108', 'limit': 10500, 'offset': 10500}
2026-01-12 21:48:10,542 - tushare_duckdb - INFO -   API返回 10500 行. 总计: 21000 行.
2026-01-12 21:48:10,545 - tushare_duckdb - INFO - 页 3, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260108', 'limit': 10500, 'offset': 21000}
2026-01-12 21:48:10,900 - tushare_duckdb - INFO -   API返回 2579 行. 总计: 23579 行.
2026-01-12 21:48:10,907 - tushare_duckdb - INFO - fund_nav: 合并前总行数: 23579
2026-01-12 21:48:10,915 - tushare_duckdb - INFO - fund_nav 合并完成。总行数 (去重后): 23577
2026-01-12 21:48:11,091 - tushare_duckdb - INFO - fund_nav: 实际插入 23577 条新记录（NOT EXISTS 去重后）
已更新表 'fund_nav' 的元数据: min=19990101, max=20260108, count=33503347
2026-01-12 21:48:11,120 - tushare_duckdb - INFO - fund_nav: 元数据更新完成
2026-01-12 21:48:11,121 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=fund_nav
DEBUG: build_api_params → {'nav_date': '20260109'}
2026-01-12 21:48:11,121 - tushare_duckdb - INFO - 开始获取 'fund_nav': 分页=True, API参数={'nav_date': '20260109'}, 唯一键=['ts_code', 'nav_date']
2026-01-12 21:48:11,121 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260109', 'limit': 10500, 'offset': 0}
2026-01-12 21:48:11,932 - tushare_duckdb - INFO -   API返回 10500 行. 总计: 10500 行.
2026-01-12 21:48:11,934 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260109', 'limit': 10500, 'offset': 10500}
2026-01-12 21:48:12,594 - tushare_duckdb - INFO -   API返回 10500 行. 总计: 21000 行.
2026-01-12 21:48:12,598 - tushare_duckdb - INFO - 页 3, 尝试 1/3: 调用 API 'fund_nav', 参数: {'nav_date': '20260109', 'limit': 10500, 'offset': 21000}
2026-01-12 21:48:12,905 - tushare_duckdb - INFO -   API返回 2594 行. 总计: 23594 行.
2026-01-12 21:48:12,911 - tushare_duckdb - INFO - fund_nav: 合并前总行数: 23594
2026-01-12 21:48:12,918 - tushare_duckdb - INFO - fund_nav 合并完成。总行数 (去重后): 23591
2026-01-12 21:48:13,092 - tushare_duckdb - INFO - fund_nav: 实际插入 23591 条新记录（NOT EXISTS 去重后）
已更新表 'fund_nav' 的元数据: min=19990101, max=20260109, count=33526938
2026-01-12 21:48:13,122 - tushare_duckdb - INFO - fund_nav: 元数据更新完成
2026-01-12 21:48:13,123 - tushare_duckdb - INFO - fund_nav: 日期处理完成。本轮总共存储 51004 条。
2026-01-12 21:48:13,123 - tushare_duckdb - INFO - fund_nav: 本轮处理结束
2026-01-12 21:48:13,123 - tushare_duckdb - INFO -  → 本表完成，存储 51004 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:48:13,265 - tushare_duckdb - INFO -   → fund_daily: 20260107~20260109 (本地最新: 20260108)
2026-01-12 21:48:13,265 - tushare_duckdb - INFO - 正在处理类别: FUND | 数据库: tushare_duck_fund.db
2026-01-12 21:48:13,265 - tushare_duckdb - INFO - 选择表: fund_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:13,293 - tushare_duckdb - INFO - 日期范围: 20260107 ~ 20260109，共 3 个交易日
2026-01-12 21:48:13,293 - tushare_duckdb - INFO - → 正在更新表: fund_daily
2026-01-12 21:48:13,293 - tushare_duckdb - INFO - fund_daily: 处理参数组合 {}
2026-01-12 21:48:13,293 - tushare_duckdb - INFO - fund_daily: date_param_mode=single，强制逐日拉取（共 3 天）
2026-01-12 21:48:13,293 - tushare_duckdb - INFO -   → 正在拉取: 20260107
DEBUG: build_api_params called, table_name=fund_daily
DEBUG: build_api_params → {'trade_date': '20260107'}
2026-01-12 21:48:13,293 - tushare_duckdb - INFO - 开始获取 'fund_daily': 分页=False, API参数={'trade_date': '20260107'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:13,293 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fund_daily', 参数: {'trade_date': '20260107', 'limit': 2000, 'offset': 0}
2026-01-12 21:48:13,608 - tushare_duckdb - INFO -   API返回 1856 行. 总计: 1856 行.
2026-01-12 21:48:13,611 - tushare_duckdb - INFO - fund_daily: 合并前总行数: 1856
2026-01-12 21:48:13,612 - tushare_duckdb - INFO - fund_daily 合并完成。总行数 (去重后): 1856
2026-01-12 21:48:13,636 - tushare_duckdb - INFO - fund_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'fund_daily' 的元数据: min=19980407, max=20260108, count=2149988
2026-01-12 21:48:13,645 - tushare_duckdb - INFO - fund_daily: 元数据更新完成
2026-01-12 21:48:13,645 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=fund_daily
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:48:13,645 - tushare_duckdb - INFO - 开始获取 'fund_daily': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:13,645 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fund_daily', 参数: {'trade_date': '20260108', 'limit': 2000, 'offset': 0}
2026-01-12 21:48:14,086 - tushare_duckdb - INFO -   API返回 1861 行. 总计: 1861 行.
2026-01-12 21:48:14,088 - tushare_duckdb - INFO - fund_daily: 合并前总行数: 1861
2026-01-12 21:48:14,089 - tushare_duckdb - INFO - fund_daily 合并完成。总行数 (去重后): 1861
2026-01-12 21:48:14,113 - tushare_duckdb - INFO - fund_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'fund_daily' 的元数据: min=19980407, max=20260108, count=2149988
2026-01-12 21:48:14,122 - tushare_duckdb - INFO - fund_daily: 元数据更新完成
2026-01-12 21:48:14,122 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=fund_daily
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:48:14,122 - tushare_duckdb - INFO - 开始获取 'fund_daily': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:14,122 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fund_daily', 参数: {'trade_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:48:14,515 - tushare_duckdb - INFO -   API返回 1858 行. 总计: 1858 行.
2026-01-12 21:48:14,516 - tushare_duckdb - INFO - fund_daily: 合并前总行数: 1858
2026-01-12 21:48:14,517 - tushare_duckdb - INFO - fund_daily 合并完成。总行数 (去重后): 1858
2026-01-12 21:48:14,543 - tushare_duckdb - INFO - fund_daily: 实际插入 1858 条新记录（NOT EXISTS 去重后）
已更新表 'fund_daily' 的元数据: min=19980407, max=20260109, count=2151846
2026-01-12 21:48:14,551 - tushare_duckdb - INFO - fund_daily: 元数据更新完成
2026-01-12 21:48:14,552 - tushare_duckdb - INFO - fund_daily: 日期处理完成。本轮总共存储 1858 条。
2026-01-12 21:48:14,552 - tushare_duckdb - INFO - fund_daily: 本轮处理结束
2026-01-12 21:48:14,552 - tushare_duckdb - INFO -  → 本表完成，存储 1858 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:48:14,620 - tushare_duckdb - INFO -   → fund_adj: 20260107~20260109 (本地最新: 20260108)
2026-01-12 21:48:14,620 - tushare_duckdb - INFO - 正在处理类别: FUND | 数据库: tushare_duck_fund.db
2026-01-12 21:48:14,620 - tushare_duckdb - INFO - 选择表: fund_adj
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:14,650 - tushare_duckdb - INFO - 日期范围: 20260107 ~ 20260109，共 3 个交易日
2026-01-12 21:48:14,650 - tushare_duckdb - INFO - → 正在更新表: fund_adj
2026-01-12 21:48:14,650 - tushare_duckdb - INFO - fund_adj: 处理参数组合 {}
2026-01-12 21:48:14,651 - tushare_duckdb - INFO - fund_adj: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fund_adj
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109'}
2026-01-12 21:48:14,651 - tushare_duckdb - INFO - 开始获取 'fund_adj': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:14,651 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fund_adj', 参数: {'start_date': '20260107', 'end_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:48:14,876 - tushare_duckdb - INFO -   API返回 2000 行. 总计: 2000 行.
2026-01-12 21:48:14,879 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'fund_adj', 参数: {'start_date': '20260107', 'end_date': '20260109', 'limit': 2000, 'offset': 2000}
2026-01-12 21:48:15,078 - tushare_duckdb - INFO -   API返回 2000 行. 总计: 4000 行.
2026-01-12 21:48:15,079 - tushare_duckdb - INFO - 页 3, 尝试 1/3: 调用 API 'fund_adj', 参数: {'start_date': '20260107', 'end_date': '20260109', 'limit': 2000, 'offset': 4000}
2026-01-12 21:48:15,242 - tushare_duckdb - INFO -   API返回 1611 行. 总计: 5611 行.
2026-01-12 21:48:15,246 - tushare_duckdb - INFO - fund_adj: 合并前总行数: 5611
2026-01-12 21:48:15,249 - tushare_duckdb - INFO - fund_adj 合并完成。总行数 (去重后): 5611
2026-01-12 21:48:15,322 - tushare_duckdb - INFO - fund_adj: 实际插入 1872 条新记录（NOT EXISTS 去重后）
已更新表 'fund_adj' 的元数据: min=19980407, max=20260109, count=3068206
2026-01-12 21:48:15,329 - tushare_duckdb - INFO - fund_adj: 元数据更新完成
2026-01-12 21:48:15,330 - tushare_duckdb - INFO - fund_adj: 日期处理完成。本轮总共存储 1872 条。
2026-01-12 21:48:15,330 - tushare_duckdb - INFO - fund_adj: 本轮处理结束
2026-01-12 21:48:15,330 - tushare_duckdb - INFO -  → 本表完成，存储 1872 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:48:15,440 - tushare_duckdb - INFO -   → etf_share_size: 20260107~20260109 (本地最新: 20260108)
2026-01-12 21:48:15,440 - tushare_duckdb - INFO - 正在处理类别: FUND | 数据库: tushare_duck_fund.db
2026-01-12 21:48:15,440 - tushare_duckdb - INFO - 选择表: etf_share_size
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:15,468 - tushare_duckdb - INFO - 日期范围: 20260107 ~ 20260109，共 3 个交易日
2026-01-12 21:48:15,468 - tushare_duckdb - INFO - → 正在更新表: etf_share_size
2026-01-12 21:48:15,468 - tushare_duckdb - INFO - etf_share_size: 处理参数组合 {}
2026-01-12 21:48:15,468 - tushare_duckdb - INFO - etf_share_size: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=etf_share_size
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109'}
2026-01-12 21:48:15,468 - tushare_duckdb - INFO - 开始获取 'etf_share_size': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:15,468 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'etf_share_size', 参数: {'start_date': '20260107', 'end_date': '20260109', 'limit': 5000, 'offset': 0}
2026-01-12 21:48:16,247 - tushare_duckdb - INFO -   API返回 4168 行. 总计: 4168 行.
2026-01-12 21:48:16,250 - tushare_duckdb - INFO - etf_share_size: 合并前总行数: 4168
2026-01-12 21:48:16,251 - tushare_duckdb - INFO - etf_share_size 合并完成。总行数 (去重后): 4168
2026-01-12 21:48:16,301 - tushare_duckdb - INFO - etf_share_size: 实际插入 1391 条新记录（NOT EXISTS 去重后）
已更新表 'etf_share_size' 的元数据: min=20090105, max=20260109, count=1715217
2026-01-12 21:48:16,308 - tushare_duckdb - INFO - etf_share_size: 元数据更新完成
2026-01-12 21:48:16,308 - tushare_duckdb - INFO - etf_share_size: 日期处理完成。本轮总共存储 1391 条。
2026-01-12 21:48:16,308 - tushare_duckdb - INFO - etf_share_size: 本轮处理结束
2026-01-12 21:48:16,308 - tushare_duckdb - INFO -  → 本表完成，存储 1391 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:48:16,371 - tushare_duckdb - INFO -   ✓ fund 完成: 4个成功, 0个失败, 存储56125条
2026-01-12 21:48:16,371 - tushare_duckdb - INFO -   总进度: 29/51 表
2026-01-12 21:48:16,371 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:48:16,371 - tushare_duckdb - INFO - 类别: BOND (6 个表)
2026-01-12 21:48:16,371 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:48:16,386 - tushare_duckdb - INFO -   → cb_share: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:48:16,386 - tushare_duckdb - INFO - 正在处理类别: BOND | 数据库: tushare_duck_bond.db
2026-01-12 21:48:16,386 - tushare_duckdb - INFO - 选择表: cb_share
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:16,416 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:48:16,416 - tushare_duckdb - INFO - → 正在更新表: cb_share
2026-01-12 21:48:16,416 - tushare_duckdb - INFO - cb_share: 处理参数组合 {}
2026-01-12 21:48:16,416 - tushare_duckdb - INFO - cb_share: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=cb_share
DEBUG: build_api_params → {'start_date': '2026-01-08', 'end_date': '2026-01-09'}
2026-01-12 21:48:16,417 - tushare_duckdb - INFO - 开始获取 'cb_share': 分页=True, API参数={'start_date': '2026-01-08', 'end_date': '2026-01-09'}, 唯一键=['ts_code', 'publish_date', 'end_date']
2026-01-12 21:48:16,417 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'cb_share', 参数: {'start_date': '2026-01-08', 'end_date': '2026-01-09', 'limit': 2000, 'offset': 0}
2026-01-12 21:48:16,977 - tushare_duckdb - INFO -   API返回 116 行. 总计: 116 行.
2026-01-12 21:48:16,980 - tushare_duckdb - INFO - cb_share: 合并前总行数: 116
2026-01-12 21:48:16,981 - tushare_duckdb - INFO - cb_share 合并完成。总行数 (去重后): 116
2026-01-12 21:48:17,001 - tushare_duckdb - INFO - cb_share: 实际插入 25 条新记录（NOT EXISTS 去重后）
已更新表 'cb_share' 的元数据: min=20000704, max=20260109, count=106961
2026-01-12 21:48:17,009 - tushare_duckdb - INFO - cb_share: 元数据更新完成
2026-01-12 21:48:17,009 - tushare_duckdb - INFO - cb_share: 日期处理完成。本轮总共存储 25 条。
2026-01-12 21:48:17,009 - tushare_duckdb - INFO - cb_share: 本轮处理结束
2026-01-12 21:48:17,009 - tushare_duckdb - INFO -  → 本表完成，存储 25 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:48:17,064 - tushare_duckdb - INFO -   → cb_daily: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:48:17,065 - tushare_duckdb - INFO - 正在处理类别: BOND | 数据库: tushare_duck_bond.db
2026-01-12 21:48:17,065 - tushare_duckdb - INFO - 选择表: cb_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:17,093 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:48:17,094 - tushare_duckdb - INFO - → 正在更新表: cb_daily
2026-01-12 21:48:17,094 - tushare_duckdb - INFO - cb_daily: 处理参数组合 {}
2026-01-12 21:48:17,094 - tushare_duckdb - INFO - cb_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=cb_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109'}
2026-01-12 21:48:17,094 - tushare_duckdb - INFO - 开始获取 'cb_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:17,094 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'cb_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:48:17,650 - tushare_duckdb - INFO -   API返回 768 行. 总计: 768 行.
2026-01-12 21:48:17,652 - tushare_duckdb - INFO - cb_daily: 合并前总行数: 768
2026-01-12 21:48:17,655 - tushare_duckdb - INFO - cb_daily 合并完成。总行数 (去重后): 768
2026-01-12 21:48:17,671 - tushare_duckdb - INFO - cb_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'cb_daily' 的元数据: min=19930210, max=20260109, count=748707
2026-01-12 21:48:17,678 - tushare_duckdb - INFO - cb_daily: 元数据更新完成
2026-01-12 21:48:17,679 - tushare_duckdb - INFO - cb_daily: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:48:17,679 - tushare_duckdb - INFO - cb_daily: 本轮处理结束
2026-01-12 21:48:17,679 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:48:17,727 - tushare_duckdb - INFO -   → bond_blk: 20260104~20260109 (本地最新: 20260105)
2026-01-12 21:48:17,727 - tushare_duckdb - INFO - 正在处理类别: BOND | 数据库: tushare_duck_bond.db
2026-01-12 21:48:17,727 - tushare_duckdb - INFO - 选择表: bond_blk
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:17,757 - tushare_duckdb - INFO - 日期范围: 20260104 ~ 20260109，共 5 个交易日
2026-01-12 21:48:17,757 - tushare_duckdb - INFO - → 正在更新表: bond_blk
2026-01-12 21:48:17,757 - tushare_duckdb - INFO - bond_blk: 处理参数组合 {}
2026-01-12 21:48:17,757 - tushare_duckdb - INFO - bond_blk: date_param_mode=range，使用范围拉取 20260105~20260109
DEBUG: build_api_params called, table_name=bond_blk
DEBUG: build_api_params → {'start_date': '20260105', 'end_date': '20260109'}
2026-01-12 21:48:17,757 - tushare_duckdb - INFO - 开始获取 'bond_blk': 分页=False, API参数={'start_date': '20260105', 'end_date': '20260109'}, 唯一键=['trade_date', 'ts_code']
2026-01-12 21:48:17,757 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'bond_blk', 参数: {'start_date': '20260105', 'end_date': '20260109', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:17,907 - tushare_duckdb - INFO -   API返回 51 行. 总计: 51 行.
2026-01-12 21:48:17,908 - tushare_duckdb - INFO - bond_blk: 合并前总行数: 51
2026-01-12 21:48:17,909 - tushare_duckdb - INFO - bond_blk 合并完成。总行数 (去重后): 51
2026-01-12 21:48:17,921 - tushare_duckdb - INFO - bond_blk: 实际插入 40 条新记录（NOT EXISTS 去重后）
已更新表 'bond_blk' 的元数据: min=20060321, max=20260109, count=66292
2026-01-12 21:48:17,927 - tushare_duckdb - INFO - bond_blk: 元数据更新完成
2026-01-12 21:48:17,927 - tushare_duckdb - INFO - bond_blk: 日期处理完成。本轮总共存储 40 条。
2026-01-12 21:48:17,927 - tushare_duckdb - INFO - bond_blk: 本轮处理结束
2026-01-12 21:48:17,927 - tushare_duckdb - INFO -  → 本表完成，存储 40 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:48:17,975 - tushare_duckdb - INFO -   → bond_blk_detail: 20260104~20260109 (本地最新: 20260105)
2026-01-12 21:48:17,975 - tushare_duckdb - INFO - 正在处理类别: BOND | 数据库: tushare_duck_bond.db
2026-01-12 21:48:17,975 - tushare_duckdb - INFO - 选择表: bond_blk_detail
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:18,003 - tushare_duckdb - INFO - 日期范围: 20260104 ~ 20260109，共 5 个交易日
2026-01-12 21:48:18,003 - tushare_duckdb - INFO - → 正在更新表: bond_blk_detail
2026-01-12 21:48:18,004 - tushare_duckdb - INFO - bond_blk_detail: 处理参数组合 {}
2026-01-12 21:48:18,004 - tushare_duckdb - INFO - bond_blk_detail: date_param_mode=range，使用范围拉取 20260105~20260109
DEBUG: build_api_params called, table_name=bond_blk_detail
DEBUG: build_api_params → {'start_date': '20260105', 'end_date': '20260109'}
2026-01-12 21:48:18,004 - tushare_duckdb - INFO - 开始获取 'bond_blk_detail': 分页=False, API参数={'start_date': '20260105', 'end_date': '20260109'}, 唯一键=['trade_date', 'ts_code']
2026-01-12 21:48:18,004 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'bond_blk_detail', 参数: {'start_date': '20260105', 'end_date': '20260109', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:18,187 - tushare_duckdb - INFO -   API返回 59 行. 总计: 59 行.
2026-01-12 21:48:18,188 - tushare_duckdb - INFO - bond_blk_detail: 合并前总行数: 59
2026-01-12 21:48:18,189 - tushare_duckdb - INFO - bond_blk_detail 合并完成。总行数 (去重后): 51
2026-01-12 21:48:18,202 - tushare_duckdb - INFO - bond_blk_detail: 实际插入 40 条新记录（NOT EXISTS 去重后）
已更新表 'bond_blk_detail' 的元数据: min=20220316, max=20260109, count=6714
2026-01-12 21:48:18,208 - tushare_duckdb - INFO - bond_blk_detail: 元数据更新完成
2026-01-12 21:48:18,209 - tushare_duckdb - INFO - bond_blk_detail: 日期处理完成。本轮总共存储 40 条。
2026-01-12 21:48:18,209 - tushare_duckdb - INFO - bond_blk_detail: 本轮处理结束
2026-01-12 21:48:18,209 - tushare_duckdb - INFO -  → 本表完成，存储 40 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:48:18,257 - tushare_duckdb - INFO -   → repo_daily: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:48:18,257 - tushare_duckdb - INFO - 正在处理类别: BOND | 数据库: tushare_duck_bond.db
2026-01-12 21:48:18,257 - tushare_duckdb - INFO - 选择表: repo_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:18,285 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:48:18,285 - tushare_duckdb - INFO - → 正在更新表: repo_daily
2026-01-12 21:48:18,285 - tushare_duckdb - INFO - repo_daily: 处理参数组合 {}
2026-01-12 21:48:18,285 - tushare_duckdb - INFO - repo_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=repo_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109'}
2026-01-12 21:48:18,285 - tushare_duckdb - INFO - 开始获取 'repo_daily': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:18,285 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'repo_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:48:18,572 - tushare_duckdb - INFO -   API返回 94 行. 总计: 94 行.
2026-01-12 21:48:18,574 - tushare_duckdb - INFO - repo_daily: 合并前总行数: 94
2026-01-12 21:48:18,576 - tushare_duckdb - INFO - repo_daily 合并完成。总行数 (去重后): 94
2026-01-12 21:48:18,588 - tushare_duckdb - INFO - repo_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'repo_daily' 的元数据: min=19940621, max=20260109, count=207669
2026-01-12 21:48:18,597 - tushare_duckdb - INFO - repo_daily: 元数据更新完成
2026-01-12 21:48:18,597 - tushare_duckdb - INFO - repo_daily: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:48:18,597 - tushare_duckdb - INFO - repo_daily: 本轮处理结束
2026-01-12 21:48:18,597 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:48:18,645 - tushare_duckdb - INFO -   → yc_cb: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:48:18,645 - tushare_duckdb - INFO - 正在处理类别: BOND | 数据库: tushare_duck_bond.db
2026-01-12 21:48:18,645 - tushare_duckdb - INFO - 选择表: yc_cb
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:18,673 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:48:18,673 - tushare_duckdb - INFO - → 正在更新表: yc_cb
2026-01-12 21:48:18,673 - tushare_duckdb - INFO - yc_cb: 处理参数组合 {}
2026-01-12 21:48:18,673 - tushare_duckdb - INFO - yc_cb: date_param_mode=single，强制逐日拉取（共 2 天）
2026-01-12 21:48:18,674 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=yc_cb
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:48:18,674 - tushare_duckdb - INFO - 开始获取 'yc_cb': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['trade_date', 'ts_code', 'curve_type', 'curve_term']
2026-01-12 21:48:18,674 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'yc_cb', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 0}
2026-01-12 21:48:18,858 - tushare_duckdb - INFO -   API返回 1006 行. 总计: 1006 行.
2026-01-12 21:48:18,859 - tushare_duckdb - INFO - yc_cb: 合并前总行数: 1006
2026-01-12 21:48:18,862 - tushare_duckdb - INFO - yc_cb 合并完成。总行数 (去重后): 1006
2026-01-12 21:48:18,882 - tushare_duckdb - INFO - yc_cb: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'yc_cb' 的元数据: min=20160613, max=20260109, count=2364492
2026-01-12 21:48:18,890 - tushare_duckdb - INFO - yc_cb: 元数据更新完成
2026-01-12 21:48:18,891 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=yc_cb
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:48:18,891 - tushare_duckdb - INFO - 开始获取 'yc_cb': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['trade_date', 'ts_code', 'curve_type', 'curve_term']
2026-01-12 21:48:18,891 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'yc_cb', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:48:19,146 - tushare_duckdb - INFO -   API返回 1006 行. 总计: 1006 行.
2026-01-12 21:48:19,150 - tushare_duckdb - INFO - yc_cb: 合并前总行数: 1006
2026-01-12 21:48:19,152 - tushare_duckdb - INFO - yc_cb 合并完成。总行数 (去重后): 1006
2026-01-12 21:48:19,174 - tushare_duckdb - INFO - yc_cb: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'yc_cb' 的元数据: min=20160613, max=20260109, count=2364492
2026-01-12 21:48:19,182 - tushare_duckdb - INFO - yc_cb: 元数据更新完成
2026-01-12 21:48:19,182 - tushare_duckdb - INFO - yc_cb: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:48:19,182 - tushare_duckdb - INFO - yc_cb: 本轮处理结束
2026-01-12 21:48:19,182 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:48:19,211 - tushare_duckdb - INFO -   ✓ bond 完成: 6个成功, 0个失败, 存储105条
2026-01-12 21:48:19,211 - tushare_duckdb - INFO -   总进度: 35/51 表
2026-01-12 21:48:19,211 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:48:19,211 - tushare_duckdb - INFO - 类别: OPTION (1 个表)
2026-01-12 21:48:19,212 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_opt.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_opt.db
2026-01-12 21:48:19,236 - tushare_duckdb - INFO -   → opt_daily: 20260107~20260109 (本地最新: 20260108)
2026-01-12 21:48:19,237 - tushare_duckdb - INFO - 正在处理类别: OPTION | 数据库: tushare_duck_opt.db
2026-01-12 21:48:19,237 - tushare_duckdb - INFO - 选择表: opt_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_opt.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:19,264 - tushare_duckdb - INFO - 日期范围: 20260107 ~ 20260109，共 3 个交易日
2026-01-12 21:48:19,264 - tushare_duckdb - INFO - → 正在更新表: opt_daily
2026-01-12 21:48:19,264 - tushare_duckdb - INFO - opt_daily: 处理参数组合 {}
2026-01-12 21:48:19,264 - tushare_duckdb - INFO - opt_daily: date_param_mode=single，强制逐日拉取（共 3 天）
2026-01-12 21:48:19,264 - tushare_duckdb - INFO -   → 正在拉取: 20260107
DEBUG: build_api_params called, table_name=opt_daily
DEBUG: build_api_params → {'trade_date': '20260107'}
2026-01-12 21:48:19,264 - tushare_duckdb - INFO - 开始获取 'opt_daily': 分页=True, API参数={'trade_date': '20260107'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:19,264 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'opt_daily', 参数: {'trade_date': '20260107', 'limit': 15000, 'offset': 0}
2026-01-12 21:48:21,210 - tushare_duckdb - INFO -   API返回 15000 行. 总计: 15000 行.
2026-01-12 21:48:21,212 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'opt_daily', 参数: {'trade_date': '20260107', 'limit': 15000, 'offset': 15000}
2026-01-12 21:48:22,246 - tushare_duckdb - INFO -   API返回 7020 行. 总计: 22020 行.
2026-01-12 21:48:22,249 - tushare_duckdb - INFO - opt_daily: 合并前总行数: 22020
2026-01-12 21:48:22,253 - tushare_duckdb - INFO - opt_daily 合并完成。总行数 (去重后): 22020
2026-01-12 21:48:22,394 - tushare_duckdb - INFO - opt_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'opt_daily' 的元数据: min=20150209, max=20260108, count=19296230
2026-01-12 21:48:22,415 - tushare_duckdb - INFO - opt_daily: 元数据更新完成
2026-01-12 21:48:22,415 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=opt_daily
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:48:22,415 - tushare_duckdb - INFO - 开始获取 'opt_daily': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:22,415 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'opt_daily', 参数: {'trade_date': '20260108', 'limit': 15000, 'offset': 0}
2026-01-12 21:48:23,890 - tushare_duckdb - INFO -   API返回 15000 行. 总计: 15000 行.
2026-01-12 21:48:23,892 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'opt_daily', 参数: {'trade_date': '20260108', 'limit': 15000, 'offset': 15000}
2026-01-12 21:48:24,717 - tushare_duckdb - INFO -   API返回 7690 行. 总计: 22690 行.
2026-01-12 21:48:24,720 - tushare_duckdb - INFO - opt_daily: 合并前总行数: 22690
2026-01-12 21:48:24,725 - tushare_duckdb - INFO - opt_daily 合并完成。总行数 (去重后): 22690
2026-01-12 21:48:24,853 - tushare_duckdb - INFO - opt_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'opt_daily' 的元数据: min=20150209, max=20260108, count=19296230
2026-01-12 21:48:24,873 - tushare_duckdb - INFO - opt_daily: 元数据更新完成
2026-01-12 21:48:24,874 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=opt_daily
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:48:24,874 - tushare_duckdb - INFO - 开始获取 'opt_daily': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:24,874 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'opt_daily', 参数: {'trade_date': '20260109', 'limit': 15000, 'offset': 0}
2026-01-12 21:48:26,082 - tushare_duckdb - INFO -   API返回 15000 行. 总计: 15000 行.
2026-01-12 21:48:26,084 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'opt_daily', 参数: {'trade_date': '20260109', 'limit': 15000, 'offset': 15000}
2026-01-12 21:48:26,813 - tushare_duckdb - INFO -   API返回 7858 行. 总计: 22858 行.
2026-01-12 21:48:26,816 - tushare_duckdb - INFO - opt_daily: 合并前总行数: 22858
2026-01-12 21:48:26,821 - tushare_duckdb - INFO - opt_daily 合并完成。总行数 (去重后): 22858
2026-01-12 21:48:26,966 - tushare_duckdb - INFO - opt_daily: 实际插入 22858 条新记录（NOT EXISTS 去重后）
已更新表 'opt_daily' 的元数据: min=20150209, max=20260109, count=19319088
2026-01-12 21:48:26,987 - tushare_duckdb - INFO - opt_daily: 元数据更新完成
2026-01-12 21:48:26,987 - tushare_duckdb - INFO - opt_daily: 日期处理完成。本轮总共存储 22858 条。
2026-01-12 21:48:26,988 - tushare_duckdb - INFO - opt_daily: 本轮处理结束
2026-01-12 21:48:26,988 - tushare_duckdb - INFO -  → 本表完成，存储 22858 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_opt.db
2026-01-12 21:48:27,037 - tushare_duckdb - INFO -   ✓ option 完成: 1个成功, 0个失败, 存储22858条
2026-01-12 21:48:27,037 - tushare_duckdb - INFO -   总进度: 36/51 表
2026-01-12 21:48:27,037 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:48:27,037 - tushare_duckdb - INFO - 类别: FUTURE (5 个表)
2026-01-12 21:48:27,037 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:48:27,055 - tushare_duckdb - INFO -   → fut_daily: 20260107~20260109 (本地最新: 20260108)
2026-01-12 21:48:27,055 - tushare_duckdb - INFO - 正在处理类别: FUTURE | 数据库: tushare_duck_future.db
2026-01-12 21:48:27,055 - tushare_duckdb - INFO - 选择表: fut_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:27,086 - tushare_duckdb - INFO - 日期范围: 20260107 ~ 20260109，共 3 个交易日
2026-01-12 21:48:27,086 - tushare_duckdb - INFO - → 正在更新表: fut_daily
2026-01-12 21:48:27,086 - tushare_duckdb - INFO - fut_daily: 处理参数组合 {}
2026-01-12 21:48:27,086 - tushare_duckdb - INFO - fut_daily: date_param_mode=single，强制逐日拉取（共 3 天）
2026-01-12 21:48:27,086 - tushare_duckdb - INFO -   → 正在拉取: 20260107
DEBUG: build_api_params called, table_name=fut_daily
DEBUG: build_api_params → {'trade_date': '20260107'}
2026-01-12 21:48:27,086 - tushare_duckdb - INFO - 开始获取 'fut_daily': 分页=False, API参数={'trade_date': '20260107'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:27,086 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_daily', 参数: {'trade_date': '20260107', 'limit': 2000, 'offset': 0}
2026-01-12 21:48:27,347 - tushare_duckdb - INFO -   API返回 1069 行. 总计: 1069 行.
2026-01-12 21:48:27,349 - tushare_duckdb - INFO - fut_daily: 合并前总行数: 1069
2026-01-12 21:48:27,351 - tushare_duckdb - INFO - fut_daily 合并完成。总行数 (去重后): 1069
2026-01-12 21:48:27,372 - tushare_duckdb - INFO - fut_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'fut_daily' 的元数据: min=20000104, max=20260108, count=2776238
2026-01-12 21:48:27,383 - tushare_duckdb - INFO - fut_daily: 元数据更新完成
2026-01-12 21:48:27,383 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=fut_daily
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:48:27,383 - tushare_duckdb - INFO - 开始获取 'fut_daily': 分页=False, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:27,383 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_daily', 参数: {'trade_date': '20260108', 'limit': 2000, 'offset': 0}
2026-01-12 21:48:27,690 - tushare_duckdb - INFO -   API返回 1069 行. 总计: 1069 行.
2026-01-12 21:48:27,692 - tushare_duckdb - INFO - fut_daily: 合并前总行数: 1069
2026-01-12 21:48:27,694 - tushare_duckdb - INFO - fut_daily 合并完成。总行数 (去重后): 1069
2026-01-12 21:48:27,715 - tushare_duckdb - INFO - fut_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'fut_daily' 的元数据: min=20000104, max=20260108, count=2776238
2026-01-12 21:48:27,724 - tushare_duckdb - INFO - fut_daily: 元数据更新完成
2026-01-12 21:48:27,725 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=fut_daily
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:48:27,725 - tushare_duckdb - INFO - 开始获取 'fut_daily': 分页=False, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:27,725 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_daily', 参数: {'trade_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:48:27,997 - tushare_duckdb - INFO -   API返回 1069 行. 总计: 1069 行.
2026-01-12 21:48:27,998 - tushare_duckdb - INFO - fut_daily: 合并前总行数: 1069
2026-01-12 21:48:28,000 - tushare_duckdb - INFO - fut_daily 合并完成。总行数 (去重后): 1069
2026-01-12 21:48:28,056 - tushare_duckdb - INFO - fut_daily: 实际插入 1069 条新记录（NOT EXISTS 去重后）
已更新表 'fut_daily' 的元数据: min=20000104, max=20260109, count=2777307
2026-01-12 21:48:28,064 - tushare_duckdb - INFO - fut_daily: 元数据更新完成
2026-01-12 21:48:28,064 - tushare_duckdb - INFO - fut_daily: 日期处理完成。本轮总共存储 1069 条。
2026-01-12 21:48:28,064 - tushare_duckdb - INFO - fut_daily: 本轮处理结束
2026-01-12 21:48:28,064 - tushare_duckdb - INFO -  → 本表完成，存储 1069 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:48:28,179 - tushare_duckdb - INFO -   → fut_wsr: 20260107~20260109 (本地最新: 20260108)
2026-01-12 21:48:28,179 - tushare_duckdb - INFO - 正在处理类别: FUTURE | 数据库: tushare_duck_future.db
2026-01-12 21:48:28,179 - tushare_duckdb - INFO - 选择表: fut_wsr
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:28,209 - tushare_duckdb - INFO - 日期范围: 20260107 ~ 20260109，共 3 个交易日
2026-01-12 21:48:28,209 - tushare_duckdb - INFO - → 正在更新表: fut_wsr
2026-01-12 21:48:28,209 - tushare_duckdb - INFO - fut_wsr: 处理参数组合 {}
2026-01-12 21:48:28,209 - tushare_duckdb - INFO - fut_wsr: date_param_mode=single，强制逐日拉取（共 3 天）
2026-01-12 21:48:28,209 - tushare_duckdb - INFO -   → 正在拉取: 20260107
DEBUG: build_api_params called, table_name=fut_wsr
DEBUG: build_api_params → {'trade_date': '20260107'}
2026-01-12 21:48:28,209 - tushare_duckdb - INFO - 开始获取 'fut_wsr': 分页=True, API参数={'trade_date': '20260107'}, 唯一键=['trade_date', 'symbol', 'fut_name', 'warehouse']
2026-01-12 21:48:28,209 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_wsr', 参数: {'trade_date': '20260107', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:28,356 - tushare_duckdb - INFO -   API返回 490 行. 总计: 490 行.
2026-01-12 21:48:28,357 - tushare_duckdb - INFO - fut_wsr: 合并前总行数: 490
2026-01-12 21:48:28,358 - tushare_duckdb - INFO - fut_wsr 合并完成。总行数 (去重后): 490
2026-01-12 21:48:28,376 - tushare_duckdb - INFO - fut_wsr: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'fut_wsr' 的元数据: min=20180102, max=20260108, count=1450881
2026-01-12 21:48:28,383 - tushare_duckdb - INFO - fut_wsr: 元数据更新完成
2026-01-12 21:48:28,383 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=fut_wsr
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:48:28,383 - tushare_duckdb - INFO - 开始获取 'fut_wsr': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['trade_date', 'symbol', 'fut_name', 'warehouse']
2026-01-12 21:48:28,383 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_wsr', 参数: {'trade_date': '20260108', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:28,591 - tushare_duckdb - INFO -   API返回 490 行. 总计: 490 行.
2026-01-12 21:48:28,594 - tushare_duckdb - INFO - fut_wsr: 合并前总行数: 490
2026-01-12 21:48:28,596 - tushare_duckdb - INFO - fut_wsr 合并完成。总行数 (去重后): 490
2026-01-12 21:48:28,617 - tushare_duckdb - INFO - fut_wsr: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'fut_wsr' 的元数据: min=20180102, max=20260108, count=1450881
2026-01-12 21:48:28,624 - tushare_duckdb - INFO - fut_wsr: 元数据更新完成
2026-01-12 21:48:28,624 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=fut_wsr
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:48:28,624 - tushare_duckdb - INFO - 开始获取 'fut_wsr': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['trade_date', 'symbol', 'fut_name', 'warehouse']
2026-01-12 21:48:28,624 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_wsr', 参数: {'trade_date': '20260109', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:28,773 - tushare_duckdb - INFO -   API返回 490 行. 总计: 490 行.
2026-01-12 21:48:28,777 - tushare_duckdb - INFO - fut_wsr: 合并前总行数: 490
2026-01-12 21:48:28,779 - tushare_duckdb - INFO - fut_wsr 合并完成。总行数 (去重后): 490
2026-01-12 21:48:28,808 - tushare_duckdb - INFO - fut_wsr: 实际插入 490 条新记录（NOT EXISTS 去重后）
已更新表 'fut_wsr' 的元数据: min=20180102, max=20260109, count=1451371
2026-01-12 21:48:28,814 - tushare_duckdb - INFO - fut_wsr: 元数据更新完成
2026-01-12 21:48:28,815 - tushare_duckdb - INFO - fut_wsr: 日期处理完成。本轮总共存储 490 条。
2026-01-12 21:48:28,815 - tushare_duckdb - INFO - fut_wsr: 本轮处理结束
2026-01-12 21:48:28,815 - tushare_duckdb - INFO -  → 本表完成，存储 490 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:48:28,871 - tushare_duckdb - INFO -   → fut_settle: 20251225~20260109 (本地最新: 20251226)
2026-01-12 21:48:28,872 - tushare_duckdb - INFO - 正在处理类别: FUTURE | 数据库: tushare_duck_future.db
2026-01-12 21:48:28,872 - tushare_duckdb - INFO - 选择表: fut_settle
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:28,901 - tushare_duckdb - INFO - 日期范围: 20251225 ~ 20260109，共 10 个交易日
2026-01-12 21:48:28,901 - tushare_duckdb - INFO - → 正在更新表: fut_settle
2026-01-12 21:48:28,901 - tushare_duckdb - INFO - fut_settle: 处理参数组合 {}
2026-01-12 21:48:28,901 - tushare_duckdb - INFO - fut_settle: date_param_mode=single，强制逐日拉取（共 10 天）
2026-01-12 21:48:28,901 - tushare_duckdb - INFO -   → 正在拉取: 20251225
DEBUG: build_api_params called, table_name=fut_settle
DEBUG: build_api_params → {'trade_date': '20251225'}
2026-01-12 21:48:28,902 - tushare_duckdb - INFO - 开始获取 'fut_settle': 分页=True, API参数={'trade_date': '20251225'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:28,902 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_settle', 参数: {'trade_date': '20251225', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:29,124 - tushare_duckdb - INFO -   API返回 300 行. 总计: 300 行.
2026-01-12 21:48:29,126 - tushare_duckdb - INFO - fut_settle: 合并前总行数: 300
2026-01-12 21:48:29,127 - tushare_duckdb - INFO - fut_settle 合并完成。总行数 (去重后): 300
2026-01-12 21:48:29,141 - tushare_duckdb - INFO - fut_settle: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'fut_settle' 的元数据: min=20200102, max=20251226, count=348602
2026-01-12 21:48:29,148 - tushare_duckdb - INFO - fut_settle: 元数据更新完成
2026-01-12 21:48:29,149 - tushare_duckdb - INFO -   → 正在拉取: 20251226
DEBUG: build_api_params called, table_name=fut_settle
DEBUG: build_api_params → {'trade_date': '20251226'}
2026-01-12 21:48:29,149 - tushare_duckdb - INFO - 开始获取 'fut_settle': 分页=True, API参数={'trade_date': '20251226'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:29,149 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_settle', 参数: {'trade_date': '20251226', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:29,281 - tushare_duckdb - INFO -   API返回 300 行. 总计: 300 行.
2026-01-12 21:48:29,283 - tushare_duckdb - INFO - fut_settle: 合并前总行数: 300
2026-01-12 21:48:29,285 - tushare_duckdb - INFO - fut_settle 合并完成。总行数 (去重后): 300
2026-01-12 21:48:29,298 - tushare_duckdb - INFO - fut_settle: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'fut_settle' 的元数据: min=20200102, max=20251226, count=348602
2026-01-12 21:48:29,305 - tushare_duckdb - INFO - fut_settle: 元数据更新完成
2026-01-12 21:48:29,306 - tushare_duckdb - INFO -   → 正在拉取: 20251229
DEBUG: build_api_params called, table_name=fut_settle
DEBUG: build_api_params → {'trade_date': '20251229'}
2026-01-12 21:48:29,306 - tushare_duckdb - INFO - 开始获取 'fut_settle': 分页=True, API参数={'trade_date': '20251229'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:29,306 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_settle', 参数: {'trade_date': '20251229', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:29,569 - tushare_duckdb - INFO -   API返回 0 行. 总计: 0 行.
2026-01-12 21:48:29,569 - tushare_duckdb - INFO - fut_settle: 分页结束
2026-01-12 21:48:29,570 - tushare_duckdb - INFO -   → 正在拉取: 20251230
DEBUG: build_api_params called, table_name=fut_settle
DEBUG: build_api_params → {'trade_date': '20251230'}
2026-01-12 21:48:29,570 - tushare_duckdb - INFO - 开始获取 'fut_settle': 分页=True, API参数={'trade_date': '20251230'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:29,570 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_settle', 参数: {'trade_date': '20251230', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:29,699 - tushare_duckdb - INFO -   API返回 0 行. 总计: 0 行.
2026-01-12 21:48:29,699 - tushare_duckdb - INFO - fut_settle: 分页结束
2026-01-12 21:48:29,700 - tushare_duckdb - INFO -   → 正在拉取: 20251231
DEBUG: build_api_params called, table_name=fut_settle
DEBUG: build_api_params → {'trade_date': '20251231'}
2026-01-12 21:48:29,700 - tushare_duckdb - INFO - 开始获取 'fut_settle': 分页=True, API参数={'trade_date': '20251231'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:29,700 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_settle', 参数: {'trade_date': '20251231', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:29,833 - tushare_duckdb - INFO -   API返回 0 行. 总计: 0 行.
2026-01-12 21:48:29,833 - tushare_duckdb - INFO - fut_settle: 分页结束
2026-01-12 21:48:29,834 - tushare_duckdb - INFO -   → 正在拉取: 20260105
DEBUG: build_api_params called, table_name=fut_settle
DEBUG: build_api_params → {'trade_date': '20260105'}
2026-01-12 21:48:29,834 - tushare_duckdb - INFO - 开始获取 'fut_settle': 分页=True, API参数={'trade_date': '20260105'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:29,834 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_settle', 参数: {'trade_date': '20260105', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:29,977 - tushare_duckdb - INFO -   API返回 0 行. 总计: 0 行.
2026-01-12 21:48:29,977 - tushare_duckdb - INFO - fut_settle: 分页结束
2026-01-12 21:48:29,977 - tushare_duckdb - INFO -   → 正在拉取: 20260106
DEBUG: build_api_params called, table_name=fut_settle
DEBUG: build_api_params → {'trade_date': '20260106'}
2026-01-12 21:48:29,977 - tushare_duckdb - INFO - 开始获取 'fut_settle': 分页=True, API参数={'trade_date': '20260106'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:29,977 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_settle', 参数: {'trade_date': '20260106', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:30,200 - tushare_duckdb - INFO -   API返回 0 行. 总计: 0 行.
2026-01-12 21:48:30,200 - tushare_duckdb - INFO - fut_settle: 分页结束
2026-01-12 21:48:30,201 - tushare_duckdb - INFO -   → 正在拉取: 20260107
DEBUG: build_api_params called, table_name=fut_settle
DEBUG: build_api_params → {'trade_date': '20260107'}
2026-01-12 21:48:30,201 - tushare_duckdb - INFO - 开始获取 'fut_settle': 分页=True, API参数={'trade_date': '20260107'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:30,201 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_settle', 参数: {'trade_date': '20260107', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:30,367 - tushare_duckdb - INFO -   API返回 0 行. 总计: 0 行.
2026-01-12 21:48:30,367 - tushare_duckdb - INFO - fut_settle: 分页结束
2026-01-12 21:48:30,368 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=fut_settle
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:48:30,368 - tushare_duckdb - INFO - 开始获取 'fut_settle': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:30,369 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_settle', 参数: {'trade_date': '20260108', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:30,514 - tushare_duckdb - INFO -   API返回 0 行. 总计: 0 行.
2026-01-12 21:48:30,514 - tushare_duckdb - INFO - fut_settle: 分页结束
2026-01-12 21:48:30,515 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=fut_settle
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:48:30,515 - tushare_duckdb - INFO - 开始获取 'fut_settle': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:30,515 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_settle', 参数: {'trade_date': '20260109', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:30,746 - tushare_duckdb - INFO -   API返回 0 行. 总计: 0 行.
2026-01-12 21:48:30,746 - tushare_duckdb - INFO - fut_settle: 分页结束
2026-01-12 21:48:30,747 - tushare_duckdb - INFO - fut_settle: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:48:30,747 - tushare_duckdb - INFO - fut_settle: 本轮处理结束
2026-01-12 21:48:30,747 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:48:30,804 - tushare_duckdb - INFO -   → fut_holding: 20260107~20260109 (本地最新: 20260108)
2026-01-12 21:48:30,804 - tushare_duckdb - INFO - 正在处理类别: FUTURE | 数据库: tushare_duck_future.db
2026-01-12 21:48:30,804 - tushare_duckdb - INFO - 选择表: fut_holding
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:30,835 - tushare_duckdb - INFO - 日期范围: 20260107 ~ 20260109，共 3 个交易日
2026-01-12 21:48:30,835 - tushare_duckdb - INFO - → 正在更新表: fut_holding
2026-01-12 21:48:30,835 - tushare_duckdb - INFO - fut_holding: 处理参数组合 {}
2026-01-12 21:48:30,835 - tushare_duckdb - INFO - fut_holding: date_param_mode=single，强制逐日拉取（共 3 天）
2026-01-12 21:48:30,835 - tushare_duckdb - INFO -   → 正在拉取: 20260107
DEBUG: build_api_params called, table_name=fut_holding
DEBUG: build_api_params → {'trade_date': '20260107'}
2026-01-12 21:48:30,835 - tushare_duckdb - INFO - 开始获取 'fut_holding': 分页=True, API参数={'trade_date': '20260107'}, 唯一键=['trade_date', 'symbol', 'broker']
2026-01-12 21:48:30,835 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_holding', 参数: {'trade_date': '20260107', 'limit': 4000, 'offset': 0}
2026-01-12 21:48:31,146 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 4000 行.
2026-01-12 21:48:31,148 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'fut_holding', 参数: {'trade_date': '20260107', 'limit': 4000, 'offset': 4000}
2026-01-12 21:48:31,513 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 8000 行.
2026-01-12 21:48:31,516 - tushare_duckdb - INFO - 页 3, 尝试 1/3: 调用 API 'fut_holding', 参数: {'trade_date': '20260107', 'limit': 4000, 'offset': 8000}
2026-01-12 21:48:31,965 - tushare_duckdb - INFO -   API返回 1668 行. 总计: 9668 行.
2026-01-12 21:48:31,968 - tushare_duckdb - INFO - fut_holding: 合并前总行数: 9668
2026-01-12 21:48:31,973 - tushare_duckdb - INFO - fut_holding 合并完成。总行数 (去重后): 9668
2026-01-12 21:48:32,037 - tushare_duckdb - INFO - fut_holding: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'fut_holding' 的元数据: min=20200102, max=20260108, count=11967444
2026-01-12 21:48:32,052 - tushare_duckdb - INFO - fut_holding: 元数据更新完成
2026-01-12 21:48:32,052 - tushare_duckdb - INFO -   → 正在拉取: 20260108
DEBUG: build_api_params called, table_name=fut_holding
DEBUG: build_api_params → {'trade_date': '20260108'}
2026-01-12 21:48:32,052 - tushare_duckdb - INFO - 开始获取 'fut_holding': 分页=True, API参数={'trade_date': '20260108'}, 唯一键=['trade_date', 'symbol', 'broker']
2026-01-12 21:48:32,052 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_holding', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 0}
2026-01-12 21:48:32,423 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 4000 行.
2026-01-12 21:48:32,425 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'fut_holding', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 4000}
2026-01-12 21:48:32,733 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 8000 行.
2026-01-12 21:48:32,734 - tushare_duckdb - INFO - 页 3, 尝试 1/3: 调用 API 'fut_holding', 参数: {'trade_date': '20260108', 'limit': 4000, 'offset': 8000}
2026-01-12 21:48:32,952 - tushare_duckdb - INFO -   API返回 1920 行. 总计: 9920 行.
2026-01-12 21:48:32,954 - tushare_duckdb - INFO - fut_holding: 合并前总行数: 9920
2026-01-12 21:48:32,959 - tushare_duckdb - INFO - fut_holding 合并完成。总行数 (去重后): 9920
2026-01-12 21:48:33,023 - tushare_duckdb - INFO - fut_holding: 实际插入 470 条新记录（NOT EXISTS 去重后）
已更新表 'fut_holding' 的元数据: min=20200102, max=20260108, count=11967914
2026-01-12 21:48:33,038 - tushare_duckdb - INFO - fut_holding: 元数据更新完成
2026-01-12 21:48:33,038 - tushare_duckdb - INFO -   → 正在拉取: 20260109
DEBUG: build_api_params called, table_name=fut_holding
DEBUG: build_api_params → {'trade_date': '20260109'}
2026-01-12 21:48:33,038 - tushare_duckdb - INFO - 开始获取 'fut_holding': 分页=True, API参数={'trade_date': '20260109'}, 唯一键=['trade_date', 'symbol', 'broker']
2026-01-12 21:48:33,039 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fut_holding', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:48:33,315 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 4000 行.
2026-01-12 21:48:33,317 - tushare_duckdb - INFO - 页 2, 尝试 1/3: 调用 API 'fut_holding', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 4000}
2026-01-12 21:48:33,605 - tushare_duckdb - INFO -   API返回 4000 行. 总计: 8000 行.
2026-01-12 21:48:33,607 - tushare_duckdb - INFO - 页 3, 尝试 1/3: 调用 API 'fut_holding', 参数: {'trade_date': '20260109', 'limit': 4000, 'offset': 8000}
2026-01-12 21:48:33,890 - tushare_duckdb - INFO -   API返回 1403 行. 总计: 9403 行.
2026-01-12 21:48:33,894 - tushare_duckdb - INFO - fut_holding: 合并前总行数: 9403
2026-01-12 21:48:33,899 - tushare_duckdb - INFO - fut_holding 合并完成。总行数 (去重后): 9403
2026-01-12 21:48:33,977 - tushare_duckdb - INFO - fut_holding: 实际插入 9403 条新记录（NOT EXISTS 去重后）
已更新表 'fut_holding' 的元数据: min=20200102, max=20260109, count=11977317
2026-01-12 21:48:33,991 - tushare_duckdb - INFO - fut_holding: 元数据更新完成
2026-01-12 21:48:33,991 - tushare_duckdb - INFO - fut_holding: 日期处理完成。本轮总共存储 9873 条。
2026-01-12 21:48:33,992 - tushare_duckdb - INFO - fut_holding: 本轮处理结束
2026-01-12 21:48:33,992 - tushare_duckdb - INFO -  → 本表完成，存储 9873 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:48:34,052 - tushare_duckdb - INFO -   → fut_index_daily: 20260107~20260109 (本地最新: 20260108)
2026-01-12 21:48:34,052 - tushare_duckdb - INFO - 正在处理类别: FUTURE | 数据库: tushare_duck_future.db
2026-01-12 21:48:34,052 - tushare_duckdb - INFO - 选择表: fut_index_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:34,081 - tushare_duckdb - INFO - 日期范围: 20260107 ~ 20260109，共 3 个交易日
2026-01-12 21:48:34,081 - tushare_duckdb - INFO - → 正在更新表: fut_index_daily
2026-01-12 21:48:34,081 - tushare_duckdb - INFO - fut_index_daily: 生成参数组合，共 95 种
2026-01-12 21:48:34,081 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHAI.NH'}
2026-01-12 21:48:34,081 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHAI.NH'}
2026-01-12 21:48:34,081 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHAI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:34,081 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHAI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:34,326 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:34,329 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:34,330 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:34,346 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227077
2026-01-12 21:48:34,353 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:34,353 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHCI.NH'}
2026-01-12 21:48:34,354 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHCI.NH'}
2026-01-12 21:48:34,354 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHCI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:34,354 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHCI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:34,534 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:34,535 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:34,536 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:34,547 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227078
2026-01-12 21:48:34,555 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:34,555 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHECI.NH'}
2026-01-12 21:48:34,555 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHECI.NH'}
2026-01-12 21:48:34,555 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHECI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:34,555 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHECI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:34,808 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:34,809 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:34,811 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:34,821 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227079
2026-01-12 21:48:34,829 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:34,829 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHFI.NH'}
2026-01-12 21:48:34,829 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHFI.NH'}
2026-01-12 21:48:34,829 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHFI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:34,829 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHFI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:34,979 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:34,981 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:34,983 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:34,992 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227080
2026-01-12 21:48:35,000 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:35,001 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHII.NH'}
2026-01-12 21:48:35,001 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHII.NH'}
2026-01-12 21:48:35,001 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHII.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:35,001 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHII.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:35,208 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:35,210 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:35,211 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:35,220 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227081
2026-01-12 21:48:35,228 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:35,228 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHMI.NH'}
2026-01-12 21:48:35,228 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHMI.NH'}
2026-01-12 21:48:35,228 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHMI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:35,228 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHMI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:35,500 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:35,501 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:35,503 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:35,511 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227082
2026-01-12 21:48:35,519 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:35,519 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHNFI.NH'}
2026-01-12 21:48:35,519 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHNFI.NH'}
2026-01-12 21:48:35,519 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHNFI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:35,519 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHNFI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:35,665 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:35,667 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:35,668 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:35,678 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227083
2026-01-12 21:48:35,687 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:35,687 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHPMI.NH'}
2026-01-12 21:48:35,687 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHPMI.NH'}
2026-01-12 21:48:35,687 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHPMI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:35,687 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHPMI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:35,959 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:35,960 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:35,962 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:35,972 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227084
2026-01-12 21:48:35,981 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:35,981 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'A.NH'}
2026-01-12 21:48:35,981 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'A.NH'}
2026-01-12 21:48:35,981 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'A.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:35,981 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'A.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:36,179 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:36,181 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:36,183 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:36,193 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227085
2026-01-12 21:48:36,201 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:36,201 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'AG.NH'}
2026-01-12 21:48:36,201 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AG.NH'}
2026-01-12 21:48:36,201 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AG.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:36,201 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AG.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:36,421 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:36,423 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:36,424 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:36,435 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227086
2026-01-12 21:48:36,442 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:36,443 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'AL.NH'}
2026-01-12 21:48:36,443 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AL.NH'}
2026-01-12 21:48:36,443 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AL.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:36,443 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AL.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:36,585 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:36,587 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:36,589 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:36,599 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227087
2026-01-12 21:48:36,607 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:36,608 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'AP.NH'}
2026-01-12 21:48:36,608 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AP.NH'}
2026-01-12 21:48:36,608 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AP.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:36,608 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AP.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:36,730 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:36,732 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:36,733 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:36,745 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227088
2026-01-12 21:48:36,752 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:36,753 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'AU.NH'}
2026-01-12 21:48:36,753 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AU.NH'}
2026-01-12 21:48:36,753 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AU.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:36,753 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AU.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:36,979 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:36,981 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:36,982 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:36,992 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227089
2026-01-12 21:48:37,001 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:37,001 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'BB.NH'}
2026-01-12 21:48:37,001 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BB.NH'}
2026-01-12 21:48:37,001 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BB.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:37,001 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BB.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:37,135 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:37,137 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:37,138 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:37,150 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227090
2026-01-12 21:48:37,158 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:37,159 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'BU.NH'}
2026-01-12 21:48:37,159 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BU.NH'}
2026-01-12 21:48:37,159 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BU.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:37,159 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BU.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:37,320 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:37,322 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:37,323 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:37,334 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227091
2026-01-12 21:48:37,342 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:37,342 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'C.NH'}
2026-01-12 21:48:37,342 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'C.NH'}
2026-01-12 21:48:37,342 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'C.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:37,342 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'C.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:37,559 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:37,560 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:37,562 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:37,574 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227092
2026-01-12 21:48:37,581 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:37,581 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'CF.NH'}
2026-01-12 21:48:37,582 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CF.NH'}
2026-01-12 21:48:37,582 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CF.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:37,582 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CF.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:37,797 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:37,799 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:37,801 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:37,809 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227093
2026-01-12 21:48:37,818 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:37,819 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'CS.NH'}
2026-01-12 21:48:37,819 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CS.NH'}
2026-01-12 21:48:37,819 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CS.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:37,819 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CS.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:38,029 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:38,032 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:38,033 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:38,043 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227094
2026-01-12 21:48:38,050 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:38,051 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'CU.NH'}
2026-01-12 21:48:38,051 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CU.NH'}
2026-01-12 21:48:38,051 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CU.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:38,051 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CU.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:38,280 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:38,282 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:38,284 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:38,294 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227095
2026-01-12 21:48:38,303 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:38,303 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'CY.NH'}
2026-01-12 21:48:38,303 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CY.NH'}
2026-01-12 21:48:38,303 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CY.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:38,303 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CY.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:38,637 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:38,639 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:38,641 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:38,650 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227096
2026-01-12 21:48:38,660 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:38,661 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'ER.NH'}
2026-01-12 21:48:38,661 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'ER.NH'}
2026-01-12 21:48:38,661 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'ER.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:38,661 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'ER.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:38,797 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:38,799 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:38,800 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:38,812 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227097
2026-01-12 21:48:38,820 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:38,820 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'FB.NH'}
2026-01-12 21:48:38,821 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'FB.NH'}
2026-01-12 21:48:38,821 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'FB.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:38,821 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'FB.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:39,093 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:39,095 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:39,096 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:39,106 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227098
2026-01-12 21:48:39,114 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:39,114 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'FG.NH'}
2026-01-12 21:48:39,114 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'FG.NH'}
2026-01-12 21:48:39,114 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'FG.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:39,114 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'FG.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:39,371 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:39,372 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:39,374 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:39,385 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227099
2026-01-12 21:48:39,393 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:39,394 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'FU.NH'}
2026-01-12 21:48:39,394 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'FU.NH'}
2026-01-12 21:48:39,394 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'FU.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:39,394 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'FU.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:39,609 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:39,610 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:39,612 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:39,622 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227100
2026-01-12 21:48:39,630 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:39,630 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'HC.NH'}
2026-01-12 21:48:39,630 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'HC.NH'}
2026-01-12 21:48:39,630 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'HC.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:39,630 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'HC.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:39,847 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:39,849 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:39,851 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:39,863 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227101
2026-01-12 21:48:39,870 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:39,871 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'I.NH'}
2026-01-12 21:48:39,871 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'I.NH'}
2026-01-12 21:48:39,871 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'I.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:39,871 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'I.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:40,145 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:40,147 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:40,150 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:40,160 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227102
2026-01-12 21:48:40,167 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:40,167 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'J.NH'}
2026-01-12 21:48:40,168 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'J.NH'}
2026-01-12 21:48:40,168 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'J.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:40,168 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'J.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:40,304 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:40,306 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:40,307 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:40,318 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227103
2026-01-12 21:48:40,326 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:40,326 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'JD.NH'}
2026-01-12 21:48:40,326 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'JD.NH'}
2026-01-12 21:48:40,326 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'JD.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:40,326 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'JD.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:40,438 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:40,440 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:40,442 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:40,452 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227104
2026-01-12 21:48:40,461 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:40,461 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'JM.NH'}
2026-01-12 21:48:40,461 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'JM.NH'}
2026-01-12 21:48:40,461 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'JM.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:40,461 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'JM.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:40,746 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:40,748 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:40,750 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:40,758 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227105
2026-01-12 21:48:40,763 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:40,763 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'JR.NH'}
2026-01-12 21:48:40,763 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'JR.NH'}
2026-01-12 21:48:40,763 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'JR.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:40,763 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'JR.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:40,937 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:40,939 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:40,940 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:40,950 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227106
2026-01-12 21:48:40,958 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:40,959 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'L.NH'}
2026-01-12 21:48:40,959 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'L.NH'}
2026-01-12 21:48:40,959 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'L.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:40,959 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'L.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:41,184 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:41,186 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:41,189 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:41,198 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227107
2026-01-12 21:48:41,206 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:41,206 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'LR.NH'}
2026-01-12 21:48:41,206 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LR.NH'}
2026-01-12 21:48:41,206 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LR.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:41,206 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LR.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:41,348 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:41,350 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:41,351 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:41,360 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227108
2026-01-12 21:48:41,367 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:41,368 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'M.NH'}
2026-01-12 21:48:41,368 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'M.NH'}
2026-01-12 21:48:41,368 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'M.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:41,368 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'M.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:41,511 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:41,513 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:41,515 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:41,521 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227109
2026-01-12 21:48:41,528 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:41,528 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'ME.NH'}
2026-01-12 21:48:41,528 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'ME.NH'}
2026-01-12 21:48:41,528 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'ME.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:41,528 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'ME.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:42,140 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:42,141 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:42,142 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:42,149 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227110
2026-01-12 21:48:42,156 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:42,156 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NI.NH'}
2026-01-12 21:48:42,157 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NI.NH'}
2026-01-12 21:48:42,157 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:42,157 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:42,307 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:42,309 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:42,310 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:42,321 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227111
2026-01-12 21:48:42,329 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:42,330 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'P.NH'}
2026-01-12 21:48:42,330 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'P.NH'}
2026-01-12 21:48:42,330 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'P.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:42,330 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'P.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:42,470 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:42,472 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:42,473 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:42,483 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227112
2026-01-12 21:48:42,490 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:42,490 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'PB.NH'}
2026-01-12 21:48:42,491 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PB.NH'}
2026-01-12 21:48:42,491 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PB.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:42,491 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PB.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:42,845 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:42,847 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:42,848 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:42,859 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227113
2026-01-12 21:48:42,866 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:42,867 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'PP.NH'}
2026-01-12 21:48:42,867 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PP.NH'}
2026-01-12 21:48:42,867 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PP.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:42,867 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PP.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:43,218 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:43,219 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:43,220 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:43,230 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227114
2026-01-12 21:48:43,238 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:43,238 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'RB.NH'}
2026-01-12 21:48:43,238 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RB.NH'}
2026-01-12 21:48:43,239 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RB.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:43,239 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RB.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:43,558 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:43,560 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:43,561 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:43,573 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227115
2026-01-12 21:48:43,581 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:43,581 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'RM.NH'}
2026-01-12 21:48:43,581 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RM.NH'}
2026-01-12 21:48:43,582 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RM.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:43,582 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RM.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:43,806 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:43,808 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:43,809 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:43,820 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227116
2026-01-12 21:48:43,827 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:43,828 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'RO.NH'}
2026-01-12 21:48:43,828 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RO.NH'}
2026-01-12 21:48:43,828 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RO.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:43,828 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RO.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:44,369 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:44,370 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:44,371 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:44,377 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227117
2026-01-12 21:48:44,383 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:44,383 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'RS.NH'}
2026-01-12 21:48:44,383 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RS.NH'}
2026-01-12 21:48:44,383 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RS.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:44,383 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RS.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:44,559 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:44,560 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:44,562 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:44,573 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227118
2026-01-12 21:48:44,581 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:44,581 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'RU.NH'}
2026-01-12 21:48:44,581 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RU.NH'}
2026-01-12 21:48:44,581 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RU.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:44,581 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RU.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:44,858 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:44,859 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:44,861 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:44,872 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227119
2026-01-12 21:48:44,880 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:44,880 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'SC.NH'}
2026-01-12 21:48:44,880 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SC.NH'}
2026-01-12 21:48:44,880 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SC.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:44,880 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SC.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:45,146 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:45,148 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:45,151 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:45,161 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227120
2026-01-12 21:48:45,169 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:45,169 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'SF.NH'}
2026-01-12 21:48:45,169 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SF.NH'}
2026-01-12 21:48:45,169 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SF.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:45,169 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SF.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:45,603 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:45,604 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:45,605 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:45,616 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227121
2026-01-12 21:48:45,625 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:45,625 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'SM.NH'}
2026-01-12 21:48:45,625 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SM.NH'}
2026-01-12 21:48:45,625 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SM.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:45,625 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SM.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:46,006 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:46,008 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:46,009 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:46,019 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227122
2026-01-12 21:48:46,027 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:46,027 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'SN.NH'}
2026-01-12 21:48:46,027 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SN.NH'}
2026-01-12 21:48:46,027 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SN.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:46,027 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SN.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:46,407 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:46,409 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:46,411 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:46,421 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227123
2026-01-12 21:48:46,429 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:46,429 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'SP.NH'}
2026-01-12 21:48:46,429 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SP.NH'}
2026-01-12 21:48:46,429 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SP.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:46,429 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SP.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:46,584 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:46,586 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:46,588 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:46,598 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227124
2026-01-12 21:48:46,606 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:46,606 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'SR.NH'}
2026-01-12 21:48:46,606 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SR.NH'}
2026-01-12 21:48:46,606 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SR.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:46,607 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SR.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:46,751 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:46,752 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:46,754 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:46,765 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227125
2026-01-12 21:48:46,773 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:46,773 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'TA.NH'}
2026-01-12 21:48:46,773 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TA.NH'}
2026-01-12 21:48:46,773 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TA.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:46,773 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TA.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:47,005 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:47,007 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:47,009 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:47,019 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227126
2026-01-12 21:48:47,028 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:47,028 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'TC.NH'}
2026-01-12 21:48:47,028 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TC.NH'}
2026-01-12 21:48:47,028 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TC.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:47,028 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TC.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:47,375 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:47,376 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:47,377 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:47,385 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227127
2026-01-12 21:48:47,391 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:47,391 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'V.NH'}
2026-01-12 21:48:47,391 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'V.NH'}
2026-01-12 21:48:47,391 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'V.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:47,391 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'V.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:47,811 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:47,813 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:47,814 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:47,824 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227128
2026-01-12 21:48:47,832 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:47,832 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'WR.NH'}
2026-01-12 21:48:47,833 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'WR.NH'}
2026-01-12 21:48:47,833 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'WR.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:47,833 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'WR.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:48,139 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:48,140 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:48,142 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:48,153 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227129
2026-01-12 21:48:48,161 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:48,161 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'WS.NH'}
2026-01-12 21:48:48,161 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'WS.NH'}
2026-01-12 21:48:48,161 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'WS.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:48,161 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'WS.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:48,312 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:48,314 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:48,316 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:48,326 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227130
2026-01-12 21:48:48,334 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:48,334 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'Y.NH'}
2026-01-12 21:48:48,334 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'Y.NH'}
2026-01-12 21:48:48,334 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'Y.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:48,334 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'Y.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:48,613 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:48,615 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:48,617 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:48,626 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227131
2026-01-12 21:48:48,634 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:48,635 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'ZN.NH'}
2026-01-12 21:48:48,635 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'ZN.NH'}
2026-01-12 21:48:48,635 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'ZN.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:48,635 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'ZN.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:48,957 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:48,959 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:48,960 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:48,970 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227132
2026-01-12 21:48:48,978 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:48,979 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'AO.NH'}
2026-01-12 21:48:48,979 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AO.NH'}
2026-01-12 21:48:48,979 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AO.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:48,979 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'AO.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:49,139 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:49,141 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:49,142 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:49,151 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227133
2026-01-12 21:48:49,160 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:49,161 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'B.NH'}
2026-01-12 21:48:49,161 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'B.NH'}
2026-01-12 21:48:49,161 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'B.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:49,161 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'B.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:49,549 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:49,551 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:49,552 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:49,563 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227134
2026-01-12 21:48:49,571 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:49,572 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'BC.NH'}
2026-01-12 21:48:49,572 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BC.NH'}
2026-01-12 21:48:49,572 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BC.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:49,572 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BC.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:49,793 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:49,795 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:49,796 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:49,807 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227135
2026-01-12 21:48:49,816 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:49,816 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'BR.NH'}
2026-01-12 21:48:49,816 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BR.NH'}
2026-01-12 21:48:49,816 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BR.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:49,816 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'BR.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:50,054 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:50,056 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:50,057 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:50,067 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227136
2026-01-12 21:48:50,076 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:50,076 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'CJ.NH'}
2026-01-12 21:48:50,076 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CJ.NH'}
2026-01-12 21:48:50,076 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CJ.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:50,076 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'CJ.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:50,263 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:50,265 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:50,266 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:50,278 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227137
2026-01-12 21:48:50,286 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:50,287 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'EB.NH'}
2026-01-12 21:48:50,287 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'EB.NH'}
2026-01-12 21:48:50,287 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'EB.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:50,287 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'EB.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:50,537 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:50,539 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:50,540 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:50,550 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227138
2026-01-12 21:48:50,558 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:50,558 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'EC.NH'}
2026-01-12 21:48:50,558 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'EC.NH'}
2026-01-12 21:48:50,558 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'EC.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:50,558 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'EC.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:50,881 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:50,882 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:50,884 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:50,894 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227139
2026-01-12 21:48:50,902 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:50,903 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'EG.NH'}
2026-01-12 21:48:50,903 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'EG.NH'}
2026-01-12 21:48:50,903 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'EG.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:50,903 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'EG.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:51,120 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:51,122 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:51,124 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:51,134 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227140
2026-01-12 21:48:51,141 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:51,141 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'IC.NH'}
2026-01-12 21:48:51,141 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IC.NH'}
2026-01-12 21:48:51,141 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IC.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:51,142 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IC.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:51,298 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:51,302 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:51,304 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:51,313 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227141
2026-01-12 21:48:51,321 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:51,321 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'IF.NH'}
2026-01-12 21:48:51,321 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IF.NH'}
2026-01-12 21:48:51,321 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IF.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:51,321 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IF.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:51,456 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:51,458 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:51,460 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:51,468 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227142
2026-01-12 21:48:51,476 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:51,477 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'IH.NH'}
2026-01-12 21:48:51,477 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IH.NH'}
2026-01-12 21:48:51,477 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IH.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:51,477 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IH.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:51,776 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:51,778 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:51,779 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:51,790 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227143
2026-01-12 21:48:51,797 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:51,798 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'IM.NH'}
2026-01-12 21:48:51,798 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IM.NH'}
2026-01-12 21:48:51,798 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IM.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:51,798 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'IM.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:52,120 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:52,122 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:52,124 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:52,134 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227144
2026-01-12 21:48:52,141 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:52,141 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'LC.NH'}
2026-01-12 21:48:52,142 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LC.NH'}
2026-01-12 21:48:52,142 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LC.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:52,142 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LC.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:52,465 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:52,467 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:52,469 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:52,479 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227145
2026-01-12 21:48:52,487 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:52,487 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'LH.NH'}
2026-01-12 21:48:52,487 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LH.NH'}
2026-01-12 21:48:52,487 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LH.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:52,488 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LH.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:52,736 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:52,738 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:52,739 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:52,749 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227146
2026-01-12 21:48:52,757 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:52,757 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'LU.NH'}
2026-01-12 21:48:52,758 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LU.NH'}
2026-01-12 21:48:52,758 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LU.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:52,758 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'LU.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:53,016 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:53,018 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:53,020 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:53,031 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227147
2026-01-12 21:48:53,038 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:53,039 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHAECI.NH'}
2026-01-12 21:48:53,039 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHAECI.NH'}
2026-01-12 21:48:53,039 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHAECI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:53,039 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHAECI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:53,275 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:53,277 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:53,278 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:53,289 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227148
2026-01-12 21:48:53,297 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:53,297 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHBMI.NH'}
2026-01-12 21:48:53,297 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHBMI.NH'}
2026-01-12 21:48:53,298 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHBMI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:53,298 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHBMI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:53,458 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:53,460 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:53,462 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:53,471 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227149
2026-01-12 21:48:53,480 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:53,480 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHCCI.NH'}
2026-01-12 21:48:53,480 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHCCI.NH'}
2026-01-12 21:48:53,480 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHCCI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:53,480 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHCCI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:53,686 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:53,688 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:53,689 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:53,699 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227150
2026-01-12 21:48:53,708 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:53,708 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHCIMi.NH'}
2026-01-12 21:48:53,708 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHCIMi.NH'}
2026-01-12 21:48:53,708 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHCIMi.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:53,708 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHCIMi.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:53,864 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:53,866 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:53,867 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:53,877 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227151
2026-01-12 21:48:53,885 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:53,885 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHEI.NH'}
2026-01-12 21:48:53,886 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHEI.NH'}
2026-01-12 21:48:53,886 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHEI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:53,886 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHEI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:54,217 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:54,218 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:54,219 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:54,229 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227152
2026-01-12 21:48:54,237 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:54,237 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHFMI.NH'}
2026-01-12 21:48:54,237 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHFMI.NH'}
2026-01-12 21:48:54,237 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHFMI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:54,237 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHFMI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:54,568 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:54,570 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:54,571 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:54,582 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227153
2026-01-12 21:48:54,590 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:54,590 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHOOI.NH'}
2026-01-12 21:48:54,591 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHOOI.NH'}
2026-01-12 21:48:54,591 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHOOI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:54,591 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHOOI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:55,082 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:55,084 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:55,086 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:55,098 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227154
2026-01-12 21:48:55,106 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:55,106 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NHPCI.NH'}
2026-01-12 21:48:55,106 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHPCI.NH'}
2026-01-12 21:48:55,107 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHPCI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:55,107 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NHPCI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:55,361 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:55,363 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:55,364 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:55,375 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227155
2026-01-12 21:48:55,383 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:55,383 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'NR.NH'}
2026-01-12 21:48:55,383 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NR.NH'}
2026-01-12 21:48:55,384 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NR.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:55,384 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'NR.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:55,768 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:55,770 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:55,771 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:55,782 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227156
2026-01-12 21:48:55,791 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:55,791 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'PF.NH'}
2026-01-12 21:48:55,791 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PF.NH'}
2026-01-12 21:48:55,792 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PF.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:55,792 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PF.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:55,962 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:55,963 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:55,965 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:55,975 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227157
2026-01-12 21:48:55,983 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:55,983 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'PG.NH'}
2026-01-12 21:48:55,984 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PG.NH'}
2026-01-12 21:48:55,984 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PG.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:55,984 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PG.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:56,153 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:56,154 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:56,156 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:56,165 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227158
2026-01-12 21:48:56,175 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:56,175 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'PK.NH'}
2026-01-12 21:48:56,175 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PK.NH'}
2026-01-12 21:48:56,175 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PK.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:56,175 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PK.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:56,383 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:56,385 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:56,386 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:56,397 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227159
2026-01-12 21:48:56,406 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:56,406 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'PR.NH'}
2026-01-12 21:48:56,406 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PR.NH'}
2026-01-12 21:48:56,406 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PR.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:56,406 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PR.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:56,560 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:56,562 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:56,564 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:56,573 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227160
2026-01-12 21:48:56,581 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:56,581 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'PX.NH'}
2026-01-12 21:48:56,582 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PX.NH'}
2026-01-12 21:48:56,582 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PX.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:56,582 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'PX.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:56,706 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:56,708 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:56,710 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:56,719 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227161
2026-01-12 21:48:56,727 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:56,727 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'RR.NH'}
2026-01-12 21:48:56,727 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RR.NH'}
2026-01-12 21:48:56,728 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RR.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:56,728 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'RR.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:57,017 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:57,024 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:57,026 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:57,035 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227162
2026-01-12 21:48:57,043 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:57,043 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'SA.NH'}
2026-01-12 21:48:57,043 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SA.NH'}
2026-01-12 21:48:57,043 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SA.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:57,043 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SA.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:57,223 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:57,225 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:57,226 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:57,237 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227163
2026-01-12 21:48:57,244 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:57,244 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'SH.NH'}
2026-01-12 21:48:57,245 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SH.NH'}
2026-01-12 21:48:57,245 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SH.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:57,245 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SH.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:57,562 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:57,564 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:57,566 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:57,576 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227164
2026-01-12 21:48:57,584 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:57,585 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'SI.NH'}
2026-01-12 21:48:57,585 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SI.NH'}
2026-01-12 21:48:57,585 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SI.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:57,585 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SI.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:57,870 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:57,872 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:57,873 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:57,880 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227165
2026-01-12 21:48:57,886 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:57,886 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'SS.NH'}
2026-01-12 21:48:57,886 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SS.NH'}
2026-01-12 21:48:57,886 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SS.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:57,886 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'SS.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:58,123 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:58,125 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:58,126 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:58,137 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227166
2026-01-12 21:48:58,145 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:58,145 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'T.NH'}
2026-01-12 21:48:58,145 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'T.NH'}
2026-01-12 21:48:58,145 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'T.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:58,145 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'T.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:58,278 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:58,280 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:58,282 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:58,292 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227167
2026-01-12 21:48:58,300 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:58,300 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'TF.NH'}
2026-01-12 21:48:58,300 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TF.NH'}
2026-01-12 21:48:58,300 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TF.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:58,300 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TF.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:58,537 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:58,539 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:58,541 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:58,552 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227168
2026-01-12 21:48:58,560 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:58,560 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'TL.NH'}
2026-01-12 21:48:58,560 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TL.NH'}
2026-01-12 21:48:58,560 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TL.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:58,561 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TL.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:58,735 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:58,737 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:58,738 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:58,749 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227169
2026-01-12 21:48:58,757 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:58,757 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'TS.NH'}
2026-01-12 21:48:58,757 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TS.NH'}
2026-01-12 21:48:58,758 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TS.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:58,758 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'TS.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:59,239 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:59,241 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:59,243 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:59,253 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227170
2026-01-12 21:48:59,262 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:59,262 - tushare_duckdb - INFO - fut_index_daily: 处理参数组合 {'ts_codes': 'UR.NH'}
2026-01-12 21:48:59,262 - tushare_duckdb - INFO - fut_index_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fut_index_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'UR.NH'}
2026-01-12 21:48:59,262 - tushare_duckdb - INFO - 开始获取 'index_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'UR.NH'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:59,262 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'index_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'ts_code': 'UR.NH', 'limit': 6000, 'offset': 0}
2026-01-12 21:48:59,521 - tushare_duckdb - INFO -   API返回 3 行. 总计: 3 行.
2026-01-12 21:48:59,522 - tushare_duckdb - INFO - index_daily: 合并前总行数: 3
2026-01-12 21:48:59,523 - tushare_duckdb - INFO - index_daily 合并完成。总行数 (去重后): 3
2026-01-12 21:48:59,533 - tushare_duckdb - INFO - fut_index_daily: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'fut_index_daily' 的元数据: min=20040601, max=20260109, count=227171
2026-01-12 21:48:59,540 - tushare_duckdb - INFO - fut_index_daily: 元数据更新完成
2026-01-12 21:48:59,540 - tushare_duckdb - INFO - fut_index_daily: 日期处理完成。本轮总共存储 95 条。
2026-01-12 21:48:59,541 - tushare_duckdb - INFO - fut_index_daily: 本轮处理结束
2026-01-12 21:48:59,541 - tushare_duckdb - INFO -  → 本表完成，存储 95 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:48:59,585 - tushare_duckdb - INFO -   ✓ future 完成: 5个成功, 0个失败, 存储11527条
2026-01-12 21:48:59,585 - tushare_duckdb - INFO -   总进度: 41/51 表
2026-01-12 21:48:59,585 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:48:59,585 - tushare_duckdb - INFO - 类别: REFERENCE (1 个表)
2026-01-12 21:48:59,585 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_ref.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_ref.db
2026-01-12 21:48:59,597 - tushare_duckdb - INFO -   → block_trade: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:48:59,598 - tushare_duckdb - INFO - 正在处理类别: REFERENCE | 数据库: tushare_duck_ref.db
2026-01-12 21:48:59,598 - tushare_duckdb - INFO - 选择表: block_trade
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_ref.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:48:59,623 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个交易日
2026-01-12 21:48:59,623 - tushare_duckdb - INFO - → 正在更新表: block_trade
2026-01-12 21:48:59,623 - tushare_duckdb - INFO - block_trade: 处理参数组合 {}
2026-01-12 21:48:59,623 - tushare_duckdb - INFO - block_trade: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=block_trade
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109'}
2026-01-12 21:48:59,623 - tushare_duckdb - INFO - 开始获取 'block_trade': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:48:59,623 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'block_trade', 参数: {'start_date': '20260108', 'end_date': '20260109', 'limit': 1000, 'offset': 0}
2026-01-12 21:48:59,970 - tushare_duckdb - INFO -   API返回 404 行. 总计: 404 行.
2026-01-12 21:48:59,972 - tushare_duckdb - INFO - block_trade: 合并前总行数: 404
2026-01-12 21:48:59,973 - tushare_duckdb - INFO - block_trade 合并完成。总行数 (去重后): 163
2026-01-12 21:48:59,983 - tushare_duckdb - INFO - block_trade: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'block_trade' 的元数据: min=20020319, max=20260109, count=180095
2026-01-12 21:48:59,991 - tushare_duckdb - INFO - block_trade: 元数据更新完成
2026-01-12 21:48:59,992 - tushare_duckdb - INFO - block_trade: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:48:59,992 - tushare_duckdb - INFO - block_trade: 本轮处理结束
2026-01-12 21:48:59,992 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_ref.db
2026-01-12 21:48:59,998 - tushare_duckdb - INFO -   ✓ reference 完成: 1个成功, 0个失败, 存储0条
2026-01-12 21:48:59,998 - tushare_duckdb - INFO -   总进度: 42/51 表
2026-01-12 21:48:59,998 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:48:59,998 - tushare_duckdb - INFO - 类别: MACRO (7 个表)
2026-01-12 21:48:59,998 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:00,012 - tushare_duckdb - INFO -   → shibor: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:49:00,012 - tushare_duckdb - INFO - 正在处理类别: MACRO | 数据库: tushare_duck_macro.db
2026-01-12 21:49:00,012 - tushare_duckdb - INFO - 选择表: shibor
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db 
2026-01-12 21:49:00,026 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个日期
2026-01-12 21:49:00,026 - tushare_duckdb - INFO - → 正在更新表: shibor
2026-01-12 21:49:00,026 - tushare_duckdb - INFO - shibor: 处理参数组合 {}
2026-01-12 21:49:00,026 - tushare_duckdb - INFO - shibor: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=shibor
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109'}
2026-01-12 21:49:00,026 - tushare_duckdb - INFO - 开始获取 'shibor': 分页=False, API参数={'start_date': '20260108', 'end_date': '20260109'}, 唯一键=['date']
2026-01-12 21:49:00,026 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'shibor', 参数: {'start_date': '20260108', 'end_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:49:00,244 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:49:00,246 - tushare_duckdb - INFO - shibor: 合并前总行数: 2
2026-01-12 21:49:00,247 - tushare_duckdb - INFO - shibor 合并完成。总行数 (去重后): 2
2026-01-12 21:49:00,255 - tushare_duckdb - INFO - shibor: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'shibor' 的元数据: min=20061008, max=20260109, count=4791
2026-01-12 21:49:00,265 - tushare_duckdb - INFO - shibor: 元数据更新完成
2026-01-12 21:49:00,266 - tushare_duckdb - INFO - shibor: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:49:00,266 - tushare_duckdb - INFO - shibor: 本轮处理结束
2026-01-12 21:49:00,266 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:00,322 - tushare_duckdb - INFO -   → shibor_quote [回溯3天]: 20260106~20260109 (本地最新: 20260109)
2026-01-12 21:49:00,322 - tushare_duckdb - INFO - 正在处理类别: MACRO | 数据库: tushare_duck_macro.db
2026-01-12 21:49:00,322 - tushare_duckdb - INFO - 选择表: shibor_quote
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db 
2026-01-12 21:49:00,337 - tushare_duckdb - INFO - 日期范围: 20260106 ~ 20260109，共 4 个日期
2026-01-12 21:49:00,337 - tushare_duckdb - INFO - → 正在更新表: shibor_quote
2026-01-12 21:49:00,338 - tushare_duckdb - INFO - shibor_quote: 处理参数组合 {}
2026-01-12 21:49:00,338 - tushare_duckdb - INFO - shibor_quote: date_param_mode=range，使用范围拉取 20260106~20260109
DEBUG: build_api_params called, table_name=shibor_quote
DEBUG: build_api_params → {'start_date': '20260106', 'end_date': '20260109'}
2026-01-12 21:49:00,338 - tushare_duckdb - INFO - 开始获取 'shibor_quote': 分页=False, API参数={'start_date': '20260106', 'end_date': '20260109'}, 唯一键=['date', 'bank']
2026-01-12 21:49:00,338 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'shibor_quote', 参数: {'start_date': '20260106', 'end_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:49:00,582 - tushare_duckdb - INFO -   API返回 72 行. 总计: 72 行.
2026-01-12 21:49:00,584 - tushare_duckdb - INFO - shibor_quote: 合并前总行数: 72
2026-01-12 21:49:00,585 - tushare_duckdb - INFO - shibor_quote 合并完成。总行数 (去重后): 72
2026-01-12 21:49:00,601 - tushare_duckdb - INFO - shibor_quote: 实际插入 1 条新记录（NOT EXISTS 去重后）
已更新表 'shibor_quote' 的元数据: min=20061008, max=20260109, count=73825
2026-01-12 21:49:00,609 - tushare_duckdb - INFO - shibor_quote: 元数据更新完成
2026-01-12 21:49:00,609 - tushare_duckdb - INFO - shibor_quote: 日期处理完成。本轮总共存储 1 条。
2026-01-12 21:49:00,609 - tushare_duckdb - INFO - shibor_quote: 本轮处理结束
2026-01-12 21:49:00,609 - tushare_duckdb - INFO -  → 本表完成，存储 1 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:00,665 - tushare_duckdb - INFO -   → us_tycr: 20251230~20260109 (本地最新: 20251231)
2026-01-12 21:49:00,666 - tushare_duckdb - INFO - 正在处理类别: MACRO | 数据库: tushare_duck_macro.db
2026-01-12 21:49:00,666 - tushare_duckdb - INFO - 选择表: us_tycr
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db 
2026-01-12 21:49:00,679 - tushare_duckdb - INFO - 日期范围: 20251230 ~ 20260109，共 11 个日期
2026-01-12 21:49:00,679 - tushare_duckdb - INFO - → 正在更新表: us_tycr
2026-01-12 21:49:00,679 - tushare_duckdb - INFO - us_tycr: 处理参数组合 {}
2026-01-12 21:49:00,680 - tushare_duckdb - INFO - us_tycr: date_param_mode=range，使用范围拉取 20251230~20260109
DEBUG: build_api_params called, table_name=us_tycr
DEBUG: build_api_params → {'start_date': '20251230', 'end_date': '20260109'}
2026-01-12 21:49:00,680 - tushare_duckdb - INFO - 开始获取 'us_tycr': 分页=False, API参数={'start_date': '20251230', 'end_date': '20260109'}, 唯一键=['date']
2026-01-12 21:49:00,680 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'us_tycr', 参数: {'start_date': '20251230', 'end_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:49:00,823 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:49:00,824 - tushare_duckdb - INFO - us_tycr: 合并前总行数: 2
2026-01-12 21:49:00,824 - tushare_duckdb - INFO - us_tycr 合并完成。总行数 (去重后): 2
2026-01-12 21:49:00,831 - tushare_duckdb - INFO - us_tycr: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'us_tycr' 的元数据: min=19900102, max=20251231, count=9005
2026-01-12 21:49:00,839 - tushare_duckdb - INFO - us_tycr: 元数据更新完成
2026-01-12 21:49:00,839 - tushare_duckdb - INFO - us_tycr: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:49:00,839 - tushare_duckdb - INFO - us_tycr: 本轮处理结束
2026-01-12 21:49:00,839 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:00,891 - tushare_duckdb - INFO -   → us_trycr: 20251230~20260109 (本地最新: 20251231)
2026-01-12 21:49:00,891 - tushare_duckdb - INFO - 正在处理类别: MACRO | 数据库: tushare_duck_macro.db
2026-01-12 21:49:00,891 - tushare_duckdb - INFO - 选择表: us_trycr
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db 
2026-01-12 21:49:00,905 - tushare_duckdb - INFO - 日期范围: 20251230 ~ 20260109，共 11 个日期
2026-01-12 21:49:00,905 - tushare_duckdb - INFO - → 正在更新表: us_trycr
2026-01-12 21:49:00,905 - tushare_duckdb - INFO - us_trycr: 处理参数组合 {}
2026-01-12 21:49:00,905 - tushare_duckdb - INFO - us_trycr: date_param_mode=range，使用范围拉取 20251230~20260109
DEBUG: build_api_params called, table_name=us_trycr
DEBUG: build_api_params → {'start_date': '20251230', 'end_date': '20260109'}
2026-01-12 21:49:00,905 - tushare_duckdb - INFO - 开始获取 'us_trycr': 分页=False, API参数={'start_date': '20251230', 'end_date': '20260109'}, 唯一键=['date']
2026-01-12 21:49:00,905 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'us_trycr', 参数: {'start_date': '20251230', 'end_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:49:01,166 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:49:01,168 - tushare_duckdb - INFO - us_trycr: 合并前总行数: 2
2026-01-12 21:49:01,169 - tushare_duckdb - INFO - us_trycr 合并完成。总行数 (去重后): 2
2026-01-12 21:49:01,176 - tushare_duckdb - INFO - us_trycr: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'us_trycr' 的元数据: min=20030102, max=20251231, count=5750
2026-01-12 21:49:01,185 - tushare_duckdb - INFO - us_trycr: 元数据更新完成
2026-01-12 21:49:01,185 - tushare_duckdb - INFO - us_trycr: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:49:01,185 - tushare_duckdb - INFO - us_trycr: 本轮处理结束
2026-01-12 21:49:01,185 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:01,240 - tushare_duckdb - INFO -   → us_tltr: 20251230~20260109 (本地最新: 20251231)
2026-01-12 21:49:01,240 - tushare_duckdb - INFO - 正在处理类别: MACRO | 数据库: tushare_duck_macro.db
2026-01-12 21:49:01,240 - tushare_duckdb - INFO - 选择表: us_tltr
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db 
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:49:01,268 - tushare_duckdb - INFO - 日期范围: 20251230 ~ 20260109，共 7 个交易日
2026-01-12 21:49:01,268 - tushare_duckdb - INFO - → 正在更新表: us_tltr
2026-01-12 21:49:01,268 - tushare_duckdb - INFO - us_tltr: 处理参数组合 {}
2026-01-12 21:49:01,268 - tushare_duckdb - INFO - us_tltr: date_param_mode=range，使用范围拉取 20251230~20260109
DEBUG: build_api_params called, table_name=us_tltr
DEBUG: build_api_params → {'start_date': '20251230', 'end_date': '20260109'}
2026-01-12 21:49:01,268 - tushare_duckdb - INFO - 开始获取 'us_tltr': 分页=False, API参数={'start_date': '20251230', 'end_date': '20260109'}, 唯一键=['date']
2026-01-12 21:49:01,268 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'us_tltr', 参数: {'start_date': '20251230', 'end_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:49:01,433 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:49:01,434 - tushare_duckdb - INFO - us_tltr: 合并前总行数: 2
2026-01-12 21:49:01,435 - tushare_duckdb - INFO - us_tltr 合并完成。总行数 (去重后): 2
2026-01-12 21:49:01,440 - tushare_duckdb - INFO - us_tltr: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'us_tltr' 的元数据: min=20000103, max=20251231, count=6500
2026-01-12 21:49:01,449 - tushare_duckdb - INFO - us_tltr: 元数据更新完成
2026-01-12 21:49:01,449 - tushare_duckdb - INFO - us_tltr: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:49:01,449 - tushare_duckdb - INFO - us_tltr: 本轮处理结束
2026-01-12 21:49:01,449 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:01,503 - tushare_duckdb - INFO -   → us_trltr: 20251230~20260109 (本地最新: 20251231)
2026-01-12 21:49:01,503 - tushare_duckdb - INFO - 正在处理类别: MACRO | 数据库: tushare_duck_macro.db
2026-01-12 21:49:01,503 - tushare_duckdb - INFO - 选择表: us_trltr
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db 
2026-01-12 21:49:01,517 - tushare_duckdb - INFO - 日期范围: 20251230 ~ 20260109，共 11 个日期
2026-01-12 21:49:01,517 - tushare_duckdb - INFO - → 正在更新表: us_trltr
2026-01-12 21:49:01,517 - tushare_duckdb - INFO - us_trltr: 处理参数组合 {}
2026-01-12 21:49:01,518 - tushare_duckdb - INFO - us_trltr: date_param_mode=range，使用范围拉取 20251230~20260109
DEBUG: build_api_params called, table_name=us_trltr
DEBUG: build_api_params → {'start_date': '20251230', 'end_date': '20260109'}
2026-01-12 21:49:01,518 - tushare_duckdb - INFO - 开始获取 'us_trltr': 分页=False, API参数={'start_date': '20251230', 'end_date': '20260109'}, 唯一键=['date']
2026-01-12 21:49:01,518 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'us_trltr', 参数: {'start_date': '20251230', 'end_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:49:01,638 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:49:01,639 - tushare_duckdb - INFO - us_trltr: 合并前总行数: 2
2026-01-12 21:49:01,639 - tushare_duckdb - INFO - us_trltr 合并完成。总行数 (去重后): 2
2026-01-12 21:49:01,643 - tushare_duckdb - INFO - us_trltr: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'us_trltr' 的元数据: min=20000103, max=20251231, count=6500
2026-01-12 21:49:01,649 - tushare_duckdb - INFO - us_trltr: 元数据更新完成
2026-01-12 21:49:01,650 - tushare_duckdb - INFO - us_trltr: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:49:01,650 - tushare_duckdb - INFO - us_trltr: 本轮处理结束
2026-01-12 21:49:01,650 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:01,701 - tushare_duckdb - INFO -   → us_tbr: 20251230~20260109 (本地最新: 20251231)
2026-01-12 21:49:01,701 - tushare_duckdb - INFO - 正在处理类别: MACRO | 数据库: tushare_duck_macro.db
2026-01-12 21:49:01,701 - tushare_duckdb - INFO - 选择表: us_tbr
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db 
2026-01-12 21:49:01,715 - tushare_duckdb - INFO - 日期范围: 20251230 ~ 20260109，共 11 个日期
2026-01-12 21:49:01,715 - tushare_duckdb - INFO - → 正在更新表: us_tbr
2026-01-12 21:49:01,715 - tushare_duckdb - INFO - us_tbr: 处理参数组合 {}
2026-01-12 21:49:01,715 - tushare_duckdb - INFO - us_tbr: date_param_mode=range，使用范围拉取 20251230~20260109
DEBUG: build_api_params called, table_name=us_tbr
DEBUG: build_api_params → {'start_date': '20251230', 'end_date': '20260109'}
2026-01-12 21:49:01,715 - tushare_duckdb - INFO - 开始获取 'us_tbr': 分页=False, API参数={'start_date': '20251230', 'end_date': '20260109'}, 唯一键=['date']
2026-01-12 21:49:01,715 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'us_tbr', 参数: {'start_date': '20251230', 'end_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:49:01,827 - tushare_duckdb - INFO -   API返回 2 行. 总计: 2 行.
2026-01-12 21:49:01,828 - tushare_duckdb - INFO - us_tbr: 合并前总行数: 2
2026-01-12 21:49:01,828 - tushare_duckdb - INFO - us_tbr 合并完成。总行数 (去重后): 2
2026-01-12 21:49:01,833 - tushare_duckdb - INFO - us_tbr: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'us_tbr' 的元数据: min=20020102, max=20251231, count=6003
2026-01-12 21:49:01,839 - tushare_duckdb - INFO - us_tbr: 元数据更新完成
2026-01-12 21:49:01,840 - tushare_duckdb - INFO - us_tbr: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:49:01,840 - tushare_duckdb - INFO - us_tbr: 本轮处理结束
2026-01-12 21:49:01,840 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:01,877 - tushare_duckdb - INFO -   ✓ macro 完成: 7个成功, 0个失败, 存储1条
2026-01-12 21:49:01,877 - tushare_duckdb - INFO -   总进度: 49/51 表
2026-01-12 21:49:01,877 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:49:01,877 - tushare_duckdb - INFO - 类别: FX (1 个表)
2026-01-12 21:49:01,877 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fx.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fx.db
2026-01-12 21:49:01,890 - tushare_duckdb - INFO -   → fx_daily: 20260107~20260109 (本地最新: 20260108)
2026-01-12 21:49:01,890 - tushare_duckdb - INFO - 正在处理类别: FX | 数据库: tushare_duck_fx.db
2026-01-12 21:49:01,890 - tushare_duckdb - INFO - 选择表: fx_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fx.db 
2026-01-12 21:49:01,902 - tushare_duckdb - INFO - 日期范围: 20260107 ~ 20260109，共 3 个日期
2026-01-12 21:49:01,902 - tushare_duckdb - INFO - → 正在更新表: fx_daily
2026-01-12 21:49:01,902 - tushare_duckdb - INFO - fx_daily: 处理参数组合 {}
2026-01-12 21:49:01,902 - tushare_duckdb - INFO - fx_daily: date_param_mode=range，使用范围拉取 20260107~20260109
DEBUG: build_api_params called, table_name=fx_daily
DEBUG: build_api_params → {'start_date': '20260107', 'end_date': '20260109'}
2026-01-12 21:49:01,902 - tushare_duckdb - INFO - 开始获取 'fx_daily': 分页=True, API参数={'start_date': '20260107', 'end_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:49:01,902 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'fx_daily', 参数: {'start_date': '20260107', 'end_date': '20260109', 'limit': 4000, 'offset': 0}
2026-01-12 21:49:02,289 - tushare_duckdb - INFO -   API返回 628 行. 总计: 628 行.
2026-01-12 21:49:02,291 - tushare_duckdb - INFO - fx_daily: 合并前总行数: 628
2026-01-12 21:49:02,293 - tushare_duckdb - INFO - fx_daily 合并完成。总行数 (去重后): 628
2026-01-12 21:49:02,318 - tushare_duckdb - INFO - fx_daily: 实际插入 424 条新记录（NOT EXISTS 去重后）
已更新表 'fx_daily' 的元数据: min=20010909, max=20260109, count=682924
2026-01-12 21:49:02,325 - tushare_duckdb - INFO - fx_daily: 元数据更新完成
2026-01-12 21:49:02,325 - tushare_duckdb - INFO - fx_daily: 日期处理完成。本轮总共存储 424 条。
2026-01-12 21:49:02,325 - tushare_duckdb - INFO - fx_daily: 本轮处理结束
2026-01-12 21:49:02,325 - tushare_duckdb - INFO -  → 本表完成，存储 424 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fx.db
2026-01-12 21:49:02,340 - tushare_duckdb - INFO -   ✓ fx 完成: 1个成功, 0个失败, 存储424条
2026-01-12 21:49:02,340 - tushare_duckdb - INFO -   总进度: 50/51 表
2026-01-12 21:49:02,340 - tushare_duckdb - INFO - 
──────────────────────────────────────────────────
2026-01-12 21:49:02,340 - tushare_duckdb - INFO - 类别: COMMODITY (1 个表)
2026-01-12 21:49:02,340 - tushare_duckdb - INFO - ──────────────────────────────────────────────────
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_commodity.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_commodity.db
2026-01-12 21:49:02,353 - tushare_duckdb - INFO -   → sge_daily: 20260108~20260109 (本地最新: 20260109)
2026-01-12 21:49:02,353 - tushare_duckdb - INFO - 正在处理类别: COMMODITY | 数据库: tushare_duck_commodity.db
2026-01-12 21:49:02,353 - tushare_duckdb - INFO - 选择表: sge_daily
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_commodity.db 
2026-01-12 21:49:02,365 - tushare_duckdb - INFO - 日期范围: 20260108 ~ 20260109，共 2 个日期
2026-01-12 21:49:02,365 - tushare_duckdb - INFO - → 正在更新表: sge_daily
2026-01-12 21:49:02,365 - tushare_duckdb - INFO - sge_daily: 处理参数组合 {}
2026-01-12 21:49:02,365 - tushare_duckdb - INFO - sge_daily: date_param_mode=range，使用范围拉取 20260108~20260109
DEBUG: build_api_params called, table_name=sge_daily
DEBUG: build_api_params → {'start_date': '20260108', 'end_date': '20260109'}
2026-01-12 21:49:02,365 - tushare_duckdb - INFO - 开始获取 'sge_daily': 分页=True, API参数={'start_date': '20260108', 'end_date': '20260109'}, 唯一键=['ts_code', 'trade_date']
2026-01-12 21:49:02,365 - tushare_duckdb - INFO - 页 1, 尝试 1/3: 调用 API 'sge_daily', 参数: {'start_date': '20260108', 'end_date': '20260109', 'limit': 2000, 'offset': 0}
2026-01-12 21:49:02,594 - tushare_duckdb - INFO -   API返回 82 行. 总计: 82 行.
2026-01-12 21:49:02,596 - tushare_duckdb - INFO - sge_daily: 合并前总行数: 82
2026-01-12 21:49:02,597 - tushare_duckdb - INFO - sge_daily 合并完成。总行数 (去重后): 82
2026-01-12 21:49:02,610 - tushare_duckdb - INFO - sge_daily: 实际插入 0 条新记录（NOT EXISTS 去重后）
已更新表 'sge_daily' 的元数据: min=20021031, max=20260109, count=73465
2026-01-12 21:49:02,619 - tushare_duckdb - INFO - sge_daily: 元数据更新完成
2026-01-12 21:49:02,619 - tushare_duckdb - INFO - sge_daily: 日期处理完成。本轮总共存储 0 条。
2026-01-12 21:49:02,619 - tushare_duckdb - INFO - sge_daily: 本轮处理结束
2026-01-12 21:49:02,620 - tushare_duckdb - INFO -  → 本表完成，存储 0 条
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_commodity.db
2026-01-12 21:49:02,624 - tushare_duckdb - INFO -   ✓ commodity 完成: 1个成功, 0个失败, 存储0条
2026-01-12 21:49:02,624 - tushare_duckdb - INFO -   总进度: 51/51 表
2026-01-12 21:49:02,624 - tushare_duckdb - INFO - 
======================================================================
2026-01-12 21:49:02,624 - tushare_duckdb - INFO -   [阶段3] 数据变化对比 (过去15日)
2026-01-12 21:49:02,624 - tushare_duckdb - INFO - ======================================================================
2026-01-12 21:49:02,624 - tushare_duckdb - INFO - 
  STOCK:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:49:02,652 - tushare_duckdb - INFO -     daily: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:49:02,678 - tushare_duckdb - INFO -     adj_factor: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:49:02,704 - tushare_duckdb - INFO -     daily_basic: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:49:02,731 - tushare_duckdb - INFO -     stk_limit: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:49:02,749 - tushare_duckdb - INFO -     suspend_d: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_stock.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_stock.db
2026-01-12 21:49:02,772 - tushare_duckdb - INFO -     bak_basic: 无变化
2026-01-12 21:49:02,772 - tushare_duckdb - INFO - 
  MARGIN:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
2026-01-12 21:49:02,787 - tushare_duckdb - INFO -     margin: 20260109:+2
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
2026-01-12 21:49:02,806 - tushare_duckdb - INFO -     margin_detail: 20260109:+2325
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_margin.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_margin.db
2026-01-12 21:49:02,824 - tushare_duckdb - INFO -     margin_secs: 20260109:+4295
2026-01-12 21:49:02,824 - tushare_duckdb - INFO - 
  MONEYFLOW:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:49:02,849 - tushare_duckdb - INFO -     moneyflow: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:49:02,867 - tushare_duckdb - INFO -     moneyflow_ths: 20260109:+4, 20260108:+5
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:49:02,885 - tushare_duckdb - INFO -     moneyflow_dc: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:49:02,900 - tushare_duckdb - INFO -     moneyflow_ind_ths: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:49:02,916 - tushare_duckdb - INFO -     moneyflow_ind_dc: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_moneyflow.db
2026-01-12 21:49:02,931 - tushare_duckdb - INFO -     moneyflow_mkt_dc: 无变化
2026-01-12 21:49:02,931 - tushare_duckdb - INFO - 
  INDEX:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:49:02,951 - tushare_duckdb - INFO -     index_daily: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:49:02,970 - tushare_duckdb - INFO -     index_dailybasic: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:49:02,989 - tushare_duckdb - INFO -     daily_info: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:49:03,009 - tushare_duckdb - INFO -     sz_daily_info: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:49:03,030 - tushare_duckdb - INFO -     ths_daily: 20260109:+1, 20260108:+271
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:49:03,051 - tushare_duckdb - INFO -     dc_daily: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:49:03,070 - tushare_duckdb - INFO -     ci_daily: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:49:03,092 - tushare_duckdb - INFO -     sw_daily: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:49:03,113 - tushare_duckdb - INFO -     tdx_daily: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_index.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_index.db
2026-01-12 21:49:03,133 - tushare_duckdb - INFO -     index_global: 无变化
2026-01-12 21:49:03,133 - tushare_duckdb - INFO - 
  FUND:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:49:03,172 - tushare_duckdb - INFO -     fund_nav: 20260109:+23591, 20260108:+23577, 20260107:+1512, 20260106:+814, 20260105:+1510
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:49:03,192 - tushare_duckdb - INFO -     fund_daily: 20260109:+1858
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:49:03,212 - tushare_duckdb - INFO -     fund_adj: 20260109:+1872
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fund.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fund.db
2026-01-12 21:49:03,230 - tushare_duckdb - INFO -     etf_share_size: 20260109:+1391
2026-01-12 21:49:03,230 - tushare_duckdb - INFO - 
  BOND:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:49:03,246 - tushare_duckdb - INFO -     cb_share: 20260108:+25
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:49:03,263 - tushare_duckdb - INFO -     cb_daily: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:49:03,281 - tushare_duckdb - INFO -     bond_blk: 20260109:+10, 20260108:+14, 20260107:+4, 20260106:+12
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:49:03,297 - tushare_duckdb - INFO -     bond_blk_detail: 20260109:+10, 20260108:+14, 20260107:+4, 20260106:+12
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:49:03,316 - tushare_duckdb - INFO -     repo_daily: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_bond.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_bond.db
2026-01-12 21:49:03,335 - tushare_duckdb - INFO -     yc_cb: 无变化
2026-01-12 21:49:03,335 - tushare_duckdb - INFO - 
  OPTION:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_opt.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_opt.db
2026-01-12 21:49:03,362 - tushare_duckdb - INFO -     opt_daily: 20260109:+22858
2026-01-12 21:49:03,362 - tushare_duckdb - INFO - 
  FUTURE:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:49:03,382 - tushare_duckdb - INFO -     fut_daily: 20260109:+1069
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:49:03,402 - tushare_duckdb - INFO -     fut_wsr: 20260109:+490
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:49:03,421 - tushare_duckdb - INFO -     fut_settle: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:49:03,449 - tushare_duckdb - INFO -     fut_holding: 20260109:+9403, 20260108:+470
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_future.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_future.db
2026-01-12 21:49:03,467 - tushare_duckdb - INFO -     fut_index_daily: 20260109:+95
2026-01-12 21:49:03,467 - tushare_duckdb - INFO - 
  REFERENCE:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_ref.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_ref.db
2026-01-12 21:49:03,482 - tushare_duckdb - INFO -     block_trade: 无变化
2026-01-12 21:49:03,482 - tushare_duckdb - INFO - 
  MACRO:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:03,498 - tushare_duckdb - INFO -     shibor: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:03,516 - tushare_duckdb - INFO -     shibor_quote: 20260109:+1
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:03,532 - tushare_duckdb - INFO -     us_tycr: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:03,547 - tushare_duckdb - INFO -     us_trycr: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:03,563 - tushare_duckdb - INFO -     us_tltr: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:03,578 - tushare_duckdb - INFO -     us_trltr: 无变化
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_macro.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_macro.db
2026-01-12 21:49:03,593 - tushare_duckdb - INFO -     us_tbr: 无变化
2026-01-12 21:49:03,594 - tushare_duckdb - INFO - 
  FX:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_fx.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_fx.db
2026-01-12 21:49:03,608 - tushare_duckdb - INFO -     fx_daily: 20260109:+2, 20260108:+211, 20260107:+211
2026-01-12 21:49:03,609 - tushare_duckdb - INFO - 
  COMMODITY:
数据库连接成功: /Users/robert/Developer/DuckDB/tushare_duck_commodity.db (只读)
数据库连接已关闭: /Users/robert/Developer/DuckDB/tushare_duck_commodity.db
2026-01-12 21:49:03,623 - tushare_duckdb - INFO -     sge_daily: 无变化
2026-01-12 21:49:03,623 - tushare_duckdb - INFO - 
======================================================================
2026-01-12 21:49:03,623 - tushare_duckdb - INFO -   执行汇总
2026-01-12 21:49:03,623 - tushare_duckdb - INFO - ======================================================================
2026-01-12 21:49:03,624 - tushare_duckdb - INFO -   结束日期: 20260109
2026-01-12 21:49:03,624 - tushare_duckdb - INFO -   模式: 自动增量
2026-01-12 21:49:03,624 - tushare_duckdb - INFO -   类别数: 12
2026-01-12 21:49:03,624 - tushare_duckdb - INFO -   成功表数: 51
2026-01-12 21:49:03,624 - tushare_duckdb - INFO -   失败表数: 0
2026-01-12 21:49:03,624 - tushare_duckdb - INFO -   总存储记录: 97943
2026-01-12 21:49:03,624 - tushare_duckdb - INFO - ======================================================================