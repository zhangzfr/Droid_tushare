import pandas as pd

# 假设CSV内容作为字符串提供，但实际中用pd.read_csv加载附件文件
# 这里直接用提供的CSV字符串加载

csv_data = """trade_date,ggt_ss,ggt_sz,hgt,sgt,north_money,south_money,north_daily,south_daily,hgt_daily,sgt_daily,year,month,quarter,weekday,ns_ratio,north_ma5,north_ma20,north_ma60,north_zscore,south_zscore,north_momentum_5d,north_momentum_20d,north_volatility_20d,signal,north_cum_5d,north_cum_10d,north_cum_20d,north_cum_60d

2014-11-17,1768.0,,13000.0,,13000.0,1768.0,,,,,2014,11,4,0,7.352941176470588,,,,,,,,,0,,,,

2014-11-18,800.0,,4845.0,,4845.0,800.0,-8155.0,-968.0,-8155.0,,2014,11,4,1,6.05625,,,,-0.6319785405704432,-0.3444125925211417,,,,0,,,,

2014-11-19,253.0,,2612.0,,2612.0,253.0,-2233.0,-547.0,-2233.0,,2014,11,4,2,10.32411067193676,,,,-0.1796842266166422,-0.19851234207765053,,,,0,,,,

2014-11-20,196.0,,2276.0,,2276.0,196.0,-336.0,-57.0,-336.0,,2014,11,4,3,11.612244897959183,,,,-0.034800350633805266,-0.028699699043658457,,,,0,,,,

2014-11-21,186.0,,2341.0,,2341.0,186.0,65.0,-10.0,65.0,,2014,11,4,4,12.586021505376344,,,,-0.0041738697328471104,-0.012411547568969422,,,,0,,,,

2014-11-24,141.0,,6956.0,,6956.0,141.0,4615.0,-45.0,4615.0,,2014,11,4,0,49.333333333333336,-1208.8,,,0.34333358188650354,-0.02454102207139743,-6044.0,,,0,-6044.0,,,

2014-11-25,155.0,,2853.0,,2853.0,155.0,-4103.0,14.0,-4103.0,,2014,11,4,1,18.406451612903226,-398.4,,,-0.3225059704689907,-0.004094193624447361,-1992.0,,,0,-1992.0,,,

2014-11-26,213.0,,3295.0,,3295.0,213.0,442.0,58.0,442.0,,2014,11,4,2,15.469483568075118,136.6,,,0.024619604829899083,0.011154288607176419,683.0,,,0,683.0,,,

2014-11-27,175.0,,2990.0,,2990.0,175.0,-305.0,-38.0,-305.0,,2014,11,4,3,17.085714285714285,142.8,,,-0.03243271744694815,-0.022115127170911828,714.0,,,0,714.0,,,

2014-11-28,293.0,,2345.0,,2345.0,293.0,-645.0,118.0,-645.0,,2014,11,4,4,8.003412969283277,0.8,,,-0.058400307238284245,0.031947673468481576,4.0,,,0,4.0,,,

2014-12-01,281.0,,1398.0,,1398.0,281.0,-947.0,-12.0,-947.0,,2014,12,4,0,4.97508896797153,-1111.6,,,-0.08146563699411806,-0.013104660397679593,-5558.0,,,0,-5558.0,-11602.0,,

2014-12-02,299.0,,3311.0,,3311.0,299.0,1913.0,18.0,1913.0,,2014,12,4,1,11.073578595317725,91.6,,,0.13696761830947377,-0.002707967967027018,458.0,,,0,458.0,-1534.0,,

2014-12-03,457.0,,3861.0,,3861.0,457.0,550.0,158.0,550.0,,2014,12,4,2,8.448577680525164,113.2,,,0.0328681333518529,0.04580993004268501,566.0,,,0,566.0,1249.0,,

2014-12-04,415.0,,3521.0,,3521.0,415.0,-340.0,-42.0,-340.0,,2014,12,4,3,8.48433734939759,106.2,,,-0.035105851690173925,-0.02350135282833217,531.0,,,0,531.0,1245.0,,

2014-12-05,1431.0,,2567.0,,2567.0,1431.0,-954.0,1016.0,-954.0,,2014,12,4,4,1.7938504542278126,44.4,,,-0.08200026384276321,0.34315533355934874,222.0,,,0,222.0,226.0,,

2014-12-08,525.0,,1677.0,,1677.0,525.0,-890.0,-906.0,-890.0,,2014,12,4,0,3.1942857142857144,55.8,,,-0.07711224694086466,-0.3229260948311264,279.0,,,0,279.0,-5279.0,,

2014-12-09,763.0,,1159.0,,1159.0,763.0,-518.0,238.0,-518.0,,2014,12,4,1,1.5190039318479684,-430.4,,,-0.04870064869857929,0.07353444319109188,-2152.0,,,0,-2152.0,-1694.0,,

2014-12-10,391.0,,1941.0,,1941.0,391.0,782.0,-372.0,782.0,,2014,12,4,2,4.964194373401535,-384.0,,,0.050587194621235176,-0.13786496956551053,-1920.0,,,0,-1920.0,-1354.0,,

2014-12-11,483.0,,1074.0,,1074.0,483.0,-867.0,92.0,-867.0,,2014,12,4,3,2.2236024844720497,-489.4,,,-0.07535561586674487,0.02293720669524934,-2447.0,,,0,-2447.0,-1916.0,,

2014-12-12,311.0,,1862.0,,1862.0,311.0,788.0,-172.0,788.0,,2014,12,4,4,5.987138263665595,-141.0,,,0.051045446205788166,-0.06855368669449334,-705.0,,,0,-705.0,-483.0,,

2014-12-15,196.0,,1068.0,,1068.0,196.0,-794.0,-115.0,-794.0,,2014,12,4,0,5.448979591836735,-121.8,-596.6,,-0.06978022158801682,-0.04879997107625344,-609.0,-11932.0,2437.488599703435,0,-609.0,-330.0,-11932.0,

2014-12-16,393.0,,1318.0,,1318.0,393.0,250.0,197.0,250.0,,2014,12,4,1,3.3536895674300253,31.8,-176.35,,0.009955554124203408,0.05932563020253336,159.0,-3527.0,1669.2384420195312,0,159.0,-1993.0,-3527.0,

2014-12-17,330.0,,648.0,,648.0,330.0,-670.0,-63.0,-670.0,,2014,12,4,2,1.9636363636363636,-258.6,-98.2,,-0.06030968884058837,-0.030779037529788975,-1293.0,-1964.0,1603.1632415157762,0,-1293.0,-3213.0,-1964.0,

2014-12-18,398.0,,1908.0,,1908.0,398.0,1260.0,68.0,1260.0,,2014,12,4,3,4.793969849246231,166.8,-18.4,,0.08709457085729004,0.014619852750727278,834.0,-368.0,1630.197159532359,0,834.0,-1613.0,-368.0,

2014-12-19,248.0,,1071.0,,1071.0,248.0,-837.0,-150.0,-837.0,,2014,12,4,4,4.318548387096774,-158.2,-63.5,,-0.07306435794397992,-0.06092944557868145,-791.0,-1270.0,1640.2147324119044,0,-791.0,-1496.0,-1270.0,

2014-12-22,368.0,,1428.0,,1428.0,368.0,357.0,120.0,357.0,,2014,12,4,0,3.880434782608696,72.0,-276.4,,0.01812770738206506,0.03264078629719174,360.0,-5528.0,1224.6957259060855,0,360.0,-249.0,-5528.0,

2014-12-23,516.0,,653.0,,653.0,516.0,-775.0,148.0,-775.0,,2014,12,4,1,1.2655038759689923,-133.0,-110.0,,-0.06832909157026569,0.04234436589913415,-665.0,-2200.0,844.4764182927986,0,-665.0,-506.0,-2200.0,

2014-12-24,292.0,,,,0.0,292.0,-653.0,-224.0,,,2014,12,4,2,0.0,-129.6,-164.75,,-0.059011309351021564,-0.0865746202409578,-648.0,-3295.0,842.2982891438988,0,-648.0,-1941.0,-3295.0,

2014-12-29,,,750.0,,750.0,0.0,750.0,-292.0,,,2014,12,4,0,,-231.6,-112.0,,0.048143186170285894,-0.11014045641710365,-1158.0,-2240.0,865.7612409410528,0,-1158.0,-324.0,-2240.0,

2014-12-30,,,-630.0,,-630.0,0.0,-1380.0,0.0,-1380.0,,2014,12,4,1,,-340.2,-148.75,,-0.11453612634602549,-0.008945983425418564,-1701.0,-2975.0,904.3180550762239,0,-1701.0,-2492.0,-2975.0,

2014-12-31,,,2312.0,,2312.0,0.0,2942.0,0.0,2942.0,,2014,12,4,2,,176.8,45.7,,0.21555776506031152,-0.008945983425418564,884.0,914.0,1116.7940063555056,0,884.0,1244.0,914.0,

2015-01-05,1730.0,,4689.0,,4689.0,1730.0,2377.0,1730.0,2377.0,,2015,1,1,0,2.7104046242774564,807.2,68.9,,0.17240574084823831,0.59059661340888,4036.0,1378.0,1161.5491878476246,0,4036.0,3371.0,1378.0,

2015-01-06,968.0,,2091.0,,2091.0,968.0,-2598.0,-762.0,-2598.0,,2015,1,1,1,2.1601239669421486,418.2,-88.5,,-0.20756119801028244,-0.273021971163994,2091.0,-1770.0,1298.179636422115,0,2091.0,1443.0,-1770.0,

2015-01-07,909.0,,1753.0,,1753.0,909.0,-338.0,-59.0,-338.0,,2015,1,1,2,1.9284928492849285,200.6,-88.4,,-0.034953101161989596,-0.02939281187236863,1003.0,-1768.0,1298.1593203658147,0,1003.0,-155.0,-1768.0,

2015-01-08,637.0,,1078.0,,1078.0,637.0,-675.0,-272.0,-675.0,,2015,1,1,3,1.6923076923076923,341.6,-74.45,,-0.06069156516104919,-0.10320932813000194,1708.0,-1489.0,1289.8404419886501,0,1708.0,7.0,-1489.0,

2015-01-09,802.0,,1617.0,,1617.0,802.0,539.0,165.0,539.0,,2015,1,1,4,2.016209476309227, -139.0,-3.0,,0.032028005446839085,0.04823582494317061,-695.0,-60.0,1281.8402889267413,0,-695.0,189.0,-60.0,

2015-01-12,870.0,,-1133.0,,-1133.0,870.0,-2750.0,68.0,-2750.0,,2015,1,1,0,-1.3022988505747126,-1164.4,-114.6,,-0.2191702381522915,0.014619852750727278,-5822.0,-2292.0,1418.8740680739195,0,-5822.0,-1786.0,-2292.0,

2015-01-13,626.0,,-116.0,,-116.0,626.0,1017.0,-244.0,1017.0,,2015,1,1,1,-0.1853035143769968,-441.4,-102.85,,0.06853538168289394,-0.09350574852805953,-2207.0,-2057.0,1427.6357811725695,0,-2207.0,-116.0,-2057.0,

2015-01-14,678.0,,721.0,,721.0,678.0,837.0,52.0,837.0,,2015,1,1,2,1.0634218289085546,-206.4,-17.65,,0.05478783414630425,0.009074950121045902,-1032.0,-353.0,1430.475565934925,0,-1032.0,-29.0,-353.0,

2015-01-15,570.0,,1008.0,,1008.0,570.0,287.0,-108.0,287.0,,2015,1,1,3,1.768421052631579,-14.0,-42.7,,0.012781438895613513,-0.04637407617576784,-70.0,-854.0,1419.9728722390225,0,-70.0,1638.0,-854.0,

2015-01-16,969.0,,422.0,,422.0,969.0,-586.0,399.0,-586.0,,2015,1,1,4,0.43550051599587203,-239.0,-32.3,,-0.05389416665684651,0.1293300259022607,-1195.0,-646.0,1414.9334408746108,0,-1195.0,-1890.0,-646.0,

2015-01-19,824.0,,-327.0,,-327.0,824.0,-749.0,-145.0,-749.0,,2015,1,1,0,-0.39684466019417475,161.2,-82.25,,-0.0663433347038694,-0.05919666350690602,806.0,-1645.0,1422.0585847358946,0,806.0,-5016.0,-1645.0,

2015-01-20,630.0,,2424.0,,2424.0,630.0,2751.0,-194.0,2751.0,,2015,1,1,1,3.8476190476190477,508.0,88.8,,0.20097008961870802,-0.07617792781030523,2540.0,1776.0,1547.824537859509,0,2540.0,333.0,1776.0,

2015-01-21,940.0,,2135.0,,2135.0,940.0,-289.0,310.0,-289.0,,2015,1,1,2,2.271276595744681,282.8,11.35,,-0.031210713221473514,0.09848650502465806,1414.0,227.0,1524.7175502022465,0,1414.0,382.0,227.0,

2015-01-22,547.0,,250.0,,250.0,547.0,-1885.0,-393.0,-1885.0,,2015,1,1,3,0.4570383912248629,-151.6,-41.05,,-0.1531056347125688,-0.14514265426696732,-758.0,-821.0,1572.6618224827423,0,-758.0,-828.0,-821.0,

2015-01-23,521.0,,424.0,,424.0,521.0,174.0,-26.0,174.0,,2015,1,1,4,0.8138195777351248,0.4,-50.2,,0.004151034053198872,-0.017956450198650796,2.0,-1004.0,1570.7552189614842,0,2.0,-1193.0,-1004.0,

2015-01-26,653.0,,587.0,,587.0,653.0,163.0,132.0,163.0,,2015,1,1,0,0.8989280245022971,182.8,-3.3,,0.003310906148185057,0.03679946326945278,914.0,-66.0,1561.9538068511647,0,914.0,1720.0,-66.0,

2015-01-27,891.0,,1137.0,,1137.0,891.0,550.0,238.0,550.0,,2015,1,1,1,1.2760942760942762,-257.4,56.85,,0.0328681333518529,0.07353444319109188,-1287.0,1137.0,1558.7776005238015,0,-1287.0,1253.0,1137.0,

2015-01-28,368.0,,1832.0,,1832.0,368.0,695.0,-523.0,695.0,,2015,1,1,2,4.978260869565218,-60.6,54.1,,0.04394254664521682,-0.1901949881331285,-303.0,1082.0,1557.5384053725704,0,-303.0,1111.0,1082.0,

2015-01-29,576.0,,2886.0,,2886.0,576.0,1054.0,208.0,1054.0,,2015,1,1,3,5.010416666666667,527.2,175.8,,0.07136126645430405,0.0631377507604393,2636.0,3516.0,1534.507141860557,0,2636.0,1878.0,3516.0,

2015-01-30,515.0,,1816.0,,1816.0,515.0,-1070.0,-61.0,-1070.0,,2015,1,1,4,3.5262135922330096,278.4,-24.8,,-0.09085979447745435,-0.030085924701078803,1392.0,-496.0,1411.1376373617672,0,1392.0,1394.0,-496.0,

2015-02-02,460.0,,2336.12,,2336.12,460.0,520.1199999999999,-55.0,520.1199999999999,,2015,2,1,0,5.0785217391304345,349.82399999999996,-117.644,,0.030586040460779004,-0.02800658621494829,1749.12,-2352.88,1301.634066121667,0,1749.12,2663.12,-2352.88,

2015-02-03,263.0,,4958.0,,4958.0,263.0,2621.88,-197.0,2621.88,,2015,2,1,1,18.85171102661597,764.2,143.35,,0.1911085155191277,-0.07721759705337049,3821.0,2867.0,1301.4413487158658,0,3821.0,2534.0,2867.0,

2015-02-04,-9.0,,2167.0,,2167.0,-9.0,-2791.0,-272.0,-2791.0,,2015,2,1,2,-240.77777777777777,67.0,20.7,,-0.22230162398007028,-0.10320932813000194,335.0,414.0,1455.6440742810303,0,335.0,32.0,414.0,

2015-02-05,98.0,,3806.0,,3806.0,98.0,1639.0,107.0,1639.0,,2015,2,1,3,38.83673469387755,184.0,136.4,,0.11604079594822057,0.028135552910575626,920.0,2728.0,1489.016990267494,0,920.0,3556.0,2728.0,

2015-02-06,30.0,,1540.0,,1540.0,30.0,-2266.0,-68.0,-2266.0,,2015,2,1,4,51.333333333333336,-55.2,-3.85,,-0.18220461033168367,-0.03251181960156441,-276.0,-77.0,1578.5119258139437,0,-276.0,1116.0,-77.0,

2015-02-09,95.0,,1999.0,,1999.0,95.0,459.0,65.0,459.0,,2015,2,1,0,21.042105263157893,-67.42399999999998,156.6,,0.02591798431946589,0.013580183507662021,-337.1199999999999,3132.0,1441.8610844249008,0,-337.1199999999999,1412.0,3132.0,

2015-02-10,98.0,,1824.0,,1824.0,98.0,-175.0,3.0,-175.0,,2015,2,1,1,18.612244897959183,-626.8,97.0,,-0.022503933114966707,-0.007906314182353307,-3134.0,1940.0,1429.0028092639336,0,-3134.0,687.0,1940.0,

2015-02-11,184.0,,1767.0,,1767.0,184.0,-57.0,86.0,-57.0,,2015,2,1,2,9.603260869565217,-80.0,52.3,,-0.01349165195209124,0.020857868209118825,-400.0,1046.0,1418.5813103757473,0,-400.0,-65.0,1046.0,

2015-02-12,243.0,,1410.0,,1410.0,243.0,-357.0,59.0,-357.0,,2015,2,1,3,5.802469135802469,-479.2,20.1,,-0.03640423117974073,0.011500845021531505,-2396.0,402.0,1420.281501912099,0,-2396.0,-1476.0,402.0,

2015-02-13,337.0,,2157.0,,2157.0,337.0,747.0,94.0,747.0,,2015,2,1,4,6.400593471810089,123.4,86.75,-180.71666666666667,0.0479140603780094,0.02363031952395951,617.0,1735.0,1421.6183013290479,0,617.0,341.0,1735.0,-10843.0

2015-02-16,,,328.0,,328.0,0.0,-1829.0,-337.0,-1829.0,,2015,2,1,0,,-334.2,32.75,-75.28333333333333,-0.14882861992340757,-0.12573549506308251,-1671.0,655.0,1474.5610104777138,0,-1671.0,-2008.12,655.0,-4517.0

2015-02-17,,,403.0,,403.0,0.0,75.0,0.0,75.0,,2015,2,1,1,,-284.2,-101.05,-36.81666666666667,-0.003410117091925461,-0.0089...(truncated 845079 characters)...09999999996217,9587.059999999998,8894.399999999994,2025,12,4,4,3.7847768987627703,1266.3440000000003,-2158.5395000000017,-2331.278333333334,1.402388126409945,-0.004298661908918173,6331.720000000001,-43170.79000000004,21547.635383231456,1,6331.720000000001,-40717.380000000005,-43170.79000000004,-139876.70000000004

2025-12-08,28317.04,22608.88,101912.92,120655.9,222568.82,50925.92,29883.860000000015,15.400000000001455,13336.660000000003,16547.199999999997,2025,12,4,0,4.37044279219698,-1438.777999999997,-1053.398000000001,-2638.379666666667,2.2732494376944485,-0.003609014644349737,-7193.889999999985,-21067.96000000002,22624.165923255485,1,-7193.889999999985,-13738.820000000007,-21067.96000000002,-158302.78000000003

2025-12-09,28313.52,22617.71,99645.6,119954.43,219600.03,50931.23,-2968.790000000008,5.310000000004948,-2267.3199999999924,-701.4700000000012,2025,12,4,1,4.311696968637906,7967.971999999997,-188.37800000000135,-1607.472666666668,-0.2358803821830169,-0.007105768865191343,39839.859999999986,-3767.560000000027,22177.112031451303,0,39839.859999999986,4293.7300000000105,-3767.560000000027,-96448.36000000007

2025-12-10,28281.31,22639.74,92187.99,112225.99,204413.98,50921.04,-15186.049999999988,-10.190000000002328,-7457.610000000001,-7728.439999999988,2025,12,4,2,4.014332385984261,3421.0100000000034,-1082.573000000001,-2077.158166666667,-1.168976841165659,-0.012477393287697695,17105.050000000017,-21651.46000000002,22413.89350902741,-1,17105.050000000017,3706.5200000000186,-21651.46000000002,-124629.49000000002

2025-12-11,28278.1,22650.85,94198.22,111888.9,206087.12,50928.95,1673.1399999999849,7.9099999999962165,2010.229999999996,-337.09000000001106,2025,12,4,3,4.0465613369213385,6376.723999999999,-966.7035000000018,-1261.074000000001,0.11864824746432592,-0.006204722187871146,31883.619999999995,-19334.070000000036,22422.267051341525,0,31883.619999999995,13543.399999999994,-19334.070000000036,-75664.44000000006

2025-12-12,28212.15,22663.93,149883.45,159800.24,309683.69,50876.09,103596.57,-52.86000000000058,55685.23000000001,47911.34,2025,12,4,4,6.087018283048089,23399.746000000003,4993.078499999999,767.8179999999993,7.903077130893617,-0.027264955488228604,116998.73000000001,99861.56999999998,32086.556555836378,1,116998.73000000001,123330.45000000001,99861.56999999998,46069.07999999996

2025-12-15,28217.04,22695.59,99385.28,112820.3,212205.58,50912.63,-97478.11000000002,36.54000000000087,-50498.17000000001,-46979.93999999999,2025,12,4,0,4.168034140055228,-2072.648000000004,-39.75650000000169,-1717.6948333333348,-7.4540546563539465,0.0037171879551165772,-10363.24000000002,-795.1300000000338,39438.065142800835,-1,-10363.24000000002,-17557.130000000005,-795.1300000000338,-103061.69000000009

2025-12-16,28205.98,22707.47,96118.85,111516.58,207635.43,50913.45,-4570.149999999994,0.819999999999709,-3266.429999999993,-1303.7200000000012,2025,12,4,1,4.07820389307737,-2392.920000000001,-526.8755000000019,-1727.4558333333348,-0.35818467508964513,-0.008661807165647495,-11964.600000000006,-10537.510000000038,39430.466864258044,0,-11964.600000000006,27875.25999999998,-10537.510000000038,-103647.3500000001

2025-12-17,28228.17,22764.38,96473.91,116286.42,212760.33,50992.55,5124.899999999994,79.10000000000582,355.0599999999977,4769.8399999999965,2025,12,4,2,4.17238067129414,1669.2699999999954,1073.7029999999984,-1242.4251666666682,0.382277329047098,0.01846662895007075,8346.349999999977,21474.05999999997,38950.94039474232,0,8346.349999999977,25451.399999999994,21474.05999999997,-74545.5100000001

2025-12-18,28217.22,22787.9,83088.73,100308.98,183397.71,51005.12,-29362.619999999995,12.569999999999709,-13385.180000000008,-15977.440000000002,2025,12,4,3,3.595672552088888,-4537.8820000000005,-432.8535000000018,-1737.0675000000012,-2.2517161188367227,-0.004589769296975235,-22689.410000000003,-8657.070000000036,39541.59818955478,-1,-22689.410000000003,9194.209999999992,-8657.070000000036,-104224.05000000008

2025-12-19,28207.95,22830.88,94048.97,104891.57,198940.54,51038.83,15542.830000000016,33.70999999999913,10960.240000000005,4582.590000000011,2025,12,4,4,3.897827203327349,-22148.629999999997,-1723.0900000000008,-1479.7501666666674,1.1779494840907878,0.002736433302491079,-110743.15,-34461.80000000002,38514.21273329352,1,-110743.15,6255.580000000016,-34461.80000000002,-88785.01000000004

2025-12-22,28199.71,22870.37,81043.73,101117.4,182161.13,51070.08,-16779.410000000003,31.25,-13005.240000000005,-3774.170000000013,2025,12,4,0,3.56688554237628,-6008.889999999997,-2707.3255000000017,-3160.4996666666675,-1.290670131959552,0.0018839045231778702,-30044.449999999983,-54146.51000000004,38641.0222802573,-1,-30044.449999999983,-40407.69,-54146.51000000004,-189629.98000000004

2025-12-23,28193.89,22882.3,83000.47,97437.47,180437.94,51076.19,-1723.1900000000023,6.110000000000582,1956.7400000000052,-3679.929999999993,2025,12,4,1,3.5327212151102105,-5439.497999999998,-1743.4180000000008,-2432.6048333333338,-0.14074735322981577,-0.006828523733708788,-27197.48999999999,-34868.360000000015,38400.35543776598,0,-27197.48999999999,-39162.09,-34868.360000000015,-145956.29000000004

2025-12-24,28188.37,22876.07,74353.71,92824.14,167177.85,51064.44,-13260.089999999997,-11.75,-8646.759999999995,-4613.330000000002,2025,12,4,2,3.2738604398677436,-9116.495999999996,-1676.4805000000008,-1728.4131666666678,-1.0218811375347134,-0.013018021294090822,-45582.47999999998,-33529.610000000015,38377.92738964189,-1,-45582.47999999998,-37236.130000000005,-33529.610000000015,-103704.79000000007

2025-12-29,28185.07,22845.23,103201.17,121977.15,225178.32,51030.3,58000.47,-34.13999999999942,28847.459999999992,29153.009999999995,2025,12,4,0,4.412639549444154,8356.122000000003,1631.7299999999989,-1656.4136666666677,4.420662951820854,-0.020777419411500995,41780.610000000015,32634.599999999977,40577.93648269618,1,41780.610000000015,19091.20000000001,32634.599999999977,-99384.82000000007

2025-12-30,28171.8,22820.06,107487.1,130531.33,238018.43,50991.85,12840.109999999986,-38.450000000004366,4285.930000000008,8554.180000000008,2025,12,4,1,4.667773967800737,7815.577999999997,2583.2594999999988,-801.9165000000008,0.9715285303236094,-0.022271077557373127,39077.889999999985,51665.18999999997,40607.97322527844,1,39077.889999999985,-71665.26000000001,51665.18999999997,-48114.99000000005

2025-12-31,28202.77,22823.57,98291.61,124022.76,222314.37,51026.34,-15704.059999999998,34.48999999999796,-9195.490000000005,-6508.570000000007,2025,12,4,2,4.356855106597886,8030.647999999998,-372.4170000000013,-1268.5138333333346,-1.208539991718042,0.0030067473056876425,40153.23999999999,-7448.340000000026,39619.28585336705,-1,40153.23999999999,10108.790000000008,-7448.340000000026,-76110.83000000007

2026-01-05,28300.86,22912.71,135207.5,160697.25,295904.75,51213.57,73590.38,187.2300000000032,36915.89,36674.490000000005,2026,1,1,0,5.777858290292983,23093.362,5807.2289999999975,283.212499999999,5.611346445243938,0.05593977403428528,115466.81,116144.57999999996,41082.493490438916,1,115466.81,88269.32,116144.57999999996,16992.74999999994

2026-01-06,28310.61,22931.75,147945.24,170645.74,318590.98,51242.36,22686.22999999998,28.790000000000873,12737.73999999999,9948.48999999999,2026,1,1,1,6.217336203875075,30282.625999999997,6564.102499999998,399.55316666666573,1.7235285456067566,0.0010313757438646614,151413.12999999998,131282.04999999996,41255.34399264706,1,151413.12999999998,105830.65,131282.04999999996,23973.189999999944

2026-01-07,28345.51,22988.63,150892.04,175966.88,326858.92,51334.14,8267.940000000002,91.77999999999884,2946.8000000000175,5321.140000000014,2026,1,1,2,6.367281501160826,20336.119999999995,7632.770999999998,843.4123333333322,0.6223278390993369,0.022860964284090818,101680.59999999998,152655.41999999995,40995.0165503341,1,101680.59999999998,143461.21,152655.41999999995,50604.73999999993

2026-01-08,28305.83,22979.3,148412.65,176343.8,324756.45,51285.13,-2102.469999999972,-49.01000000000204,-2479.390000000014,376.9199999999837,2026,1,1,3,6.3323706111303615,17347.604000000003,6603.5745,-590.1408333333345,-0.16971496339468978,-0.025930713292962027,86738.02000000002,132071.49,40966.695210466736,0,86738.02000000002,125815.91,132071.49,-35408.45000000007

2026-01-09,28322.43,23030.85,166431.01,203212.11,369643.12,51353.28,44886.669999999984,68.15000000000146,18018.360000000015,26868.309999999998,2026,1,1,4,7.198043046130646,29465.75,7353.714999999998,586.0781666666658,3.4190930135690194,0.014671836212881045,147328.75,147074.29999999996,41548.64093387164,1,147328.75,187481.99,147074.29999999996,35164.689999999944

2026-01-12,28337.89,23088.45,172857.97,226122.22,398980.19,51426.34,29337.070000000007,73.05999999999767,6426.959999999992,22910.110000000015,2026,1,1,0,7.758284762244407,20615.088,8969.007999999998,1213.6434999999988,2.231488207041493,0.016373428207363205,103075.44,179380.15999999997,41753.683772968565,1,103075.44,218542.25,179380.15999999997,72818.60999999993

2026-01-13,28339.38,23099.92,182490.64,238444.93,420935.57,51439.31,21955.380000000005,12.970000000001164,9632.670000000013,12322.709999999992,2026,1,1,1,8.18314961845328,20468.918000000005,10826.079499999998,1223.8924999999988,1.6677096838449996,-0.004451146731232696,102344.59000000003,216521.58999999997,41447.644084698426,1,102344.59000000003,253757.72,216521.58999999997,73433.54999999993

2026-01-14,28364.52,23103.44,202711.86,260920.94,463632.8,51467.96,42697.22999999998,28.650000000001455,20221.219999999972,22476.01000000001,2026,1,1,2,9.008182954987918,27354.776,12877.283999999998,2786.0176666666657,3.2518739553550695,0.0009828578458551513,136773.88,257545.67999999996,41982.50383568416,1,136773.88,238454.47999999998,257545.67999999996,167161.05999999994

2026-01-15,28383.82,23068.98,151044.44,204433.55,355477.99,51452.81,-108154.81,-15.150000000001455,-51667.419999999984,-56487.390000000014,2026,1,1,3,6.908815864478539,6144.307999999995,2289.714999999998,1581.9248333333321,-8.269490438486763,-0.014196313102898619,30721.53999999998,45794.29999999996,44523.75387128897,-1,30721.53999999998,117459.56,45794.29999999996,94915.48999999993

2026-01-16,28393.89,23059.86,166031.49,200541.01,366572.5,51453.74,11094.51000000001,0.930000000000291,14987.049999999988,-3892.539999999979,2026,1,1,4,7.124312051951909,-614.1239999999991,7718.346,1823.2601666666656,0.838207869324328,-0.008623685960068234,-3070.6199999999953,154366.91999999998,37835.81798974524,1,-3070.6199999999953,144258.13,154366.91999999998,109395.60999999993

2026-01-19,28424.3,23052.36,147608.62,176161.47,323770.09,51476.66,-42802.409999999974,22.92000000000553,-18422.869999999995,-24379.540000000008,2026,1,1,0,6.289648357138944,-15042.019999999995,5806.733,1483.9799999999993,-3.278183629429959,-0.001002910408398079,-75210.09999999998,116134.66,39421.933317796844,-1,-75210.09999999998,27865.340000000026,116134.66,89038.79999999996

2026-01-20,28458.74,23054.54,158832.38,184935.74,343768.12,51513.28,19998.02999999997,36.61999999999534,11223.76000000001,8774.26999999999,2026,1,1,1,6.673388299094913,-15433.490000000002,6550.389499999999,1615.038666666666,1.518216560674198,0.0037449124682630676,-77167.45000000001,131007.78999999998,39548.4747315481,1,-77167.45000000001,25177.140000000014,131007.78999999998,96902.31999999995

2026-01-21,28536.64,23115.95,154231.36,166984.02,321215.38,51652.58,-22552.73999999999,139.3000000000029,-4601.020000000019,-17951.72,2026,1,1,2,6.218767387805217,-28483.483999999997,6890.883499999999,1790.3874999999991,-1.7316097354007698,0.03932932509424591,-142417.41999999998,137817.66999999998,39251.204735323954,-1,-142417.41999999998,-5643.539999999979,137817.66999999998,107423.24999999994

2026-01-22,28564.39,23140.59,155536.95,175540.19,331077.14,51704.98,9861.76000000001,52.400000000001455,1305.5900000000256,8556.170000000013,2026,1,1,3,6.403196365224394,-4880.1699999999955,6606.829999999999,2186.1803333333323,0.7440562625147117,0.009213572686788442,-24400.849999999977,132136.59999999998,39205.82703162092,1,-24400.849999999977,6320.690000000002,132136.59999999998,131170.81999999995"""

# 由于数据被截断，我需要处理完整的，但为演示假设这是完整数据
# 实际中，工具会处理附件文件

# 将CSV字符串加载到DataFrame
# from io import StringIO
# df = pd.read_csv(StringIO(csv_data))
df = pd.read_csv('/Users/robert/Developer/ProjectQuant/tushare/tushare_2_duckdb/Droid_tushare/data/moneyflow_hsgt_analysis.csv')

# 转换trade_date为datetime
df['trade_date'] = pd.to_datetime(df['trade_date'])

# 分段
df_before = df[df['year'] < 2024].copy()
df_after = df[df['year'] >= 2024].copy()

# 计算关键统计

# 时间趋势: north_money累计最后值
before_cum_north = df_before['north_money'].iloc[-1] if not df_before.empty else 0
after_cum_north = df_after['north_money'].iloc[-1] if not df_after.empty else 0

# 资金规模: hgt vs sgt 均值比例
before_hgt_mean = df_before['hgt'].mean()
before_sgt_mean = df_before['sgt'].mean()
before_ratio = before_hgt_mean / (before_hgt_mean + before_sgt_mean) if before_hgt_mean + before_sgt_mean != 0 else 0
after_hgt_mean = df_after['hgt'].mean()
after_sgt_mean = df_after['sgt'].mean()
after_ratio = after_hgt_mean / (after_hgt_mean + after_sgt_mean) if after_hgt_mean + after_sgt_mean != 0 else 0

# 极端: north_daily max/min
before_max_in = df_before['north_daily'].max()
before_min_out = df_before['north_daily'].min()
after_max_in = df_after['north_daily'].max()
after_min_out = df_after['north_daily'].min()

# 南北对比: ns_ratio均值
before_ns_mean = df_before['ns_ratio'].mean()
after_ns_mean = df_after['ns_ratio'].mean()

# 季节: 月均north_daily
before_month_mean = df_before.groupby('month')['north_daily'].mean().to_dict()
after_month_mean = df_after.groupby('month')['north_daily'].mean().to_dict()

# 统计描述: north_daily mean/std/skew
before_stats = df_before['north_daily'].agg(['mean', 'std', 'skew'])
after_stats = df_after['north_daily'].agg(['mean', 'std', 'skew'])

# 时间序列: north_ma5 最后值作为趋势示例
before_ma5_last = df_before['north_ma5'].iloc[-1] if not df_before.empty else 0
after_ma5_last = df_after['north_ma5'].iloc[-1] if not df_after.empty else 0

# 因子: north_zscore均值
before_z_mean = df_before['north_zscore'].mean()
after_z_mean = df_after['north_zscore'].mean()

# 极端阈值: 90% and 10% quantiles for north_daily
before_p90 = df_before['north_daily'].quantile(0.9)
before_p10 = df_before['north_daily'].quantile(0.1)
after_p90 = df_after['north_daily'].quantile(0.9)
after_p10 = df_after['north_daily'].quantile(0.1)

# 多渠道: corr between hgt_daily and sgt_daily
before_corr = df_before[['hgt_daily', 'sgt_daily']].corr().iloc[0,1] if 'hgt_daily' in df_before and 'sgt_daily' in df_before else 0
after_corr = df_after[['hgt_daily', 'sgt_daily']].corr().iloc[0,1] if 'hgt_daily' in df_after and 'sgt_daily' in df_after else 0

# 跨资产: 假设无外部数据，用north_volatility_20d均值
before_vol_mean = df_before['north_volatility_20d'].mean()
after_vol_mean = df_after['north_volatility_20d'].mean()

# 累计: north_cum_60d最后值
before_cum60_last = df_before['north_cum_60d'].iloc[-1] if not df_before.empty else 0
after_cum60_last = df_after['north_cum_60d'].iloc[-1] if not df_after.empty else 0

# 输出所有计算结果
results = {
    'before_cum_north': before_cum_north,
    'after_cum_north': after_cum_north,
    'before_hgt_sgt_ratio': before_ratio,
    'after_hgt_sgt_ratio': after_ratio,
    'before_max_in': before_max_in,
    'before_min_out': before_min_out,
    'after_max_in': after_max_in,
    'after_min_out': after_min_out,
    'before_ns_mean': before_ns_mean,
    'after_ns_mean': after_ns_mean,
    'before_month_mean': before_month_mean,
    'after_month_mean': after_month_mean,
    'before_stats': before_stats.to_dict(),
    'after_stats': after_stats.to_dict(),
    'before_ma5_last': before_ma5_last,
    'after_ma5_last': after_ma5_last,
    'before_z_mean': before_z_mean,
    'after_z_mean': after_z_mean,
    'before_p90': before_p90,
    'before_p10': before_p10,
    'after_p90': after_p90,
    'after_p10': after_p10,
    'before_corr': before_corr,
    'after_corr': after_corr,
    'before_vol_mean': before_vol_mean,
    'after_vol_mean': after_vol_mean,
    'before_cum60_last': before_cum60_last,
    'after_cum60_last': after_cum60_last
}

print(results)